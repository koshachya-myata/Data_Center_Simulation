{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.86958179529483, "policy_loss": -2170037.229449481, "vf_loss": 4266509.698432945}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 343.5, "diff_num_grad_updates_vs_sampler_policy": 342.5}}, "num_env_steps_sampled": 11267760, "num_env_steps_trained": 11267760, "num_agent_steps_sampled": 11267760, "num_agent_steps_trained": 11267760}, "sampler_results": {"episode_reward_max": -152838.72735678652, "episode_reward_min": -152838.72735678652, "episode_reward_mean": -152838.72735678652, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652], "episode_lengths": [43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21479537514660332, "mean_inference_ms": 0.3584568483310928, "mean_action_processing_ms": 0.08907524066849573, "mean_env_wait_ms": 0.7522069475005411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033617019653320312, "StateBufferConnector_ms": 0.0023603439331054688, "ViewRequirementAgentConnector_ms": 0.06489753723144531}}, "episode_reward_max": -152838.72735678652, "episode_reward_min": -152838.72735678652, "episode_reward_mean": -152838.72735678652, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652], "episode_lengths": [43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21479537514660332, "mean_inference_ms": 0.3584568483310928, "mean_action_processing_ms": 0.08907524066849573, "mean_env_wait_ms": 0.7522069475005411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033617019653320312, "StateBufferConnector_ms": 0.0023603439331054688, "ViewRequirementAgentConnector_ms": 0.06489753723144531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11267760, "num_agent_steps_trained": 11267760, "num_env_steps_sampled": 11267760, "num_env_steps_trained": 11267760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 685.0017874155061, "num_env_steps_trained_throughput_per_sec": 685.0017874155061, "timesteps_total": 11267760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11267760, "timers": {"training_iteration_time_ms": 64116.59, "sample_time_ms": 62986.418, "load_time_ms": 0.625, "load_throughput": 70230206.512, "learn_time_ms": 1128.481, "learn_throughput": 38919.577, "synch_weights_time_ms": 0.915}, "counters": {"num_env_steps_sampled": 11267760, "num_env_steps_trained": 11267760, "num_agent_steps_sampled": 11267760, "num_agent_steps_trained": 11267760}, "done": false, "episodes_total": 7709, "training_iteration": 1886, "trial_id": "e8087_00000", "date": "2023-08-06_10-37-18", "timestamp": 1691307438, "time_this_iter_s": 64.11922097206116, "time_total_s": 29544.890649318695, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 64.11922097206116, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 18.49891304347826, "ram_util_percent": 70.6608695652174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.9999999999999995e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.2811810462885, "policy_loss": -2060339.9609289586, "vf_loss": 4751660.922922741}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1029.5, "diff_num_grad_updates_vs_sampler_policy": 1028.5}}, "num_env_steps_sampled": 11311680, "num_env_steps_trained": 11311680, "num_agent_steps_sampled": 11311680, "num_agent_steps_trained": 11311680}, "sampler_results": {"episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155718.21906734223, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979], "episode_lengths": [43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2148965782803035, "mean_inference_ms": 0.3585566842647431, "mean_action_processing_ms": 0.08912955140168256, "mean_env_wait_ms": 0.7339051330199784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0026941299438476562, "ViewRequirementAgentConnector_ms": 0.06536245346069336}}, "episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155718.21906734223, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979], "episode_lengths": [43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2148965782803035, "mean_inference_ms": 0.3585566842647431, "mean_action_processing_ms": 0.08912955140168256, "mean_env_wait_ms": 0.7339051330199784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0026941299438476562, "ViewRequirementAgentConnector_ms": 0.06536245346069336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11311680, "num_agent_steps_trained": 11311680, "num_env_steps_sampled": 11311680, "num_env_steps_trained": 11311680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 720.7428239446733, "num_env_steps_trained_throughput_per_sec": 720.7428239446733, "timesteps_total": 11311680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11311680, "timers": {"training_iteration_time_ms": 62526.849, "sample_time_ms": 61403.404, "load_time_ms": 10.635, "load_throughput": 4129845.685, "learn_time_ms": 1111.769, "learn_throughput": 39504.594, "synch_weights_time_ms": 0.887}, "counters": {"num_env_steps_sampled": 11311680, "num_env_steps_trained": 11311680, "num_agent_steps_sampled": 11311680, "num_agent_steps_trained": 11311680}, "done": false, "episodes_total": 7710, "training_iteration": 1887, "trial_id": "e8087_00000", "date": "2023-08-06_10-38-18", "timestamp": 1691307498, "time_this_iter_s": 60.939624309539795, "time_total_s": 29605.830273628235, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 125.05884528160095, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.113953488372093, "ram_util_percent": 71.00232558139534}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.4749999999999994e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0826432920406, "policy_loss": -2584145.977237268, "vf_loss": 4655155.7453534985}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1715.5, "diff_num_grad_updates_vs_sampler_policy": 1714.5}}, "num_env_steps_sampled": 11355600, "num_env_steps_trained": 11355600, "num_agent_steps_sampled": 11355600, "num_agent_steps_trained": 11355600}, "sampler_results": {"episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -156401.24106039683, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603], "episode_lengths": [43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2150064379137762, "mean_inference_ms": 0.35849491476434253, "mean_action_processing_ms": 0.08914276518712598, "mean_env_wait_ms": 0.7244915120497616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032345453898111978, "StateBufferConnector_ms": 0.0026623407999674478, "ViewRequirementAgentConnector_ms": 0.06518363952636719}}, "episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -156401.24106039683, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603], "episode_lengths": [43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2150064379137762, "mean_inference_ms": 0.35849491476434253, "mean_action_processing_ms": 0.08914276518712598, "mean_env_wait_ms": 0.7244915120497616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032345453898111978, "StateBufferConnector_ms": 0.0026623407999674478, "ViewRequirementAgentConnector_ms": 0.06518363952636719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11355600, "num_agent_steps_trained": 11355600, "num_env_steps_sampled": 11355600, "num_env_steps_trained": 11355600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.6393308723736, "num_env_steps_trained_throughput_per_sec": 717.6393308723736, "timesteps_total": 11355600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11355600, "timers": {"training_iteration_time_ms": 62084.779, "sample_time_ms": 60964.968, "load_time_ms": 13.766, "load_throughput": 3190512.863, "learn_time_ms": 1105.005, "learn_throughput": 39746.426, "synch_weights_time_ms": 0.886}, "counters": {"num_env_steps_sampled": 11355600, "num_env_steps_trained": 11355600, "num_agent_steps_sampled": 11355600, "num_agent_steps_trained": 11355600}, "done": false, "episodes_total": 7711, "training_iteration": 1888, "trial_id": "e8087_00000", "date": "2023-08-06_10-39-20", "timestamp": 1691307560, "time_this_iter_s": 61.20322513580322, "time_total_s": 29667.033498764038, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 186.26207041740417, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.126436781609197, "ram_util_percent": 70.96091954022988}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.950000000000001e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.97912032680676, "policy_loss": -2238257.854176157, "vf_loss": 4397112.415451895}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2401.5, "diff_num_grad_updates_vs_sampler_policy": 2400.5}}, "num_env_steps_sampled": 11399520, "num_env_steps_trained": 11399520, "num_agent_steps_sampled": 11399520, "num_agent_steps_trained": 11399520}, "sampler_results": {"episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155836.28484744625, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446], "episode_lengths": [43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2151371413011882, "mean_inference_ms": 0.35839171457010116, "mean_action_processing_ms": 0.08915180549287599, "mean_env_wait_ms": 0.7187893642605925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.002562999725341797, "ViewRequirementAgentConnector_ms": 0.0652015209197998}}, "episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155836.28484744625, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446], "episode_lengths": [43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2151371413011882, "mean_inference_ms": 0.35839171457010116, "mean_action_processing_ms": 0.08915180549287599, "mean_env_wait_ms": 0.7187893642605925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.002562999725341797, "ViewRequirementAgentConnector_ms": 0.0652015209197998}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11399520, "num_agent_steps_trained": 11399520, "num_env_steps_sampled": 11399520, "num_env_steps_trained": 11399520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.414347285232, "num_env_steps_trained_throughput_per_sec": 715.414347285232, "timesteps_total": 11399520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11399520, "timers": {"training_iteration_time_ms": 61911.329, "sample_time_ms": 60793.536, "load_time_ms": 14.797, "load_throughput": 2968138.917, "learn_time_ms": 1101.958, "learn_throughput": 39856.325, "synch_weights_time_ms": 0.884}, "counters": {"num_env_steps_sampled": 11399520, "num_env_steps_trained": 11399520, "num_agent_steps_sampled": 11399520, "num_agent_steps_trained": 11399520}, "done": false, "episodes_total": 7712, "training_iteration": 1889, "trial_id": "e8087_00000", "date": "2023-08-06_10-40-21", "timestamp": 1691307621, "time_this_iter_s": 61.3934907913208, "time_total_s": 29728.42698955536, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 247.65556120872498, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.447727272727274, "ram_util_percent": 71.02045454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.425000000000001e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9799464367569, "policy_loss": -2304527.444273301, "vf_loss": 4503750.125911078}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3087.5, "diff_num_grad_updates_vs_sampler_policy": 3086.5}}, "num_env_steps_sampled": 11443440, "num_env_steps_trained": 11443440, "num_agent_steps_sampled": 11443440, "num_agent_steps_trained": 11443440}, "sampler_results": {"episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155845.53227412995, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472], "episode_lengths": [43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2153239681088544, "mean_inference_ms": 0.3583231829771522, "mean_action_processing_ms": 0.08916166347322654, "mean_env_wait_ms": 0.7146546406641321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038242340087890625, "StateBufferConnector_ms": 0.0025987625122070312, "ViewRequirementAgentConnector_ms": 0.06517887115478516}}, "episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155845.53227412995, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472], "episode_lengths": [43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2153239681088544, "mean_inference_ms": 0.3583231829771522, "mean_action_processing_ms": 0.08916166347322654, "mean_env_wait_ms": 0.7146546406641321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038242340087890625, "StateBufferConnector_ms": 0.0025987625122070312, "ViewRequirementAgentConnector_ms": 0.06517887115478516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11443440, "num_agent_steps_trained": 11443440, "num_env_steps_sampled": 11443440, "num_env_steps_trained": 11443440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.0067779843664, "num_env_steps_trained_throughput_per_sec": 717.0067779843664, "timesteps_total": 11443440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11443440, "timers": {"training_iteration_time_ms": 61779.989, "sample_time_ms": 60661.449, "load_time_ms": 15.756, "load_throughput": 2787494.918, "learn_time_ms": 1101.746, "learn_throughput": 39863.995, "synch_weights_time_ms": 0.883}, "counters": {"num_env_steps_sampled": 11443440, "num_env_steps_trained": 11443440, "num_agent_steps_sampled": 11443440, "num_agent_steps_trained": 11443440}, "done": false, "episodes_total": 7713, "training_iteration": 1890, "trial_id": "e8087_00000", "date": "2023-08-06_10-41-22", "timestamp": 1691307682, "time_this_iter_s": 61.25718021392822, "time_total_s": 29789.684169769287, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 308.9127414226532, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.468965517241372, "ram_util_percent": 71.12183908045976}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.9e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.10498509532164, "policy_loss": -2293172.6402534507, "vf_loss": 4651834.752733236}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3773.5, "diff_num_grad_updates_vs_sampler_policy": 3772.5}}, "num_env_steps_sampled": 11487360, "num_env_steps_trained": 11487360, "num_agent_steps_sampled": 11487360, "num_agent_steps_trained": 11487360}, "sampler_results": {"episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -156166.20251498368, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21554378964470655, "mean_inference_ms": 0.35826248653282283, "mean_action_processing_ms": 0.08917257602544315, "mean_env_wait_ms": 0.7114893271777074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003735224405924479, "StateBufferConnector_ms": 0.0026186307271321616, "ViewRequirementAgentConnector_ms": 0.06549755732218425}}, "episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -156166.20251498368, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21554378964470655, "mean_inference_ms": 0.35826248653282283, "mean_action_processing_ms": 0.08917257602544315, "mean_env_wait_ms": 0.7114893271777074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003735224405924479, "StateBufferConnector_ms": 0.0026186307271321616, "ViewRequirementAgentConnector_ms": 0.06549755732218425}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11487360, "num_agent_steps_trained": 11487360, "num_env_steps_sampled": 11487360, "num_env_steps_trained": 11487360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.0249463674861, "num_env_steps_trained_throughput_per_sec": 717.0249463674861, "timesteps_total": 11487360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11487360, "timers": {"training_iteration_time_ms": 61692.171, "sample_time_ms": 60573.858, "load_time_ms": 15.993, "load_throughput": 2746276.679, "learn_time_ms": 1101.282, "learn_throughput": 39880.808, "synch_weights_time_ms": 0.884}, "counters": {"num_env_steps_sampled": 11487360, "num_env_steps_trained": 11487360, "num_agent_steps_sampled": 11487360, "num_agent_steps_trained": 11487360}, "done": false, "episodes_total": 7714, "training_iteration": 1891, "trial_id": "e8087_00000", "date": "2023-08-06_10-42-24", "timestamp": 1691307744, "time_this_iter_s": 61.25560212135315, "time_total_s": 29850.93977189064, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 370.16834354400635, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.77241379310345, "ram_util_percent": 71.23103448275863}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.375e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0143496232547, "policy_loss": -2067814.2214177523, "vf_loss": 4386186.32835277}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4459.5, "diff_num_grad_updates_vs_sampler_policy": 4458.5}}, "num_env_steps_sampled": 11531280, "num_env_steps_trained": 11531280, "num_agent_steps_sampled": 11531280, "num_agent_steps_trained": 11531280}, "sampler_results": {"episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155866.78877587762, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21571987118179123, "mean_inference_ms": 0.3582044133052543, "mean_action_processing_ms": 0.0891804748294056, "mean_env_wait_ms": 0.7091987586270182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036614281790597098, "StateBufferConnector_ms": 0.0026191983904157367, "ViewRequirementAgentConnector_ms": 0.06572859627859932}}, "episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155866.78877587762, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21571987118179123, "mean_inference_ms": 0.3582044133052543, "mean_action_processing_ms": 0.0891804748294056, "mean_env_wait_ms": 0.7091987586270182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036614281790597098, "StateBufferConnector_ms": 0.0026191983904157367, "ViewRequirementAgentConnector_ms": 0.06572859627859932}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11531280, "num_agent_steps_trained": 11531280, "num_env_steps_sampled": 11531280, "num_env_steps_trained": 11531280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.4500261954624, "num_env_steps_trained_throughput_per_sec": 712.4500261954624, "timesteps_total": 11531280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11531280, "timers": {"training_iteration_time_ms": 61685.634, "sample_time_ms": 60566.677, "load_time_ms": 16.485, "load_throughput": 2664277.155, "learn_time_ms": 1101.434, "learn_throughput": 39875.298, "synch_weights_time_ms": 0.884}, "counters": {"num_env_steps_sampled": 11531280, "num_env_steps_trained": 11531280, "num_agent_steps_sampled": 11531280, "num_agent_steps_trained": 11531280}, "done": false, "episodes_total": 7715, "training_iteration": 1892, "trial_id": "e8087_00000", "date": "2023-08-06_10-43-25", "timestamp": 1691307805, "time_this_iter_s": 61.648937940597534, "time_total_s": 29912.588709831238, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 431.8172814846039, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 16.996551724137923, "ram_util_percent": 71.19310344827588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.8499999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.020774240744, "policy_loss": -1994531.2419255648, "vf_loss": 4358730.378097667}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5145.5, "diff_num_grad_updates_vs_sampler_policy": 5144.5}}, "num_env_steps_sampled": 11575200, "num_env_steps_trained": 11575200, "num_agent_steps_sampled": 11575200, "num_agent_steps_trained": 11575200}, "sampler_results": {"episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155615.93793902633, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2158702998662045, "mean_inference_ms": 0.35815605944491846, "mean_action_processing_ms": 0.08919069382760844, "mean_env_wait_ms": 0.7072180932674681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035941600799560547, "StateBufferConnector_ms": 0.0026166439056396484, "ViewRequirementAgentConnector_ms": 0.06600320339202881}}, "episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155615.93793902633, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2158702998662045, "mean_inference_ms": 0.35815605944491846, "mean_action_processing_ms": 0.08919069382760844, "mean_env_wait_ms": 0.7072180932674681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035941600799560547, "StateBufferConnector_ms": 0.0026166439056396484, "ViewRequirementAgentConnector_ms": 0.06600320339202881}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11575200, "num_agent_steps_trained": 11575200, "num_env_steps_sampled": 11575200, "num_env_steps_trained": 11575200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.7896528563622, "num_env_steps_trained_throughput_per_sec": 718.7896528563622, "timesteps_total": 11575200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11575200, "timers": {"training_iteration_time_ms": 61612.766, "sample_time_ms": 60482.025, "load_time_ms": 16.513, "load_throughput": 2659676.252, "learn_time_ms": 1113.183, "learn_throughput": 39454.414, "synch_weights_time_ms": 0.891}, "counters": {"num_env_steps_sampled": 11575200, "num_env_steps_trained": 11575200, "num_agent_steps_sampled": 11575200, "num_agent_steps_trained": 11575200}, "done": false, "episodes_total": 7716, "training_iteration": 1893, "trial_id": "e8087_00000", "date": "2023-08-06_10-44-26", "timestamp": 1691307866, "time_this_iter_s": 61.10531783103943, "time_total_s": 29973.694027662277, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 492.9225993156433, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.01034482758621, "ram_util_percent": 71.18965517241381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.3250000000000003e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.09430990413745, "policy_loss": -2007879.316522982, "vf_loss": 4522356.291362974}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5831.5, "diff_num_grad_updates_vs_sampler_policy": 5830.5}}, "num_env_steps_sampled": 11619120, "num_env_steps_trained": 11619120, "num_agent_steps_sampled": 11619120, "num_agent_steps_trained": 11619120}, "sampler_results": {"episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155688.8286183826, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2160053773035565, "mean_inference_ms": 0.3581313694227112, "mean_action_processing_ms": 0.089201165110737, "mean_env_wait_ms": 0.7054877629425055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003528594970703125, "StateBufferConnector_ms": 0.0026199552747938368, "ViewRequirementAgentConnector_ms": 0.06611612108018664}}, "episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155688.8286183826, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2160053773035565, "mean_inference_ms": 0.3581313694227112, "mean_action_processing_ms": 0.089201165110737, "mean_env_wait_ms": 0.7054877629425055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003528594970703125, "StateBufferConnector_ms": 0.0026199552747938368, "ViewRequirementAgentConnector_ms": 0.06611612108018664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11619120, "num_agent_steps_trained": 11619120, "num_env_steps_sampled": 11619120, "num_env_steps_trained": 11619120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.7033169666647, "num_env_steps_trained_throughput_per_sec": 719.7033169666647, "timesteps_total": 11619120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11619120, "timers": {"training_iteration_time_ms": 61547.473, "sample_time_ms": 60419.219, "load_time_ms": 16.723, "load_throughput": 2626298.533, "learn_time_ms": 1110.488, "learn_throughput": 39550.182, "synch_weights_time_ms": 0.889}, "counters": {"num_env_steps_sampled": 11619120, "num_env_steps_trained": 11619120, "num_agent_steps_sampled": 11619120, "num_agent_steps_trained": 11619120}, "done": false, "episodes_total": 7717, "training_iteration": 1894, "trial_id": "e8087_00000", "date": "2023-08-06_10-45-28", "timestamp": 1691307928, "time_this_iter_s": 61.02777099609375, "time_total_s": 30034.72179865837, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 553.9503703117371, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.485057471264373, "ram_util_percent": 70.98620689655172}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.999999999999998e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.2209343201217, "policy_loss": -2117980.588357553, "vf_loss": 4651218.008199709}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6517.5, "diff_num_grad_updates_vs_sampler_policy": 6516.5}}, "num_env_steps_sampled": 11663040, "num_env_steps_trained": 11663040, "num_agent_steps_sampled": 11663040, "num_agent_steps_trained": 11663040}, "sampler_results": {"episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155884.00333018976, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21611553495041758, "mean_inference_ms": 0.3580981889727849, "mean_action_processing_ms": 0.08921139079677208, "mean_env_wait_ms": 0.7039711058971553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003802776336669922, "StateBufferConnector_ms": 0.0026154518127441406, "ViewRequirementAgentConnector_ms": 0.066375732421875}}, "episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155884.00333018976, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21611553495041758, "mean_inference_ms": 0.3580981889727849, "mean_action_processing_ms": 0.08921139079677208, "mean_env_wait_ms": 0.7039711058971553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003802776336669922, "StateBufferConnector_ms": 0.0026154518127441406, "ViewRequirementAgentConnector_ms": 0.066375732421875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11663040, "num_agent_steps_trained": 11663040, "num_env_steps_sampled": 11663040, "num_env_steps_trained": 11663040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 720.9526399033291, "num_env_steps_trained_throughput_per_sec": 720.9526399033291, "timesteps_total": 11663040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11663040, "timers": {"training_iteration_time_ms": 61484.663, "sample_time_ms": 60357.411, "load_time_ms": 16.838, "load_throughput": 2608359.599, "learn_time_ms": 1109.368, "learn_throughput": 39590.096, "synch_weights_time_ms": 0.892}, "counters": {"num_env_steps_sampled": 11663040, "num_env_steps_trained": 11663040, "num_agent_steps_sampled": 11663040, "num_agent_steps_trained": 11663040}, "done": false, "episodes_total": 7718, "training_iteration": 1895, "trial_id": "e8087_00000", "date": "2023-08-06_10-46-28", "timestamp": 1691307988, "time_this_iter_s": 60.92200589179993, "time_total_s": 30095.64380455017, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 614.872376203537, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 20.044186046511626, "ram_util_percent": 70.61395348837209}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.312499999999999e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.14899762656876, "policy_loss": -2173041.4344706633, "vf_loss": 4596033.417091837}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7203.5, "diff_num_grad_updates_vs_sampler_policy": 7202.5}}, "num_env_steps_sampled": 11706960, "num_env_steps_trained": 11706960, "num_agent_steps_sampled": 11706960, "num_agent_steps_trained": 11706960}, "sampler_results": {"episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155951.68360247274, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21620442593788877, "mean_inference_ms": 0.3580644718678245, "mean_action_processing_ms": 0.0892208163762511, "mean_env_wait_ms": 0.7028108830772665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037453391335227275, "StateBufferConnector_ms": 0.0026074322787198153, "ViewRequirementAgentConnector_ms": 0.06633455103093927}}, "episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155951.68360247274, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21620442593788877, "mean_inference_ms": 0.3580644718678245, "mean_action_processing_ms": 0.0892208163762511, "mean_env_wait_ms": 0.7028108830772665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037453391335227275, "StateBufferConnector_ms": 0.0026074322787198153, "ViewRequirementAgentConnector_ms": 0.06633455103093927}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11706960, "num_agent_steps_trained": 11706960, "num_env_steps_sampled": 11706960, "num_env_steps_trained": 11706960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 709.752797252475, "num_env_steps_trained_throughput_per_sec": 709.752797252475, "timesteps_total": 11706960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11706960, "timers": {"training_iteration_time_ms": 61261.072, "sample_time_ms": 60134.585, "load_time_ms": 18.571, "load_throughput": 2365032.901, "learn_time_ms": 1106.871, "learn_throughput": 39679.425, "synch_weights_time_ms": 0.891}, "counters": {"num_env_steps_sampled": 11706960, "num_env_steps_trained": 11706960, "num_agent_steps_sampled": 11706960, "num_agent_steps_trained": 11706960}, "done": false, "episodes_total": 7719, "training_iteration": 1896, "trial_id": "e8087_00000", "date": "2023-08-06_10-47-30", "timestamp": 1691308050, "time_this_iter_s": 61.883756160736084, "time_total_s": 30157.527560710907, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 676.7561323642731, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.05909090909091, "ram_util_percent": 70.72613636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.625000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.8197706128001, "policy_loss": -2077536.8785930667, "vf_loss": 4320518.363793732}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7889.5, "diff_num_grad_updates_vs_sampler_policy": 7888.5}}, "num_env_steps_sampled": 11750880, "num_env_steps_trained": 11750880, "num_agent_steps_sampled": 11750880, "num_agent_steps_trained": 11750880}, "sampler_results": {"episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155715.1050139419, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21629360875227155, "mean_inference_ms": 0.3580392610250163, "mean_action_processing_ms": 0.08923017943486372, "mean_env_wait_ms": 0.7017834136814307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036756197611490884, "StateBufferConnector_ms": 0.0026047229766845703, "ViewRequirementAgentConnector_ms": 0.0662704308827718}}, "episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155715.1050139419, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21629360875227155, "mean_inference_ms": 0.3580392610250163, "mean_action_processing_ms": 0.08923017943486372, "mean_env_wait_ms": 0.7017834136814307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036756197611490884, "StateBufferConnector_ms": 0.0026047229766845703, "ViewRequirementAgentConnector_ms": 0.0662704308827718}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11750880, "num_agent_steps_trained": 11750880, "num_env_steps_sampled": 11750880, "num_env_steps_trained": 11750880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.8263274696828, "num_env_steps_trained_throughput_per_sec": 716.8263274696828, "timesteps_total": 11750880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11750880, "timers": {"training_iteration_time_ms": 61294.366, "sample_time_ms": 60167.367, "load_time_ms": 18.223, "load_throughput": 2410197.847, "learn_time_ms": 1107.732, "learn_throughput": 39648.565, "synch_weights_time_ms": 0.89}, "counters": {"num_env_steps_sampled": 11750880, "num_env_steps_trained": 11750880, "num_agent_steps_sampled": 11750880, "num_agent_steps_trained": 11750880}, "done": false, "episodes_total": 7720, "training_iteration": 1897, "trial_id": "e8087_00000", "date": "2023-08-06_10-48-32", "timestamp": 1691308112, "time_this_iter_s": 61.27256774902344, "time_total_s": 30218.80012845993, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 738.0287001132965, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.34651162790697, "ram_util_percent": 70.69069767441862}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.9375e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.99889562845925, "policy_loss": -1980233.290886081, "vf_loss": 4525776.147139213}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8575.5, "diff_num_grad_updates_vs_sampler_policy": 8574.5}}, "num_env_steps_sampled": 11794800, "num_env_steps_trained": 11794800, "num_agent_steps_sampled": 11794800, "num_agent_steps_trained": 11794800}, "sampler_results": {"episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155733.8664501005, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21635489698806287, "mean_inference_ms": 0.358015590161351, "mean_action_processing_ms": 0.08923715184539852, "mean_env_wait_ms": 0.7008476883464883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036257963914137622, "StateBufferConnector_ms": 0.002585924588716947, "ViewRequirementAgentConnector_ms": 0.06620150346022385}}, "episode_reward_max": -152838.72735678652, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155733.8664501005, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21635489698806287, "mean_inference_ms": 0.358015590161351, "mean_action_processing_ms": 0.08923715184539852, "mean_env_wait_ms": 0.7008476883464883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036257963914137622, "StateBufferConnector_ms": 0.002585924588716947, "ViewRequirementAgentConnector_ms": 0.06620150346022385}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11794800, "num_agent_steps_trained": 11794800, "num_env_steps_sampled": 11794800, "num_env_steps_trained": 11794800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 720.9275513524278, "num_env_steps_trained_throughput_per_sec": 720.9275513524278, "timesteps_total": 11794800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11794800, "timers": {"training_iteration_time_ms": 61266.452, "sample_time_ms": 60134.43, "load_time_ms": 18.032, "load_throughput": 2435711.456, "learn_time_ms": 1112.946, "learn_throughput": 39462.835, "synch_weights_time_ms": 0.891}, "counters": {"num_env_steps_sampled": 11794800, "num_env_steps_trained": 11794800, "num_agent_steps_sampled": 11794800, "num_agent_steps_trained": 11794800}, "done": false, "episodes_total": 7721, "training_iteration": 1898, "trial_id": "e8087_00000", "date": "2023-08-06_10-49-33", "timestamp": 1691308173, "time_this_iter_s": 60.924052000045776, "time_total_s": 30279.724180459976, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 798.9527521133423, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.41954022988505, "ram_util_percent": 70.71149425287358}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.25e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9124896435974, "policy_loss": -2287669.4497283846, "vf_loss": 4216634.636661808}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9261.5, "diff_num_grad_updates_vs_sampler_policy": 9260.5}}, "num_env_steps_sampled": 11838720, "num_env_steps_trained": 11838720, "num_agent_steps_sampled": 11838720, "num_agent_steps_trained": 11838720}, "sampler_results": {"episode_reward_max": -152067.5220349097, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155471.9847061583, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21639925526114484, "mean_inference_ms": 0.357992822681636, "mean_action_processing_ms": 0.08924236154724434, "mean_env_wait_ms": 0.7000533438072228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036154474530901226, "StateBufferConnector_ms": 0.0026004655020577566, "ViewRequirementAgentConnector_ms": 0.06652389253888812}}, "episode_reward_max": -152067.5220349097, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155471.9847061583, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21639925526114484, "mean_inference_ms": 0.357992822681636, "mean_action_processing_ms": 0.08924236154724434, "mean_env_wait_ms": 0.7000533438072228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036154474530901226, "StateBufferConnector_ms": 0.0026004655020577566, "ViewRequirementAgentConnector_ms": 0.06652389253888812}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11838720, "num_agent_steps_trained": 11838720, "num_env_steps_sampled": 11838720, "num_env_steps_trained": 11838720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.1637577190346, "num_env_steps_trained_throughput_per_sec": 715.1637577190346, "timesteps_total": 11838720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11838720, "timers": {"training_iteration_time_ms": 61268.603, "sample_time_ms": 60136.042, "load_time_ms": 17.919, "load_throughput": 2451050.289, "learn_time_ms": 1113.594, "learn_throughput": 39439.851, "synch_weights_time_ms": 0.894}, "counters": {"num_env_steps_sampled": 11838720, "num_env_steps_trained": 11838720, "num_agent_steps_sampled": 11838720, "num_agent_steps_trained": 11838720}, "done": false, "episodes_total": 7722, "training_iteration": 1899, "trial_id": "e8087_00000", "date": "2023-08-06_10-50-34", "timestamp": 1691308234, "time_this_iter_s": 61.415162086486816, "time_total_s": 30341.139342546463, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 860.3679141998291, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.040229885057467, "ram_util_percent": 70.70919540229883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.562499999999999e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.14312895393925, "policy_loss": -2218362.579773483, "vf_loss": 4482397.0440051025}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9947.5, "diff_num_grad_updates_vs_sampler_policy": 9946.5}}, "num_env_steps_sampled": 11882640, "num_env_steps_trained": 11882640, "num_agent_steps_sampled": 11882640, "num_agent_steps_trained": 11882640}, "sampler_results": {"episode_reward_max": -152067.5220349097, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155459.21404431984, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21643037604243628, "mean_inference_ms": 0.35797054999456057, "mean_action_processing_ms": 0.0892462866937289, "mean_env_wait_ms": 0.6993650331915173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035858154296875, "StateBufferConnector_ms": 0.002590815226236979, "ViewRequirementAgentConnector_ms": 0.06646315256754558}}, "episode_reward_max": -152067.5220349097, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155459.21404431984, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21643037604243628, "mean_inference_ms": 0.35797054999456057, "mean_action_processing_ms": 0.0892462866937289, "mean_env_wait_ms": 0.6993650331915173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035858154296875, "StateBufferConnector_ms": 0.002590815226236979, "ViewRequirementAgentConnector_ms": 0.06646315256754558}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11882640, "num_agent_steps_trained": 11882640, "num_env_steps_sampled": 11882640, "num_env_steps_trained": 11882640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.9450768334634, "num_env_steps_trained_throughput_per_sec": 715.9450768334634, "timesteps_total": 11882640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11882640, "timers": {"training_iteration_time_ms": 61277.687, "sample_time_ms": 60146.524, "load_time_ms": 17.574, "load_throughput": 2499081.998, "learn_time_ms": 1112.536, "learn_throughput": 39477.387, "synch_weights_time_ms": 0.899}, "counters": {"num_env_steps_sampled": 11882640, "num_env_steps_trained": 11882640, "num_agent_steps_sampled": 11882640, "num_agent_steps_trained": 11882640}, "done": false, "episodes_total": 7723, "training_iteration": 1900, "trial_id": "e8087_00000", "date": "2023-08-06_10-51-35", "timestamp": 1691308295, "time_this_iter_s": 61.348273277282715, "time_total_s": 30402.487615823746, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 921.7161874771118, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.95172413793103, "ram_util_percent": 70.70459770114942}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.8749999999999995e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.03656846649795, "policy_loss": -1859647.2650498815, "vf_loss": 4248519.83345481}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10633.5, "diff_num_grad_updates_vs_sampler_policy": 10632.5}}, "num_env_steps_sampled": 11926560, "num_env_steps_trained": 11926560, "num_agent_steps_sampled": 11926560, "num_agent_steps_trained": 11926560}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155238.97606849374, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21646301370836418, "mean_inference_ms": 0.3579484466639078, "mean_action_processing_ms": 0.08924954709659709, "mean_env_wait_ms": 0.6987214090682596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035524368286132812, "StateBufferConnector_ms": 0.002580881118774414, "ViewRequirementAgentConnector_ms": 0.06639212369918823}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155238.97606849374, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21646301370836418, "mean_inference_ms": 0.3579484466639078, "mean_action_processing_ms": 0.08924954709659709, "mean_env_wait_ms": 0.6987214090682596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035524368286132812, "StateBufferConnector_ms": 0.002580881118774414, "ViewRequirementAgentConnector_ms": 0.06639212369918823}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11926560, "num_agent_steps_trained": 11926560, "num_env_steps_sampled": 11926560, "num_env_steps_trained": 11926560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.877465890511, "num_env_steps_trained_throughput_per_sec": 719.877465890511, "timesteps_total": 11926560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11926560, "timers": {"training_iteration_time_ms": 61253.415, "sample_time_ms": 60122.489, "load_time_ms": 17.673, "load_throughput": 2485154.699, "learn_time_ms": 1112.198, "learn_throughput": 39489.381, "synch_weights_time_ms": 0.901}, "counters": {"num_env_steps_sampled": 11926560, "num_env_steps_trained": 11926560, "num_agent_steps_sampled": 11926560, "num_agent_steps_trained": 11926560}, "done": false, "episodes_total": 7724, "training_iteration": 1901, "trial_id": "e8087_00000", "date": "2023-08-06_10-52-36", "timestamp": 1691308356, "time_this_iter_s": 61.0129919052124, "time_total_s": 30463.500607728958, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 982.7291793823242, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.237209302325585, "ram_util_percent": 70.72906976744184}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.1874999999999995e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0078803860411, "policy_loss": -1881144.8548509248, "vf_loss": 4376217.0752551025}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11319.5, "diff_num_grad_updates_vs_sampler_policy": 11318.5}}, "num_env_steps_sampled": 11970480, "num_env_steps_trained": 11970480, "num_agent_steps_sampled": 11970480, "num_agent_steps_trained": 11970480}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155146.06517379778, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21649433333483717, "mean_inference_ms": 0.3579274289421534, "mean_action_processing_ms": 0.08925267396617682, "mean_env_wait_ms": 0.6981254888492194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003535607281853171, "StateBufferConnector_ms": 0.0025665058809168197, "ViewRequirementAgentConnector_ms": 0.06637012257295496}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155146.06517379778, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21649433333483717, "mean_inference_ms": 0.3579274289421534, "mean_action_processing_ms": 0.08925267396617682, "mean_env_wait_ms": 0.6981254888492194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003535607281853171, "StateBufferConnector_ms": 0.0025665058809168197, "ViewRequirementAgentConnector_ms": 0.06637012257295496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11970480, "num_agent_steps_trained": 11970480, "num_env_steps_sampled": 11970480, "num_env_steps_trained": 11970480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.0721826734025, "num_env_steps_trained_throughput_per_sec": 719.0721826734025, "timesteps_total": 11970480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11970480, "timers": {"training_iteration_time_ms": 61196.643, "sample_time_ms": 60065.991, "load_time_ms": 17.516, "load_throughput": 2507388.642, "learn_time_ms": 1112.081, "learn_throughput": 39493.528, "synch_weights_time_ms": 0.9}, "counters": {"num_env_steps_sampled": 11970480, "num_env_steps_trained": 11970480, "num_agent_steps_sampled": 11970480, "num_agent_steps_trained": 11970480}, "done": false, "episodes_total": 7725, "training_iteration": 1902, "trial_id": "e8087_00000", "date": "2023-08-06_10-53-38", "timestamp": 1691308418, "time_this_iter_s": 61.08145785331726, "time_total_s": 30524.582065582275, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1043.8106372356415, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.308139534883722, "ram_util_percent": 70.88139534883719}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.19198701819596, "policy_loss": -2164223.2988708317, "vf_loss": 4581605.195335277}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12005.5, "diff_num_grad_updates_vs_sampler_policy": 12004.5}}, "num_env_steps_sampled": 12014400, "num_env_steps_trained": 12014400, "num_agent_steps_sampled": 12014400, "num_agent_steps_trained": 12014400}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155227.05839796667, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21652880851954878, "mean_inference_ms": 0.3579064455552945, "mean_action_processing_ms": 0.08925523688266129, "mean_env_wait_ms": 0.6975738531193605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003517998589409722, "StateBufferConnector_ms": 0.0025510787963867188, "ViewRequirementAgentConnector_ms": 0.06641546885172527}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155227.05839796667, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21652880851954878, "mean_inference_ms": 0.3579064455552945, "mean_action_processing_ms": 0.08925523688266129, "mean_env_wait_ms": 0.6975738531193605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003517998589409722, "StateBufferConnector_ms": 0.0025510787963867188, "ViewRequirementAgentConnector_ms": 0.06641546885172527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12014400, "num_agent_steps_trained": 12014400, "num_env_steps_sampled": 12014400, "num_env_steps_trained": 12014400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.3556711588927, "num_env_steps_trained_throughput_per_sec": 718.3556711588927, "timesteps_total": 12014400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12014400, "timers": {"training_iteration_time_ms": 61200.335, "sample_time_ms": 60079.436, "load_time_ms": 17.477, "load_throughput": 2512967.435, "learn_time_ms": 1102.369, "learn_throughput": 39841.463, "synch_weights_time_ms": 0.895}, "counters": {"num_env_steps_sampled": 12014400, "num_env_steps_trained": 12014400, "num_agent_steps_sampled": 12014400, "num_agent_steps_trained": 12014400}, "done": false, "episodes_total": 7726, "training_iteration": 1903, "trial_id": "e8087_00000", "date": "2023-08-06_10-54-39", "timestamp": 1691308479, "time_this_iter_s": 61.14237904548645, "time_total_s": 30585.724444627762, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1104.953016281128, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.275862068965516, "ram_util_percent": 71.01609195402301}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.93535309282754, "policy_loss": -1809164.8211438593, "vf_loss": 4407315.051931486}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12691.5, "diff_num_grad_updates_vs_sampler_policy": 12690.5}}, "num_env_steps_sampled": 12058320, "num_env_steps_trained": 12058320, "num_agent_steps_sampled": 12058320, "num_agent_steps_trained": 12058320}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155177.40789120307, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21656313417180334, "mean_inference_ms": 0.357888183336085, "mean_action_processing_ms": 0.08925719624585998, "mean_env_wait_ms": 0.6970599052319455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003513536955180921, "StateBufferConnector_ms": 0.002536020780864515, "ViewRequirementAgentConnector_ms": 0.06640208394903886}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155177.40789120307, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21656313417180334, "mean_inference_ms": 0.357888183336085, "mean_action_processing_ms": 0.08925719624585998, "mean_env_wait_ms": 0.6970599052319455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003513536955180921, "StateBufferConnector_ms": 0.002536020780864515, "ViewRequirementAgentConnector_ms": 0.06640208394903886}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12058320, "num_agent_steps_trained": 12058320, "num_env_steps_sampled": 12058320, "num_env_steps_trained": 12058320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.8347166655691, "num_env_steps_trained_throughput_per_sec": 717.8347166655691, "timesteps_total": 12058320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12058320, "timers": {"training_iteration_time_ms": 61216.22, "sample_time_ms": 60087.361, "load_time_ms": 17.28, "load_throughput": 2541735.863, "learn_time_ms": 1110.53, "learn_throughput": 39548.699, "synch_weights_time_ms": 0.894}, "counters": {"num_env_steps_sampled": 12058320, "num_env_steps_trained": 12058320, "num_agent_steps_sampled": 12058320, "num_agent_steps_trained": 12058320}, "done": false, "episodes_total": 7727, "training_iteration": 1904, "trial_id": "e8087_00000", "date": "2023-08-06_10-55-40", "timestamp": 1691308540, "time_this_iter_s": 61.186503887176514, "time_total_s": 30646.91094851494, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1166.1395201683044, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.173255813953485, "ram_util_percent": 71.03139534883721}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.05801969923016, "policy_loss": -1970058.5987894041, "vf_loss": 4416313.581177114}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13377.5, "diff_num_grad_updates_vs_sampler_policy": 13376.5}}, "num_env_steps_sampled": 12102240, "num_env_steps_trained": 12102240, "num_agent_steps_sampled": 12102240, "num_agent_steps_trained": 12102240}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155129.11186068258, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21658558222635302, "mean_inference_ms": 0.3578749241893998, "mean_action_processing_ms": 0.08925985589815126, "mean_env_wait_ms": 0.6965935336474783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034809112548828125, "StateBufferConnector_ms": 0.002542734146118164, "ViewRequirementAgentConnector_ms": 0.0664365291595459}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155129.11186068258, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21658558222635302, "mean_inference_ms": 0.3578749241893998, "mean_action_processing_ms": 0.08925985589815126, "mean_env_wait_ms": 0.6965935336474783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034809112548828125, "StateBufferConnector_ms": 0.002542734146118164, "ViewRequirementAgentConnector_ms": 0.0664365291595459}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12102240, "num_agent_steps_trained": 12102240, "num_env_steps_sampled": 12102240, "num_env_steps_trained": 12102240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.307051161935, "num_env_steps_trained_throughput_per_sec": 717.307051161935, "timesteps_total": 12102240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12102240, "timers": {"training_iteration_time_ms": 61247.182, "sample_time_ms": 60117.804, "load_time_ms": 17.249, "load_throughput": 2546267.989, "learn_time_ms": 1111.082, "learn_throughput": 39529.03, "synch_weights_time_ms": 0.891}, "counters": {"num_env_steps_sampled": 12102240, "num_env_steps_trained": 12102240, "num_agent_steps_sampled": 12102240, "num_agent_steps_trained": 12102240}, "done": false, "episodes_total": 7728, "training_iteration": 1905, "trial_id": "e8087_00000", "date": "2023-08-06_10-56-41", "timestamp": 1691308601, "time_this_iter_s": 61.231614112854004, "time_total_s": 30708.142562627792, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1227.3711342811584, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.154022988505748, "ram_util_percent": 71.15977011494252}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.83933660657345, "policy_loss": -2226648.385374909, "vf_loss": 4364789.74016035}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14063.5, "diff_num_grad_updates_vs_sampler_policy": 14062.5}}, "num_env_steps_sampled": 12146160, "num_env_steps_trained": 12146160, "num_agent_steps_sampled": 12146160, "num_agent_steps_trained": 12146160}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155078.99082773714, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.216609783873708, "mean_inference_ms": 0.3578621107762678, "mean_action_processing_ms": 0.08926241651202196, "mean_env_wait_ms": 0.6961861023494001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034865878877185638, "StateBufferConnector_ms": 0.0025431315104166665, "ViewRequirementAgentConnector_ms": 0.06661755698067802}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155078.99082773714, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.216609783873708, "mean_inference_ms": 0.3578621107762678, "mean_action_processing_ms": 0.08926241651202196, "mean_env_wait_ms": 0.6961861023494001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034865878877185638, "StateBufferConnector_ms": 0.0025431315104166665, "ViewRequirementAgentConnector_ms": 0.06661755698067802}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12146160, "num_agent_steps_trained": 12146160, "num_env_steps_sampled": 12146160, "num_env_steps_trained": 12146160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.8464056524986, "num_env_steps_trained_throughput_per_sec": 711.8464056524986, "timesteps_total": 12146160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12146160, "timers": {"training_iteration_time_ms": 61228.982, "sample_time_ms": 60100.099, "load_time_ms": 17.145, "load_throughput": 2561659.916, "learn_time_ms": 1110.692, "learn_throughput": 39542.913, "synch_weights_time_ms": 0.889}, "counters": {"num_env_steps_sampled": 12146160, "num_env_steps_trained": 12146160, "num_agent_steps_sampled": 12146160, "num_agent_steps_trained": 12146160}, "done": false, "episodes_total": 7729, "training_iteration": 1906, "trial_id": "e8087_00000", "date": "2023-08-06_10-57-43", "timestamp": 1691308663, "time_this_iter_s": 61.701271057128906, "time_total_s": 30769.84383368492, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1289.0724053382874, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.306896551724137, "ram_util_percent": 71.17701149425287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.12383170169574, "policy_loss": -1920922.073014418, "vf_loss": 4426154.551931486}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14749.5, "diff_num_grad_updates_vs_sampler_policy": 14748.5}}, "num_env_steps_sampled": 12190080, "num_env_steps_trained": 12190080, "num_agent_steps_sampled": 12190080, "num_agent_steps_trained": 12190080}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155041.7202696225, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21663368651480883, "mean_inference_ms": 0.357849709843466, "mean_action_processing_ms": 0.08926512430441567, "mean_env_wait_ms": 0.6957846941915927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034711577675559306, "StateBufferConnector_ms": 0.0025434927506880326, "ViewRequirementAgentConnector_ms": 0.06664341146295721}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155041.7202696225, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21663368651480883, "mean_inference_ms": 0.357849709843466, "mean_action_processing_ms": 0.08926512430441567, "mean_env_wait_ms": 0.6957846941915927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034711577675559306, "StateBufferConnector_ms": 0.0025434927506880326, "ViewRequirementAgentConnector_ms": 0.06664341146295721}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12190080, "num_agent_steps_trained": 12190080, "num_env_steps_sampled": 12190080, "num_env_steps_trained": 12190080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 723.0052955690416, "num_env_steps_trained_throughput_per_sec": 723.0052955690416, "timesteps_total": 12190080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12190080, "timers": {"training_iteration_time_ms": 61176.618, "sample_time_ms": 60048.187, "load_time_ms": 17.095, "load_throughput": 2569112.324, "learn_time_ms": 1110.279, "learn_throughput": 39557.615, "synch_weights_time_ms": 0.899}, "counters": {"num_env_steps_sampled": 12190080, "num_env_steps_trained": 12190080, "num_agent_steps_sampled": 12190080, "num_agent_steps_trained": 12190080}, "done": false, "episodes_total": 7730, "training_iteration": 1907, "trial_id": "e8087_00000", "date": "2023-08-06_10-58-44", "timestamp": 1691308724, "time_this_iter_s": 60.74928689002991, "time_total_s": 30830.59312057495, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1349.8216922283173, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.266279069767446, "ram_util_percent": 71.25116279069766}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.09030391593024, "policy_loss": -1819182.7875250548, "vf_loss": 4457141.240706997}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15435.5, "diff_num_grad_updates_vs_sampler_policy": 15434.5}}, "num_env_steps_sampled": 12234000, "num_env_steps_trained": 12234000, "num_agent_steps_sampled": 12234000, "num_agent_steps_trained": 12234000}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155035.1077284013, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21665816888485404, "mean_inference_ms": 0.35783756183474247, "mean_action_processing_ms": 0.08926755209388597, "mean_env_wait_ms": 0.6954103488120871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034529229869013247, "StateBufferConnector_ms": 0.0025552252064580503, "ViewRequirementAgentConnector_ms": 0.06658719933551291}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155035.1077284013, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21665816888485404, "mean_inference_ms": 0.35783756183474247, "mean_action_processing_ms": 0.08926755209388597, "mean_env_wait_ms": 0.6954103488120871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034529229869013247, "StateBufferConnector_ms": 0.0025552252064580503, "ViewRequirementAgentConnector_ms": 0.06658719933551291}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12234000, "num_agent_steps_trained": 12234000, "num_env_steps_sampled": 12234000, "num_env_steps_trained": 12234000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.5313157771642, "num_env_steps_trained_throughput_per_sec": 717.5313157771642, "timesteps_total": 12234000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12234000, "timers": {"training_iteration_time_ms": 61205.454, "sample_time_ms": 60081.614, "load_time_ms": 16.958, "load_throughput": 2589880.985, "learn_time_ms": 1105.824, "learn_throughput": 39716.984, "synch_weights_time_ms": 0.899}, "counters": {"num_env_steps_sampled": 12234000, "num_env_steps_trained": 12234000, "num_agent_steps_sampled": 12234000, "num_agent_steps_trained": 12234000}, "done": false, "episodes_total": 7731, "training_iteration": 1908, "trial_id": "e8087_00000", "date": "2023-08-06_10-59-45", "timestamp": 1691308785, "time_this_iter_s": 61.21260476112366, "time_total_s": 30891.805725336075, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1411.034296989441, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 16.929885057471264, "ram_util_percent": 71.26436781609195}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.11749089633065, "policy_loss": -2234961.342949959, "vf_loss": 4659368.907069971}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16121.5, "diff_num_grad_updates_vs_sampler_policy": 16120.5}}, "num_env_steps_sampled": 12277920, "num_env_steps_trained": 12277920, "num_agent_steps_sampled": 12277920, "num_agent_steps_trained": 12277920}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155156.83710176215, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21668208332920155, "mean_inference_ms": 0.35782382939075913, "mean_action_processing_ms": 0.08926975000179531, "mean_env_wait_ms": 0.6950681061343119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003569324811299642, "StateBufferConnector_ms": 0.0025739272435506186, "ViewRequirementAgentConnector_ms": 0.06659825642903645}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155156.83710176215, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21668208332920155, "mean_inference_ms": 0.35782382939075913, "mean_action_processing_ms": 0.08926975000179531, "mean_env_wait_ms": 0.6950681061343119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003569324811299642, "StateBufferConnector_ms": 0.0025739272435506186, "ViewRequirementAgentConnector_ms": 0.06659825642903645}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12277920, "num_agent_steps_trained": 12277920, "num_env_steps_sampled": 12277920, "num_env_steps_trained": 12277920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.0138003668413, "num_env_steps_trained_throughput_per_sec": 716.0138003668413, "timesteps_total": 12277920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12277920, "timers": {"training_iteration_time_ms": 61198.163, "sample_time_ms": 60074.116, "load_time_ms": 16.916, "load_throughput": 2596305.288, "learn_time_ms": 1106.075, "learn_throughput": 39707.959, "synch_weights_time_ms": 0.897}, "counters": {"num_env_steps_sampled": 12277920, "num_env_steps_trained": 12277920, "num_agent_steps_sampled": 12277920, "num_agent_steps_trained": 12277920}, "done": false, "episodes_total": 7732, "training_iteration": 1909, "trial_id": "e8087_00000", "date": "2023-08-06_11-00-46", "timestamp": 1691308846, "time_this_iter_s": 61.342150926589966, "time_total_s": 30953.147876262665, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1472.3764479160309, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.611494252873563, "ram_util_percent": 71.34942528735633}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.08098168553835, "policy_loss": -2046397.7042382243, "vf_loss": 4415140.097576531}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16807.5, "diff_num_grad_updates_vs_sampler_policy": 16806.5}}, "num_env_steps_sampled": 12321840, "num_env_steps_trained": 12321840, "num_agent_steps_sampled": 12321840, "num_agent_steps_trained": 12321840}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155121.8782764406, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21670090147343798, "mean_inference_ms": 0.35781016417279604, "mean_action_processing_ms": 0.08927154000735392, "mean_env_wait_ms": 0.69473299358755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003543853759765625, "StateBufferConnector_ms": 0.0025815963745117188, "ViewRequirementAgentConnector_ms": 0.06653690338134766}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155121.8782764406, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21670090147343798, "mean_inference_ms": 0.35781016417279604, "mean_action_processing_ms": 0.08927154000735392, "mean_env_wait_ms": 0.69473299358755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003543853759765625, "StateBufferConnector_ms": 0.0025815963745117188, "ViewRequirementAgentConnector_ms": 0.06653690338134766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12321840, "num_agent_steps_trained": 12321840, "num_env_steps_sampled": 12321840, "num_env_steps_trained": 12321840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 724.0273489953006, "num_env_steps_trained_throughput_per_sec": 724.0273489953006, "timesteps_total": 12321840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12321840, "timers": {"training_iteration_time_ms": 61129.683, "sample_time_ms": 60004.86, "load_time_ms": 16.926, "load_throughput": 2594754.703, "learn_time_ms": 1106.846, "learn_throughput": 39680.332, "synch_weights_time_ms": 0.893}, "counters": {"num_env_steps_sampled": 12321840, "num_env_steps_trained": 12321840, "num_agent_steps_sampled": 12321840, "num_agent_steps_trained": 12321840}, "done": false, "episodes_total": 7733, "training_iteration": 1910, "trial_id": "e8087_00000", "date": "2023-08-06_11-01-47", "timestamp": 1691308907, "time_this_iter_s": 60.66349983215332, "time_total_s": 31013.811376094818, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1533.0399477481842, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.258139534883718, "ram_util_percent": 71.38255813953491}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.01297584289017, "policy_loss": -1967420.7972195016, "vf_loss": 4303176.372631195}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17493.5, "diff_num_grad_updates_vs_sampler_policy": 17492.5}}, "num_env_steps_sampled": 12365760, "num_env_steps_trained": 12365760, "num_agent_steps_sampled": 12365760, "num_agent_steps_trained": 12365760}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155038.72928083327, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21672265774218963, "mean_inference_ms": 0.3577961495833898, "mean_action_processing_ms": 0.08927325234414708, "mean_env_wait_ms": 0.6944327858163709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003539598905123197, "StateBufferConnector_ms": 0.0025950945340670072, "ViewRequirementAgentConnector_ms": 0.06678104400634766}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155038.72928083327, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21672265774218963, "mean_inference_ms": 0.3577961495833898, "mean_action_processing_ms": 0.08927325234414708, "mean_env_wait_ms": 0.6944327858163709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003539598905123197, "StateBufferConnector_ms": 0.0025950945340670072, "ViewRequirementAgentConnector_ms": 0.06678104400634766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12365760, "num_agent_steps_trained": 12365760, "num_env_steps_sampled": 12365760, "num_env_steps_trained": 12365760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.1248651906202, "num_env_steps_trained_throughput_per_sec": 712.1248651906202, "timesteps_total": 12365760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12365760, "timers": {"training_iteration_time_ms": 61196.102, "sample_time_ms": 60069.825, "load_time_ms": 16.842, "load_throughput": 2607768.808, "learn_time_ms": 1108.386, "learn_throughput": 39625.171, "synch_weights_time_ms": 0.891}, "counters": {"num_env_steps_sampled": 12365760, "num_env_steps_trained": 12365760, "num_agent_steps_sampled": 12365760, "num_agent_steps_trained": 12365760}, "done": false, "episodes_total": 7734, "training_iteration": 1911, "trial_id": "e8087_00000", "date": "2023-08-06_11-02-49", "timestamp": 1691308969, "time_this_iter_s": 61.67731714248657, "time_total_s": 31075.488693237305, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1594.7172648906708, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 17.936781609195403, "ram_util_percent": 71.39885057471264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.17715952347737, "policy_loss": -2106181.700021638, "vf_loss": 4714713.377642129}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18179.5, "diff_num_grad_updates_vs_sampler_policy": 18178.5}}, "num_env_steps_sampled": 12409680, "num_env_steps_trained": 12409680, "num_agent_steps_sampled": 12409680, "num_agent_steps_trained": 12409680}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155153.87294856113, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2167425850931491, "mean_inference_ms": 0.3577823539069428, "mean_action_processing_ms": 0.08927485616107894, "mean_env_wait_ms": 0.694149192517676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035268289071542246, "StateBufferConnector_ms": 0.002590815226236979, "ViewRequirementAgentConnector_ms": 0.06673689241762515}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158597.7107778979, "episode_reward_mean": -155153.87294856113, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2167425850931491, "mean_inference_ms": 0.3577823539069428, "mean_action_processing_ms": 0.08927485616107894, "mean_env_wait_ms": 0.694149192517676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035268289071542246, "StateBufferConnector_ms": 0.002590815226236979, "ViewRequirementAgentConnector_ms": 0.06673689241762515}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12409680, "num_agent_steps_trained": 12409680, "num_env_steps_sampled": 12409680, "num_env_steps_trained": 12409680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.6245884032695, "num_env_steps_trained_throughput_per_sec": 718.6245884032695, "timesteps_total": 12409680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12409680, "timers": {"training_iteration_time_ms": 61199.907, "sample_time_ms": 60073.814, "load_time_ms": 16.779, "load_throughput": 2617528.904, "learn_time_ms": 1108.265, "learn_throughput": 39629.494, "synch_weights_time_ms": 0.891}, "counters": {"num_env_steps_sampled": 12409680, "num_env_steps_trained": 12409680, "num_agent_steps_sampled": 12409680, "num_agent_steps_trained": 12409680}, "done": false, "episodes_total": 7735, "training_iteration": 1912, "trial_id": "e8087_00000", "date": "2023-08-06_11-03-50", "timestamp": 1691309030, "time_this_iter_s": 61.119776010513306, "time_total_s": 31136.608469247818, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1655.837040901184, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 16.89310344827586, "ram_util_percent": 71.39195402298849}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.18935939243863, "policy_loss": -2161259.1043925383, "vf_loss": 4717852.025874635}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18865.5, "diff_num_grad_updates_vs_sampler_policy": 18864.5}}, "num_env_steps_sampled": 12453600, "num_env_steps_trained": 12453600, "num_agent_steps_sampled": 12453600, "num_agent_steps_trained": 12453600}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155282.7597971141, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21675847615859137, "mean_inference_ms": 0.3577688156179022, "mean_action_processing_ms": 0.08927636439920206, "mean_env_wait_ms": 0.6938726089044305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035141195569719586, "StateBufferConnector_ms": 0.0025825841086251394, "ViewRequirementAgentConnector_ms": 0.06670781544276647}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155282.7597971141, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21675847615859137, "mean_inference_ms": 0.3577688156179022, "mean_action_processing_ms": 0.08927636439920206, "mean_env_wait_ms": 0.6938726089044305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035141195569719586, "StateBufferConnector_ms": 0.0025825841086251394, "ViewRequirementAgentConnector_ms": 0.06670781544276647}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12453600, "num_agent_steps_trained": 12453600, "num_env_steps_sampled": 12453600, "num_env_steps_trained": 12453600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 722.7955708812286, "num_env_steps_trained_throughput_per_sec": 722.7955708812286, "timesteps_total": 12453600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12453600, "timers": {"training_iteration_time_ms": 61162.351, "sample_time_ms": 60035.058, "load_time_ms": 16.955, "load_throughput": 2590434.557, "learn_time_ms": 1109.293, "learn_throughput": 39592.776, "synch_weights_time_ms": 0.888}, "counters": {"num_env_steps_sampled": 12453600, "num_env_steps_trained": 12453600, "num_agent_steps_sampled": 12453600, "num_agent_steps_trained": 12453600}, "done": false, "episodes_total": 7736, "training_iteration": 1913, "trial_id": "e8087_00000", "date": "2023-08-06_11-04-51", "timestamp": 1691309091, "time_this_iter_s": 60.766746044158936, "time_total_s": 31197.375215291977, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1716.603786945343, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 18.084883720930236, "ram_util_percent": 71.4406976744186}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.17917372811985, "policy_loss": -2254920.418441372, "vf_loss": 4539235.441326531}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19551.5, "diff_num_grad_updates_vs_sampler_policy": 19550.5}}, "num_env_steps_sampled": 12497520, "num_env_steps_trained": 12497520, "num_agent_steps_sampled": 12497520, "num_agent_steps_trained": 12497520}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155320.09775950707, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21677360161828246, "mean_inference_ms": 0.357756729800448, "mean_action_processing_ms": 0.08927742365295073, "mean_env_wait_ms": 0.6936156084354707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035960098792766704, "StateBufferConnector_ms": 0.002579853452485183, "ViewRequirementAgentConnector_ms": 0.06669718643714642}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155320.09775950707, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21677360161828246, "mean_inference_ms": 0.357756729800448, "mean_action_processing_ms": 0.08927742365295073, "mean_env_wait_ms": 0.6936156084354707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035960098792766704, "StateBufferConnector_ms": 0.002579853452485183, "ViewRequirementAgentConnector_ms": 0.06669718643714642}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12497520, "num_agent_steps_trained": 12497520, "num_env_steps_sampled": 12497520, "num_env_steps_trained": 12497520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.2287101718573, "num_env_steps_trained_throughput_per_sec": 715.2287101718573, "timesteps_total": 12497520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12497520, "timers": {"training_iteration_time_ms": 61184.643, "sample_time_ms": 60057.898, "load_time_ms": 17.021, "load_throughput": 2580329.222, "learn_time_ms": 1108.665, "learn_throughput": 39615.229, "synch_weights_time_ms": 0.903}, "counters": {"num_env_steps_sampled": 12497520, "num_env_steps_trained": 12497520, "num_agent_steps_sampled": 12497520, "num_agent_steps_trained": 12497520}, "done": false, "episodes_total": 7737, "training_iteration": 1914, "trial_id": "e8087_00000", "date": "2023-08-06_11-05-52", "timestamp": 1691309152, "time_this_iter_s": 61.409477949142456, "time_total_s": 31258.78469324112, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1778.0132648944855, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 16.94712643678161, "ram_util_percent": 71.32413793103449}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.95375283466484, "policy_loss": -2069385.7320005011, "vf_loss": 4243839.229774052}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20237.5, "diff_num_grad_updates_vs_sampler_policy": 20236.5}}, "num_env_steps_sampled": 12541440, "num_env_steps_trained": 12541440, "num_agent_steps_sampled": 12541440, "num_agent_steps_trained": 12541440}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155213.60729813096, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.216787069893078, "mean_inference_ms": 0.35774497986096104, "mean_action_processing_ms": 0.08927878432145703, "mean_env_wait_ms": 0.6933831757847536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035730997721354165, "StateBufferConnector_ms": 0.002578099568684896, "ViewRequirementAgentConnector_ms": 0.06666024525960286}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155213.60729813096, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.216787069893078, "mean_inference_ms": 0.35774497986096104, "mean_action_processing_ms": 0.08927878432145703, "mean_env_wait_ms": 0.6933831757847536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035730997721354165, "StateBufferConnector_ms": 0.002578099568684896, "ViewRequirementAgentConnector_ms": 0.06666024525960286}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12541440, "num_agent_steps_trained": 12541440, "num_env_steps_sampled": 12541440, "num_env_steps_trained": 12541440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.3592670169716, "num_env_steps_trained_throughput_per_sec": 713.3592670169716, "timesteps_total": 12541440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12541440, "timers": {"training_iteration_time_ms": 61218.528, "sample_time_ms": 60092.442, "load_time_ms": 16.863, "load_throughput": 2604594.2, "learn_time_ms": 1108.153, "learn_throughput": 39633.533, "synch_weights_time_ms": 0.914}, "counters": {"num_env_steps_sampled": 12541440, "num_env_steps_trained": 12541440, "num_agent_steps_sampled": 12541440, "num_agent_steps_trained": 12541440}, "done": false, "episodes_total": 7738, "training_iteration": 1915, "trial_id": "e8087_00000", "date": "2023-08-06_11-06-54", "timestamp": 1691309214, "time_this_iter_s": 61.57046604156494, "time_total_s": 31320.355159282684, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1839.5837309360504, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.164367816091957, "ram_util_percent": 71.32298850574713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.21746038764974, "policy_loss": -1801308.009720071, "vf_loss": 4355548.674562682}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20923.5, "diff_num_grad_updates_vs_sampler_policy": 20922.5}}, "num_env_steps_sampled": 12585360, "num_env_steps_trained": 12585360, "num_agent_steps_sampled": 12585360, "num_agent_steps_trained": 12585360}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155141.70820391693, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21680239181931937, "mean_inference_ms": 0.35773260500469817, "mean_action_processing_ms": 0.08928054078547942, "mean_env_wait_ms": 0.6931522259675281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003563973211473034, "StateBufferConnector_ms": 0.0025764588386781753, "ViewRequirementAgentConnector_ms": 0.06666721836213142}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155141.70820391693, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21680239181931937, "mean_inference_ms": 0.35773260500469817, "mean_action_processing_ms": 0.08928054078547942, "mean_env_wait_ms": 0.6931522259675281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003563973211473034, "StateBufferConnector_ms": 0.0025764588386781753, "ViewRequirementAgentConnector_ms": 0.06666721836213142}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12585360, "num_agent_steps_trained": 12585360, "num_env_steps_sampled": 12585360, "num_env_steps_trained": 12585360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 722.322269118975, "num_env_steps_trained_throughput_per_sec": 722.322269118975, "timesteps_total": 12585360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12585360, "timers": {"training_iteration_time_ms": 61129.046, "sample_time_ms": 60003.424, "load_time_ms": 16.904, "load_throughput": 2598246.128, "learn_time_ms": 1107.646, "learn_throughput": 39651.653, "synch_weights_time_ms": 0.917}, "counters": {"num_env_steps_sampled": 12585360, "num_env_steps_trained": 12585360, "num_agent_steps_sampled": 12585360, "num_agent_steps_trained": 12585360}, "done": false, "episodes_total": 7739, "training_iteration": 1916, "trial_id": "e8087_00000", "date": "2023-08-06_11-07-54", "timestamp": 1691309274, "time_this_iter_s": 60.806560039520264, "time_total_s": 31381.161719322205, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1900.3902909755707, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 18.813953488372096, "ram_util_percent": 71.30465116279069}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0128486566571, "policy_loss": -2200322.854640238, "vf_loss": 4426056.252459913}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21609.5, "diff_num_grad_updates_vs_sampler_policy": 21608.5}}, "num_env_steps_sampled": 12629280, "num_env_steps_trained": 12629280, "num_agent_steps_sampled": 12629280, "num_agent_steps_trained": 12629280}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155130.96987774936, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21681690878161503, "mean_inference_ms": 0.3577205933283024, "mean_action_processing_ms": 0.08928263386960307, "mean_env_wait_ms": 0.6929365335422629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003546476364135742, "StateBufferConnector_ms": 0.002583116292953491, "ViewRequirementAgentConnector_ms": 0.0666104257106781}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155130.96987774936, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21681690878161503, "mean_inference_ms": 0.3577205933283024, "mean_action_processing_ms": 0.08928263386960307, "mean_env_wait_ms": 0.6929365335422629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003546476364135742, "StateBufferConnector_ms": 0.002583116292953491, "ViewRequirementAgentConnector_ms": 0.0666104257106781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12629280, "num_agent_steps_trained": 12629280, "num_env_steps_sampled": 12629280, "num_env_steps_trained": 12629280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.826085756303, "num_env_steps_trained_throughput_per_sec": 715.826085756303, "timesteps_total": 12629280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12629280, "timers": {"training_iteration_time_ms": 61189.971, "sample_time_ms": 60063.709, "load_time_ms": 16.975, "load_throughput": 2587272.917, "learn_time_ms": 1108.217, "learn_throughput": 39631.233, "synch_weights_time_ms": 0.914}, "counters": {"num_env_steps_sampled": 12629280, "num_env_steps_trained": 12629280, "num_agent_steps_sampled": 12629280, "num_agent_steps_trained": 12629280}, "done": false, "episodes_total": 7740, "training_iteration": 1917, "trial_id": "e8087_00000", "date": "2023-08-06_11-08-56", "timestamp": 1691309336, "time_this_iter_s": 61.35863709449768, "time_total_s": 31442.520356416702, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1961.7489280700684, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 17.17126436781609, "ram_util_percent": 71.24367816091954}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.128720920218, "policy_loss": -2033354.7268130467, "vf_loss": 4521824.294825073}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22295.5, "diff_num_grad_updates_vs_sampler_policy": 22294.5}}, "num_env_steps_sampled": 12673200, "num_env_steps_trained": 12673200, "num_agent_steps_sampled": 12673200, "num_agent_steps_trained": 12673200}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155152.8720150346, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21683229428165549, "mean_inference_ms": 0.35770973698129965, "mean_action_processing_ms": 0.08928476029278577, "mean_env_wait_ms": 0.6927292752454416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003537264737215909, "StateBufferConnector_ms": 0.0025828679402669272, "ViewRequirementAgentConnector_ms": 0.06657080216841264}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155152.8720150346, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21683229428165549, "mean_inference_ms": 0.35770973698129965, "mean_action_processing_ms": 0.08928476029278577, "mean_env_wait_ms": 0.6927292752454416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003537264737215909, "StateBufferConnector_ms": 0.0025828679402669272, "ViewRequirementAgentConnector_ms": 0.06657080216841264}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12673200, "num_agent_steps_trained": 12673200, "num_env_steps_sampled": 12673200, "num_env_steps_trained": 12673200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.7684230715344, "num_env_steps_trained_throughput_per_sec": 717.7684230715344, "timesteps_total": 12673200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12673200, "timers": {"training_iteration_time_ms": 61187.949, "sample_time_ms": 60061.353, "load_time_ms": 17.101, "load_throughput": 2568249.117, "learn_time_ms": 1108.419, "learn_throughput": 39624.005, "synch_weights_time_ms": 0.92}, "counters": {"num_env_steps_sampled": 12673200, "num_env_steps_trained": 12673200, "num_agent_steps_sampled": 12673200, "num_agent_steps_trained": 12673200}, "done": false, "episodes_total": 7741, "training_iteration": 1918, "trial_id": "e8087_00000", "date": "2023-08-06_11-09-57", "timestamp": 1691309397, "time_this_iter_s": 61.192272901535034, "time_total_s": 31503.712629318237, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2022.9412009716034, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 17.263953488372092, "ram_util_percent": 71.25232558139535}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.06258487979454, "policy_loss": -2235590.183855685, "vf_loss": 4632945.796829446}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22981.5, "diff_num_grad_updates_vs_sampler_policy": 22980.5}}, "num_env_steps_sampled": 12717120, "num_env_steps_trained": 12717120, "num_agent_steps_sampled": 12717120, "num_agent_steps_trained": 12717120}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155220.4354016612, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2168476094647743, "mean_inference_ms": 0.35769947776482064, "mean_action_processing_ms": 0.08928656783804655, "mean_env_wait_ms": 0.6925324238669903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003523686352898093, "StateBufferConnector_ms": 0.0025812317343319163, "ViewRequirementAgentConnector_ms": 0.06652018603156595}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155220.4354016612, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2168476094647743, "mean_inference_ms": 0.35769947776482064, "mean_action_processing_ms": 0.08928656783804655, "mean_env_wait_ms": 0.6925324238669903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003523686352898093, "StateBufferConnector_ms": 0.0025812317343319163, "ViewRequirementAgentConnector_ms": 0.06652018603156595}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12717120, "num_agent_steps_trained": 12717120, "num_env_steps_sampled": 12717120, "num_env_steps_trained": 12717120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.4490921433562, "num_env_steps_trained_throughput_per_sec": 717.4490921433562, "timesteps_total": 12717120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12717120, "timers": {"training_iteration_time_ms": 61175.678, "sample_time_ms": 60048.726, "load_time_ms": 17.272, "load_throughput": 2542914.769, "learn_time_ms": 1108.604, "learn_throughput": 39617.376, "synch_weights_time_ms": 0.918}, "counters": {"num_env_steps_sampled": 12717120, "num_env_steps_trained": 12717120, "num_agent_steps_sampled": 12717120, "num_agent_steps_trained": 12717120}, "done": false, "episodes_total": 7742, "training_iteration": 1919, "trial_id": "e8087_00000", "date": "2023-08-06_11-10-58", "timestamp": 1691309458, "time_this_iter_s": 61.21944785118103, "time_total_s": 31564.93207716942, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2084.1606488227844, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 17.39310344827586, "ram_util_percent": 71.24367816091954}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1397396788305, "policy_loss": -1924331.3495752097, "vf_loss": 4529442.355594023}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23667.5, "diff_num_grad_updates_vs_sampler_policy": 23666.5}}, "num_env_steps_sampled": 12761040, "num_env_steps_trained": 12761040, "num_agent_steps_sampled": 12761040, "num_agent_steps_trained": 12761040}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155248.83028168406, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21686226493220742, "mean_inference_ms": 0.3576900116603929, "mean_action_processing_ms": 0.08928835806448114, "mean_env_wait_ms": 0.6923392345577665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035115650721958707, "StateBufferConnector_ms": 0.0025796890258789062, "ViewRequirementAgentConnector_ms": 0.0664731434413365}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155248.83028168406, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21686226493220742, "mean_inference_ms": 0.3576900116603929, "mean_action_processing_ms": 0.08928835806448114, "mean_env_wait_ms": 0.6923392345577665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035115650721958707, "StateBufferConnector_ms": 0.0025796890258789062, "ViewRequirementAgentConnector_ms": 0.0664731434413365}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12761040, "num_agent_steps_trained": 12761040, "num_env_steps_sampled": 12761040, "num_env_steps_trained": 12761040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 721.079291507536, "num_env_steps_trained_throughput_per_sec": 721.079291507536, "timesteps_total": 12761040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12761040, "timers": {"training_iteration_time_ms": 61200.478, "sample_time_ms": 60072.869, "load_time_ms": 17.289, "load_throughput": 2540312.808, "learn_time_ms": 1109.243, "learn_throughput": 39594.57, "synch_weights_time_ms": 0.92}, "counters": {"num_env_steps_sampled": 12761040, "num_env_steps_trained": 12761040, "num_agent_steps_sampled": 12761040, "num_agent_steps_trained": 12761040}, "done": false, "episodes_total": 7743, "training_iteration": 1920, "trial_id": "e8087_00000", "date": "2023-08-06_11-11-59", "timestamp": 1691309519, "time_this_iter_s": 60.911272048950195, "time_total_s": 31625.84334921837, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2145.0719208717346, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 17.134883720930233, "ram_util_percent": 71.2767441860465}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0105406647173, "policy_loss": -2117869.2249738066, "vf_loss": 4427967.748997813}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24353.5, "diff_num_grad_updates_vs_sampler_policy": 24352.5}}, "num_env_steps_sampled": 12804960, "num_env_steps_trained": 12804960, "num_agent_steps_sampled": 12804960, "num_agent_steps_trained": 12804960}, "sampler_results": {"episode_reward_max": -151935.40643110286, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155231.13602733135, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21687603770639352, "mean_inference_ms": 0.3576809807925531, "mean_action_processing_ms": 0.08928998890610834, "mean_env_wait_ms": 0.6921562257903361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034974681006537545, "StateBufferConnector_ms": 0.0025782320234510633, "ViewRequirementAgentConnector_ms": 0.0664618280198839}}, "episode_reward_max": -151935.40643110286, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155231.13602733135, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21687603770639352, "mean_inference_ms": 0.3576809807925531, "mean_action_processing_ms": 0.08928998890610834, "mean_env_wait_ms": 0.6921562257903361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034974681006537545, "StateBufferConnector_ms": 0.0025782320234510633, "ViewRequirementAgentConnector_ms": 0.0664618280198839}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12804960, "num_agent_steps_trained": 12804960, "num_env_steps_sampled": 12804960, "num_env_steps_trained": 12804960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.2080602651234, "num_env_steps_trained_throughput_per_sec": 717.2080602651234, "timesteps_total": 12804960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12804960, "timers": {"training_iteration_time_ms": 61156.767, "sample_time_ms": 60030.6, "load_time_ms": 17.149, "load_throughput": 2561100.769, "learn_time_ms": 1107.943, "learn_throughput": 39641.046, "synch_weights_time_ms": 0.917}, "counters": {"num_env_steps_sampled": 12804960, "num_env_steps_trained": 12804960, "num_agent_steps_sampled": 12804960, "num_agent_steps_trained": 12804960}, "done": false, "episodes_total": 7744, "training_iteration": 1921, "trial_id": "e8087_00000", "date": "2023-08-06_11-13-00", "timestamp": 1691309580, "time_this_iter_s": 61.240087032318115, "time_total_s": 31687.083436250687, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2206.3120079040527, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 17.674712643678163, "ram_util_percent": 71.2655172413793}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1001303981414, "policy_loss": -1910134.4856562044, "vf_loss": 4177983.990069242}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25039.5, "diff_num_grad_updates_vs_sampler_policy": 25038.5}}, "num_env_steps_sampled": 12848880, "num_env_steps_trained": 12848880, "num_agent_steps_sampled": 12848880, "num_agent_steps_trained": 12848880}, "sampler_results": {"episode_reward_max": -151042.48829549566, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155117.92933187634, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21689047851638552, "mean_inference_ms": 0.3576729166907668, "mean_action_processing_ms": 0.08929181917296933, "mean_env_wait_ms": 0.6919862696454687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034918656220307223, "StateBufferConnector_ms": 0.0025755650288349875, "ViewRequirementAgentConnector_ms": 0.06647174422805374}}, "episode_reward_max": -151042.48829549566, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155117.92933187634, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21689047851638552, "mean_inference_ms": 0.3576729166907668, "mean_action_processing_ms": 0.08929181917296933, "mean_env_wait_ms": 0.6919862696454687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034918656220307223, "StateBufferConnector_ms": 0.0025755650288349875, "ViewRequirementAgentConnector_ms": 0.06647174422805374}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12848880, "num_agent_steps_trained": 12848880, "num_env_steps_sampled": 12848880, "num_env_steps_trained": 12848880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.9620712338444, "num_env_steps_trained_throughput_per_sec": 712.9620712338444, "timesteps_total": 12848880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12848880, "timers": {"training_iteration_time_ms": 61205.307, "sample_time_ms": 60079.497, "load_time_ms": 17.138, "load_throughput": 2562739.723, "learn_time_ms": 1107.591, "learn_throughput": 39653.619, "synch_weights_time_ms": 0.922}, "counters": {"num_env_steps_sampled": 12848880, "num_env_steps_trained": 12848880, "num_agent_steps_sampled": 12848880, "num_agent_steps_trained": 12848880}, "done": false, "episodes_total": 7745, "training_iteration": 1922, "trial_id": "e8087_00000", "date": "2023-08-06_11-14-02", "timestamp": 1691309642, "time_this_iter_s": 61.6050181388855, "time_total_s": 31748.688454389572, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2267.9170260429382, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 17.090804597701155, "ram_util_percent": 71.26091954022988}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9857030929699, "policy_loss": -2003724.5191525829, "vf_loss": 4350689.784347667}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25725.5, "diff_num_grad_updates_vs_sampler_policy": 25724.5}}, "num_env_steps_sampled": 12892800, "num_env_steps_trained": 12892800, "num_agent_steps_sampled": 12892800, "num_agent_steps_trained": 12892800}, "sampler_results": {"episode_reward_max": -151042.48829549566, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155083.444843632, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21690261598457256, "mean_inference_ms": 0.3576652292351313, "mean_action_processing_ms": 0.08929375345618847, "mean_env_wait_ms": 0.6918211597481929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003483420924136513, "StateBufferConnector_ms": 0.002574920654296875, "ViewRequirementAgentConnector_ms": 0.06646921760157536}}, "episode_reward_max": -151042.48829549566, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155083.444843632, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21690261598457256, "mean_inference_ms": 0.3576652292351313, "mean_action_processing_ms": 0.08929375345618847, "mean_env_wait_ms": 0.6918211597481929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003483420924136513, "StateBufferConnector_ms": 0.002574920654296875, "ViewRequirementAgentConnector_ms": 0.06646921760157536}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12892800, "num_agent_steps_trained": 12892800, "num_env_steps_sampled": 12892800, "num_env_steps_trained": 12892800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 720.8105706845087, "num_env_steps_trained_throughput_per_sec": 720.8105706845087, "timesteps_total": 12892800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12892800, "timers": {"training_iteration_time_ms": 61222.041, "sample_time_ms": 60097.961, "load_time_ms": 17.102, "load_throughput": 2568059.36, "learn_time_ms": 1105.888, "learn_throughput": 39714.704, "synch_weights_time_ms": 0.93}, "counters": {"num_env_steps_sampled": 12892800, "num_env_steps_trained": 12892800, "num_agent_steps_sampled": 12892800, "num_agent_steps_trained": 12892800}, "done": false, "episodes_total": 7746, "training_iteration": 1923, "trial_id": "e8087_00000", "date": "2023-08-06_11-15-03", "timestamp": 1691309703, "time_this_iter_s": 60.93403482437134, "time_total_s": 31809.622489213943, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2328.8510608673096, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 18.246511627906976, "ram_util_percent": 71.2546511627907}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9726913496635, "policy_loss": -2176326.487511104, "vf_loss": 4417192.907161078}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26411.5, "diff_num_grad_updates_vs_sampler_policy": 26410.5}}, "num_env_steps_sampled": 12936720, "num_env_steps_trained": 12936720, "num_agent_steps_sampled": 12936720, "num_agent_steps_trained": 12936720}, "sampler_results": {"episode_reward_max": -151042.48829549566, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155072.56667446534, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21691362170977796, "mean_inference_ms": 0.35765975412702083, "mean_action_processing_ms": 0.08929584776157862, "mean_env_wait_ms": 0.691666079185645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034833565736428285, "StateBufferConnector_ms": 0.0025718640058468548, "ViewRequirementAgentConnector_ms": 0.06659581111027645}}, "episode_reward_max": -151042.48829549566, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155072.56667446534, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21691362170977796, "mean_inference_ms": 0.35765975412702083, "mean_action_processing_ms": 0.08929584776157862, "mean_env_wait_ms": 0.691666079185645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034833565736428285, "StateBufferConnector_ms": 0.0025718640058468548, "ViewRequirementAgentConnector_ms": 0.06659581111027645}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12936720, "num_agent_steps_trained": 12936720, "num_env_steps_sampled": 12936720, "num_env_steps_trained": 12936720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.422557591882, "num_env_steps_trained_throughput_per_sec": 713.422557591882, "timesteps_total": 12936720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12936720, "timers": {"training_iteration_time_ms": 61237.587, "sample_time_ms": 60112.657, "load_time_ms": 17.066, "load_throughput": 2573609.652, "learn_time_ms": 1106.778, "learn_throughput": 39682.757, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 12936720, "num_env_steps_trained": 12936720, "num_agent_steps_sampled": 12936720, "num_agent_steps_trained": 12936720}, "done": false, "episodes_total": 7747, "training_iteration": 1924, "trial_id": "e8087_00000", "date": "2023-08-06_11-16-05", "timestamp": 1691309765, "time_this_iter_s": 61.56516981124878, "time_total_s": 31871.187659025192, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2390.4162306785583, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 18.313793103448276, "ram_util_percent": 70.883908045977}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.88747750774417, "policy_loss": -1904828.3503894862, "vf_loss": 4081087.1419460643}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27097.5, "diff_num_grad_updates_vs_sampler_policy": 27096.5}}, "num_env_steps_sampled": 12980640, "num_env_steps_trained": 12980640, "num_agent_steps_sampled": 12980640, "num_agent_steps_trained": 12980640}, "sampler_results": {"episode_reward_max": -150023.33206758465, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -154946.3358092933, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21692359515866505, "mean_inference_ms": 0.35765400223473665, "mean_action_processing_ms": 0.08929784746673859, "mean_env_wait_ms": 0.6915253187590985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034797191619873047, "StateBufferConnector_ms": 0.0025725364685058594, "ViewRequirementAgentConnector_ms": 0.06661474704742432}}, "episode_reward_max": -150023.33206758465, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -154946.3358092933, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21692359515866505, "mean_inference_ms": 0.35765400223473665, "mean_action_processing_ms": 0.08929784746673859, "mean_env_wait_ms": 0.6915253187590985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034797191619873047, "StateBufferConnector_ms": 0.0025725364685058594, "ViewRequirementAgentConnector_ms": 0.06661474704742432}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12980640, "num_agent_steps_trained": 12980640, "num_env_steps_sampled": 12980640, "num_env_steps_trained": 12980640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.1097906422208, "num_env_steps_trained_throughput_per_sec": 712.1097906422208, "timesteps_total": 12980640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12980640, "timers": {"training_iteration_time_ms": 61248.39, "sample_time_ms": 60123.558, "load_time_ms": 17.079, "load_throughput": 2571515.163, "learn_time_ms": 1106.674, "learn_throughput": 39686.468, "synch_weights_time_ms": 0.914}, "counters": {"num_env_steps_sampled": 12980640, "num_env_steps_trained": 12980640, "num_agent_steps_sampled": 12980640, "num_agent_steps_trained": 12980640}, "done": false, "episodes_total": 7748, "training_iteration": 1925, "trial_id": "e8087_00000", "date": "2023-08-06_11-17-06", "timestamp": 1691309826, "time_this_iter_s": 61.678921937942505, "time_total_s": 31932.866580963135, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2452.095152616501, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 17.319318181818183, "ram_util_percent": 71.10795454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.2411705884572, "policy_loss": -2170592.9404353816, "vf_loss": 4651216.398141399}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27783.5, "diff_num_grad_updates_vs_sampler_policy": 27782.5}}, "num_env_steps_sampled": 13024560, "num_env_steps_trained": 13024560, "num_agent_steps_sampled": 13024560, "num_agent_steps_trained": 13024560}, "sampler_results": {"episode_reward_max": -150023.33206758465, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155013.07909320615, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2169314354779369, "mean_inference_ms": 0.357648280891191, "mean_action_processing_ms": 0.08929971338532618, "mean_env_wait_ms": 0.6913894085135776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034750961675876525, "StateBufferConnector_ms": 0.002573176128108327, "ViewRequirementAgentConnector_ms": 0.06658391254704173}}, "episode_reward_max": -150023.33206758465, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155013.07909320615, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2169314354779369, "mean_inference_ms": 0.357648280891191, "mean_action_processing_ms": 0.08929971338532618, "mean_env_wait_ms": 0.6913894085135776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034750961675876525, "StateBufferConnector_ms": 0.002573176128108327, "ViewRequirementAgentConnector_ms": 0.06658391254704173}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13024560, "num_agent_steps_trained": 13024560, "num_env_steps_sampled": 13024560, "num_env_steps_trained": 13024560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.8100885000229, "num_env_steps_trained_throughput_per_sec": 719.8100885000229, "timesteps_total": 13024560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13024560, "timers": {"training_iteration_time_ms": 61269.61, "sample_time_ms": 60143.599, "load_time_ms": 16.995, "load_throughput": 2584253.115, "learn_time_ms": 1107.931, "learn_throughput": 39641.475, "synch_weights_time_ms": 0.92}, "counters": {"num_env_steps_sampled": 13024560, "num_env_steps_trained": 13024560, "num_agent_steps_sampled": 13024560, "num_agent_steps_trained": 13024560}, "done": false, "episodes_total": 7749, "training_iteration": 1926, "trial_id": "e8087_00000", "date": "2023-08-06_11-18-07", "timestamp": 1691309887, "time_this_iter_s": 61.0187201499939, "time_total_s": 31993.88530111313, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2513.1138727664948, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 16.755813953488374, "ram_util_percent": 71.09767441860464}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1619964688582, "policy_loss": -2126050.5393272825, "vf_loss": 4487049.012208455}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28469.5, "diff_num_grad_updates_vs_sampler_policy": 28468.5}}, "num_env_steps_sampled": 13068480, "num_env_steps_trained": 13068480, "num_agent_steps_sampled": 13068480, "num_agent_steps_trained": 13068480}, "sampler_results": {"episode_reward_max": -150023.33206758465, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155027.91389597283, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21693866007928175, "mean_inference_ms": 0.3576426269287204, "mean_action_processing_ms": 0.08930135212159938, "mean_env_wait_ms": 0.6912534566831807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034729639689127603, "StateBufferConnector_ms": 0.0025777589707147506, "ViewRequirementAgentConnector_ms": 0.0666039330618722}}, "episode_reward_max": -150023.33206758465, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155027.91389597283, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21693866007928175, "mean_inference_ms": 0.3576426269287204, "mean_action_processing_ms": 0.08930135212159938, "mean_env_wait_ms": 0.6912534566831807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034729639689127603, "StateBufferConnector_ms": 0.0025777589707147506, "ViewRequirementAgentConnector_ms": 0.0666039330618722}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13068480, "num_agent_steps_trained": 13068480, "num_env_steps_sampled": 13068480, "num_env_steps_trained": 13068480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 723.1784997226807, "num_env_steps_trained_throughput_per_sec": 723.1784997226807, "timesteps_total": 13068480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13068480, "timers": {"training_iteration_time_ms": 61207.231, "sample_time_ms": 60082.026, "load_time_ms": 16.964, "load_throughput": 2589003.768, "learn_time_ms": 1107.152, "learn_throughput": 39669.346, "synch_weights_time_ms": 0.924}, "counters": {"num_env_steps_sampled": 13068480, "num_env_steps_trained": 13068480, "num_agent_steps_sampled": 13068480, "num_agent_steps_trained": 13068480}, "done": false, "episodes_total": 7750, "training_iteration": 1927, "trial_id": "e8087_00000", "date": "2023-08-06_11-19-08", "timestamp": 1691309948, "time_this_iter_s": 60.73465299606323, "time_total_s": 32054.619954109192, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2573.848525762558, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 17.16395348837209, "ram_util_percent": 71.06162790697675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3124999999999997e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.12705820155907, "policy_loss": -2400684.7643010886, "vf_loss": 4615518.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29155.5, "diff_num_grad_updates_vs_sampler_policy": 29154.5}}, "num_env_steps_sampled": 13112400, "num_env_steps_trained": 13112400, "num_agent_steps_sampled": 13112400, "num_agent_steps_trained": 13112400}, "sampler_results": {"episode_reward_max": -150023.33206758465, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155084.73304945292, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21694422912741695, "mean_inference_ms": 0.35763742645851687, "mean_action_processing_ms": 0.08930304234246167, "mean_env_wait_ms": 0.6911259561620388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035252681998319403, "StateBufferConnector_ms": 0.002578801886979924, "ViewRequirementAgentConnector_ms": 0.06658975468125454}}, "episode_reward_max": -150023.33206758465, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155084.73304945292, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21694422912741695, "mean_inference_ms": 0.35763742645851687, "mean_action_processing_ms": 0.08930304234246167, "mean_env_wait_ms": 0.6911259561620388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035252681998319403, "StateBufferConnector_ms": 0.002578801886979924, "ViewRequirementAgentConnector_ms": 0.06658975468125454}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13112400, "num_agent_steps_trained": 13112400, "num_env_steps_sampled": 13112400, "num_env_steps_trained": 13112400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.8241024895484, "num_env_steps_trained_throughput_per_sec": 715.8241024895484, "timesteps_total": 13112400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13112400, "timers": {"training_iteration_time_ms": 61223.852, "sample_time_ms": 60100.117, "load_time_ms": 16.783, "load_throughput": 2616982.282, "learn_time_ms": 1105.866, "learn_throughput": 39715.487, "synch_weights_time_ms": 0.92}, "counters": {"num_env_steps_sampled": 13112400, "num_env_steps_trained": 13112400, "num_agent_steps_sampled": 13112400, "num_agent_steps_trained": 13112400}, "done": false, "episodes_total": 7751, "training_iteration": 1928, "trial_id": "e8087_00000", "date": "2023-08-06_11-20-10", "timestamp": 1691310010, "time_this_iter_s": 61.35853910446167, "time_total_s": 32115.978493213654, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2635.2070648670197, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 17.419540229885058, "ram_util_percent": 71.06206896551723}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.1249999999999995e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0597470119465, "policy_loss": -1859859.5631434494, "vf_loss": 4518652.1862244895}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29841.5, "diff_num_grad_updates_vs_sampler_policy": 29840.5}}, "num_env_steps_sampled": 13156320, "num_env_steps_trained": 13156320, "num_agent_steps_sampled": 13156320, "num_agent_steps_trained": 13156320}, "sampler_results": {"episode_reward_max": -150023.33206758465, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155094.80593682473, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21695009490152117, "mean_inference_ms": 0.3576323498959001, "mean_action_processing_ms": 0.08930459987788054, "mean_env_wait_ms": 0.6909982919350616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035264275290749288, "StateBufferConnector_ms": 0.002599846233021129, "ViewRequirementAgentConnector_ms": 0.06673932075500488}}, "episode_reward_max": -150023.33206758465, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -155094.80593682473, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21695009490152117, "mean_inference_ms": 0.3576323498959001, "mean_action_processing_ms": 0.08930459987788054, "mean_env_wait_ms": 0.6909982919350616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035264275290749288, "StateBufferConnector_ms": 0.002599846233021129, "ViewRequirementAgentConnector_ms": 0.06673932075500488}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13156320, "num_agent_steps_trained": 13156320, "num_env_steps_sampled": 13156320, "num_env_steps_trained": 13156320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 722.3627506676697, "num_env_steps_trained_throughput_per_sec": 722.3627506676697, "timesteps_total": 13156320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13156320, "timers": {"training_iteration_time_ms": 61182.211, "sample_time_ms": 60057.418, "load_time_ms": 16.603, "load_throughput": 2645351.763, "learn_time_ms": 1107.105, "learn_throughput": 39671.036, "synch_weights_time_ms": 0.921}, "counters": {"num_env_steps_sampled": 13156320, "num_env_steps_trained": 13156320, "num_agent_steps_sampled": 13156320, "num_agent_steps_trained": 13156320}, "done": false, "episodes_total": 7752, "training_iteration": 1929, "trial_id": "e8087_00000", "date": "2023-08-06_11-21-10", "timestamp": 1691310070, "time_this_iter_s": 60.80322885513306, "time_total_s": 32176.781722068787, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2696.0102937221527, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.3953488372093, "ram_util_percent": 71.04534883720927}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.9374999999999998e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.62770018285636, "policy_loss": -1982950.362950984, "vf_loss": 3802288.988520408}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30527.5, "diff_num_grad_updates_vs_sampler_policy": 30526.5}}, "num_env_steps_sampled": 13200240, "num_env_steps_trained": 13200240, "num_agent_steps_sampled": 13200240, "num_agent_steps_trained": 13200240}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -154903.11185194147, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21695650544655348, "mean_inference_ms": 0.357627291161593, "mean_action_processing_ms": 0.08930603127748642, "mean_env_wait_ms": 0.6908865347231881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003521177503797743, "StateBufferConnector_ms": 0.0025955835978190103, "ViewRequirementAgentConnector_ms": 0.06670316060384114}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -154903.11185194147, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21695650544655348, "mean_inference_ms": 0.357627291161593, "mean_action_processing_ms": 0.08930603127748642, "mean_env_wait_ms": 0.6908865347231881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003521177503797743, "StateBufferConnector_ms": 0.0025955835978190103, "ViewRequirementAgentConnector_ms": 0.06670316060384114}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13200240, "num_agent_steps_trained": 13200240, "num_env_steps_sampled": 13200240, "num_env_steps_trained": 13200240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 705.8200276675236, "num_env_steps_trained_throughput_per_sec": 705.8200276675236, "timesteps_total": 13200240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13200240, "timers": {"training_iteration_time_ms": 61313.89, "sample_time_ms": 60189.557, "load_time_ms": 16.668, "load_throughput": 2635063.042, "learn_time_ms": 1106.577, "learn_throughput": 39689.968, "synch_weights_time_ms": 0.924}, "counters": {"num_env_steps_sampled": 13200240, "num_env_steps_trained": 13200240, "num_agent_steps_sampled": 13200240, "num_agent_steps_trained": 13200240}, "done": false, "episodes_total": 7753, "training_iteration": 1930, "trial_id": "e8087_00000", "date": "2023-08-06_11-22-13", "timestamp": 1691310133, "time_this_iter_s": 62.228463649749756, "time_total_s": 32239.010185718536, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2758.2387573719025, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 17.1625, "ram_util_percent": 71.02386363636361}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7500000000000002e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9972688547029, "policy_loss": -2030264.2704850356, "vf_loss": 4457933.771137026}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31213.5, "diff_num_grad_updates_vs_sampler_policy": 31212.5}}, "num_env_steps_sampled": 13244160, "num_env_steps_trained": 13244160, "num_agent_steps_sampled": 13244160, "num_agent_steps_trained": 13244160}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -154906.96349980385, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21696345523649607, "mean_inference_ms": 0.3576222721564747, "mean_action_processing_ms": 0.08930752345956221, "mean_env_wait_ms": 0.6907777047339626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035140825354534645, "StateBufferConnector_ms": 0.0025920245958411174, "ViewRequirementAgentConnector_ms": 0.06667634715204654}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -154906.96349980385, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21696345523649607, "mean_inference_ms": 0.3576222721564747, "mean_action_processing_ms": 0.08930752345956221, "mean_env_wait_ms": 0.6907777047339626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035140825354534645, "StateBufferConnector_ms": 0.0025920245958411174, "ViewRequirementAgentConnector_ms": 0.06667634715204654}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13244160, "num_agent_steps_trained": 13244160, "num_env_steps_sampled": 13244160, "num_env_steps_trained": 13244160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.9693133724945, "num_env_steps_trained_throughput_per_sec": 717.9693133724945, "timesteps_total": 13244160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13244160, "timers": {"training_iteration_time_ms": 61307.398, "sample_time_ms": 60183.307, "load_time_ms": 16.953, "load_throughput": 2590682.284, "learn_time_ms": 1106.041, "learn_throughput": 39709.203, "synch_weights_time_ms": 0.932}, "counters": {"num_env_steps_sampled": 13244160, "num_env_steps_trained": 13244160, "num_agent_steps_sampled": 13244160, "num_agent_steps_trained": 13244160}, "done": false, "episodes_total": 7754, "training_iteration": 1931, "trial_id": "e8087_00000", "date": "2023-08-06_11-23-14", "timestamp": 1691310194, "time_this_iter_s": 61.175408124923706, "time_total_s": 32300.18559384346, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2819.414165496826, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 16.845977011494252, "ram_util_percent": 71.01379310344828}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.5624999999999999e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0149027654798, "policy_loss": -1937541.3210271273, "vf_loss": 4345994.933126822}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31899.5, "diff_num_grad_updates_vs_sampler_policy": 31898.5}}, "num_env_steps_sampled": 13288080, "num_env_steps_trained": 13288080, "num_agent_steps_sampled": 13288080, "num_agent_steps_trained": 13288080}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -154884.01591344373, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21696985094421797, "mean_inference_ms": 0.3576171388739163, "mean_action_processing_ms": 0.08930880194440077, "mean_env_wait_ms": 0.6906693465956288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003507796754228308, "StateBufferConnector_ms": 0.0025830370314577794, "ViewRequirementAgentConnector_ms": 0.06662277465171003}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -154884.01591344373, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21696985094421797, "mean_inference_ms": 0.3576171388739163, "mean_action_processing_ms": 0.08930880194440077, "mean_env_wait_ms": 0.6906693465956288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003507796754228308, "StateBufferConnector_ms": 0.0025830370314577794, "ViewRequirementAgentConnector_ms": 0.06662277465171003}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13288080, "num_agent_steps_trained": 13288080, "num_env_steps_sampled": 13288080, "num_env_steps_trained": 13288080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 722.179801208316, "num_env_steps_trained_throughput_per_sec": 722.179801208316, "timesteps_total": 13288080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13288080, "timers": {"training_iteration_time_ms": 61228.765, "sample_time_ms": 60104.245, "load_time_ms": 16.908, "load_throughput": 2597579.324, "learn_time_ms": 1106.49, "learn_throughput": 39693.066, "synch_weights_time_ms": 0.949}, "counters": {"num_env_steps_sampled": 13288080, "num_env_steps_trained": 13288080, "num_agent_steps_sampled": 13288080, "num_agent_steps_trained": 13288080}, "done": false, "episodes_total": 7755, "training_iteration": 1932, "trial_id": "e8087_00000", "date": "2023-08-06_11-24-15", "timestamp": 1691310255, "time_this_iter_s": 60.81923198699951, "time_total_s": 32361.00482583046, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2880.2333974838257, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 17.29186046511628, "ram_util_percent": 71.05116279069767}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.375e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.08683180739513, "policy_loss": -1834305.5694498224, "vf_loss": 4355414.541180758}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32585.5, "diff_num_grad_updates_vs_sampler_policy": 32584.5}}, "num_env_steps_sampled": 13332000, "num_env_steps_trained": 13332000, "num_agent_steps_sampled": 13332000, "num_agent_steps_trained": 13332000}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -154856.83503709125, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2169751911961532, "mean_inference_ms": 0.3576119671017302, "mean_action_processing_ms": 0.08931003103653057, "mean_env_wait_ms": 0.6905632935450366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003556410471598307, "StateBufferConnector_ms": 0.0025853514671325684, "ViewRequirementAgentConnector_ms": 0.06660421689351399}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -154856.83503709125, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2169751911961532, "mean_inference_ms": 0.3576119671017302, "mean_action_processing_ms": 0.08931003103653057, "mean_env_wait_ms": 0.6905632935450366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003556410471598307, "StateBufferConnector_ms": 0.0025853514671325684, "ViewRequirementAgentConnector_ms": 0.06660421689351399}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13332000, "num_agent_steps_trained": 13332000, "num_env_steps_sampled": 13332000, "num_env_steps_trained": 13332000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 720.5576782161095, "num_env_steps_trained_throughput_per_sec": 720.5576782161095, "timesteps_total": 13332000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13332000, "timers": {"training_iteration_time_ms": 61230.903, "sample_time_ms": 60105.192, "load_time_ms": 16.995, "load_throughput": 2584253.115, "learn_time_ms": 1107.602, "learn_throughput": 39653.247, "synch_weights_time_ms": 0.942}, "counters": {"num_env_steps_sampled": 13332000, "num_env_steps_trained": 13332000, "num_agent_steps_sampled": 13332000, "num_agent_steps_trained": 13332000}, "done": false, "episodes_total": 7756, "training_iteration": 1933, "trial_id": "e8087_00000", "date": "2023-08-06_11-25-16", "timestamp": 1691310316, "time_this_iter_s": 60.9556360244751, "time_total_s": 32421.960461854935, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2941.189033508301, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 17.74186046511628, "ram_util_percent": 71.0453488372093}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1874999999999997e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.05897615393815, "policy_loss": -1694201.8678138666, "vf_loss": 4246350.282981049}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33271.5, "diff_num_grad_updates_vs_sampler_policy": 33270.5}}, "num_env_steps_sampled": 13375920, "num_env_steps_trained": 13375920, "num_agent_steps_sampled": 13375920, "num_agent_steps_trained": 13375920}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -154795.63327295348, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21698045948773242, "mean_inference_ms": 0.35760729476828645, "mean_action_processing_ms": 0.08931120766552024, "mean_env_wait_ms": 0.690460523885865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035504905544981665, "StateBufferConnector_ms": 0.002584652024872449, "ViewRequirementAgentConnector_ms": 0.06658933600600885}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -154795.63327295348, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21698045948773242, "mean_inference_ms": 0.35760729476828645, "mean_action_processing_ms": 0.08931120766552024, "mean_env_wait_ms": 0.690460523885865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035504905544981665, "StateBufferConnector_ms": 0.002584652024872449, "ViewRequirementAgentConnector_ms": 0.06658933600600885}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13375920, "num_agent_steps_trained": 13375920, "num_env_steps_sampled": 13375920, "num_env_steps_trained": 13375920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.6163146303555, "num_env_steps_trained_throughput_per_sec": 717.6163146303555, "timesteps_total": 13375920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13375920, "timers": {"training_iteration_time_ms": 61194.926, "sample_time_ms": 60076.59, "load_time_ms": 16.951, "load_throughput": 2591053.963, "learn_time_ms": 1100.285, "learn_throughput": 39916.945, "synch_weights_time_ms": 0.934}, "counters": {"num_env_steps_sampled": 13375920, "num_env_steps_trained": 13375920, "num_agent_steps_sampled": 13375920, "num_agent_steps_trained": 13375920}, "done": false, "episodes_total": 7757, "training_iteration": 1934, "trial_id": "e8087_00000", "date": "2023-08-06_11-26-17", "timestamp": 1691310377, "time_this_iter_s": 61.205349922180176, "time_total_s": 32483.165811777115, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3002.394383430481, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 17.086206896551726, "ram_util_percent": 71.08850574712642}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.01382032566795, "policy_loss": -2180806.9703073753, "vf_loss": 4333580.238155977}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33957.5, "diff_num_grad_updates_vs_sampler_policy": 33956.5}}, "num_env_steps_sampled": 13419840, "num_env_steps_trained": 13419840, "num_agent_steps_sampled": 13419840, "num_agent_steps_trained": 13419840}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -154774.94317752687, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21698528851015464, "mean_inference_ms": 0.3576030144223486, "mean_action_processing_ms": 0.08931232142198839, "mean_env_wait_ms": 0.6903633101562647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003531932830810547, "StateBufferConnector_ms": 0.0025911331176757812, "ViewRequirementAgentConnector_ms": 0.06656074523925781}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -154774.94317752687, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21698528851015464, "mean_inference_ms": 0.3576030144223486, "mean_action_processing_ms": 0.08931232142198839, "mean_env_wait_ms": 0.6903633101562647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003531932830810547, "StateBufferConnector_ms": 0.0025911331176757812, "ViewRequirementAgentConnector_ms": 0.06656074523925781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13419840, "num_agent_steps_trained": 13419840, "num_env_steps_sampled": 13419840, "num_env_steps_trained": 13419840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.2530620520823, "num_env_steps_trained_throughput_per_sec": 715.2530620520823, "timesteps_total": 13419840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13419840, "timers": {"training_iteration_time_ms": 61167.822, "sample_time_ms": 60050.359, "load_time_ms": 16.956, "load_throughput": 2590168.667, "learn_time_ms": 1099.406, "learn_throughput": 39948.838, "synch_weights_time_ms": 0.932}, "counters": {"num_env_steps_sampled": 13419840, "num_env_steps_trained": 13419840, "num_agent_steps_sampled": 13419840, "num_agent_steps_trained": 13419840}, "done": false, "episodes_total": 7758, "training_iteration": 1935, "trial_id": "e8087_00000", "date": "2023-08-06_11-27-18", "timestamp": 1691310438, "time_this_iter_s": 61.40749502182007, "time_total_s": 32544.573306798935, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3063.801878452301, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 16.995402298850575, "ram_util_percent": 71.06436781609193}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1709298892897, "policy_loss": -2250827.259344251, "vf_loss": 4484199.574708455}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34643.5, "diff_num_grad_updates_vs_sampler_policy": 34642.5}}, "num_env_steps_sampled": 13463760, "num_env_steps_trained": 13463760, "num_agent_steps_sampled": 13463760, "num_agent_steps_trained": 13463760}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -154792.2543647663, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2169906304930132, "mean_inference_ms": 0.35759855493865683, "mean_action_processing_ms": 0.08931342643879246, "mean_env_wait_ms": 0.690267440494855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035248550714231004, "StateBufferConnector_ms": 0.0025931526632869944, "ViewRequirementAgentConnector_ms": 0.06654589783911612}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -154792.2543647663, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2169906304930132, "mean_inference_ms": 0.35759855493865683, "mean_action_processing_ms": 0.08931342643879246, "mean_env_wait_ms": 0.690267440494855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035248550714231004, "StateBufferConnector_ms": 0.0025931526632869944, "ViewRequirementAgentConnector_ms": 0.06654589783911612}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13463760, "num_agent_steps_trained": 13463760, "num_env_steps_sampled": 13463760, "num_env_steps_trained": 13463760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.7408339877456, "num_env_steps_trained_throughput_per_sec": 719.7408339877456, "timesteps_total": 13463760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13463760, "timers": {"training_iteration_time_ms": 61168.41, "sample_time_ms": 60051.127, "load_time_ms": 17.034, "load_throughput": 2578368.131, "learn_time_ms": 1099.159, "learn_throughput": 39957.84, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 13463760, "num_env_steps_trained": 13463760, "num_agent_steps_sampled": 13463760, "num_agent_steps_trained": 13463760}, "done": false, "episodes_total": 7759, "training_iteration": 1936, "trial_id": "e8087_00000", "date": "2023-08-06_11-28-19", "timestamp": 1691310499, "time_this_iter_s": 61.02473974227905, "time_total_s": 32605.598046541214, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3124.82661819458, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 17.513953488372096, "ram_util_percent": 71.07441860465114}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.04530708157284, "policy_loss": -1973153.5620216837, "vf_loss": 4390131.432762391}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35329.5, "diff_num_grad_updates_vs_sampler_policy": 35328.5}}, "num_env_steps_sampled": 13507680, "num_env_steps_trained": 13507680, "num_agent_steps_sampled": 13507680, "num_agent_steps_trained": 13507680}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -154769.09545745028, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2169964107168198, "mean_inference_ms": 0.35759399402407266, "mean_action_processing_ms": 0.08931460941226682, "mean_env_wait_ms": 0.6901723513457395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035208005171555737, "StateBufferConnector_ms": 0.0025923435504619893, "ViewRequirementAgentConnector_ms": 0.06657838821411133}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -154769.09545745028, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2169964107168198, "mean_inference_ms": 0.35759399402407266, "mean_action_processing_ms": 0.08931460941226682, "mean_env_wait_ms": 0.6901723513457395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035208005171555737, "StateBufferConnector_ms": 0.0025923435504619893, "ViewRequirementAgentConnector_ms": 0.06657838821411133}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13507680, "num_agent_steps_trained": 13507680, "num_env_steps_sampled": 13507680, "num_env_steps_trained": 13507680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 720.2207791833071, "num_env_steps_trained_throughput_per_sec": 720.2207791833071, "timesteps_total": 13507680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13507680, "timers": {"training_iteration_time_ms": 61193.35, "sample_time_ms": 60075.518, "load_time_ms": 16.927, "load_throughput": 2594608.516, "learn_time_ms": 1099.807, "learn_throughput": 39934.29, "synch_weights_time_ms": 0.931}, "counters": {"num_env_steps_sampled": 13507680, "num_env_steps_trained": 13507680, "num_agent_steps_sampled": 13507680, "num_agent_steps_trained": 13507680}, "done": false, "episodes_total": 7760, "training_iteration": 1937, "trial_id": "e8087_00000", "date": "2023-08-06_11-29-20", "timestamp": 1691310560, "time_this_iter_s": 60.98404788970947, "time_total_s": 32666.582094430923, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3185.8106660842896, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 17.672093023255815, "ram_util_percent": 71.07906976744185}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.934071977354, "policy_loss": -2018911.246154963, "vf_loss": 4419022.185131195}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36015.5, "diff_num_grad_updates_vs_sampler_policy": 36014.5}}, "num_env_steps_sampled": 13551600, "num_env_steps_trained": 13551600, "num_agent_steps_sampled": 13551600, "num_agent_steps_trained": 13551600}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -154768.1988469888, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21700287599967735, "mean_inference_ms": 0.3575897549779161, "mean_action_processing_ms": 0.08931584367332568, "mean_env_wait_ms": 0.6900834984942202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003511950654803582, "StateBufferConnector_ms": 0.0025879661991911112, "ViewRequirementAgentConnector_ms": 0.06654847343012972}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -158762.7047080434, "episode_reward_mean": -154768.1988469888, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21700287599967735, "mean_inference_ms": 0.3575897549779161, "mean_action_processing_ms": 0.08931584367332568, "mean_env_wait_ms": 0.6900834984942202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003511950654803582, "StateBufferConnector_ms": 0.0025879661991911112, "ViewRequirementAgentConnector_ms": 0.06654847343012972}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13551600, "num_agent_steps_trained": 13551600, "num_env_steps_sampled": 13551600, "num_env_steps_trained": 13551600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.4864711871372, "num_env_steps_trained_throughput_per_sec": 711.4864711871372, "timesteps_total": 13551600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13551600, "timers": {"training_iteration_time_ms": 61230.756, "sample_time_ms": 60110.683, "load_time_ms": 17.133, "load_throughput": 2563513.61, "learn_time_ms": 1101.838, "learn_throughput": 39860.687, "synch_weights_time_ms": 0.937}, "counters": {"num_env_steps_sampled": 13551600, "num_env_steps_trained": 13551600, "num_agent_steps_sampled": 13551600, "num_agent_steps_trained": 13551600}, "done": false, "episodes_total": 7761, "training_iteration": 1938, "trial_id": "e8087_00000", "date": "2023-08-06_11-30-22", "timestamp": 1691310622, "time_this_iter_s": 61.73293972015381, "time_total_s": 32728.315034151077, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3247.5436058044434, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 17.235227272727272, "ram_util_percent": 71.11590909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.2300486217087, "policy_loss": -2366338.1278129555, "vf_loss": 4779805.977951895}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36701.5, "diff_num_grad_updates_vs_sampler_policy": 36700.5}}, "num_env_steps_sampled": 13595520, "num_env_steps_trained": 13595520, "num_agent_steps_sampled": 13595520, "num_agent_steps_trained": 13595520}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154858.98704538235, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2170090750054741, "mean_inference_ms": 0.35758553005332794, "mean_action_processing_ms": 0.0893170062013442, "mean_env_wait_ms": 0.6899981909098017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003505636144567419, "StateBufferConnector_ms": 0.0025930228056731046, "ViewRequirementAgentConnector_ms": 0.06653423662538882}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154858.98704538235, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2170090750054741, "mean_inference_ms": 0.35758553005332794, "mean_action_processing_ms": 0.0893170062013442, "mean_env_wait_ms": 0.6899981909098017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003505636144567419, "StateBufferConnector_ms": 0.0025930228056731046, "ViewRequirementAgentConnector_ms": 0.06653423662538882}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13595520, "num_agent_steps_trained": 13595520, "num_env_steps_sampled": 13595520, "num_env_steps_trained": 13595520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.6799741655101, "num_env_steps_trained_throughput_per_sec": 716.6799741655101, "timesteps_total": 13595520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13595520, "timers": {"training_iteration_time_ms": 61278.967, "sample_time_ms": 60159.596, "load_time_ms": 17.282, "load_throughput": 2541308.078, "learn_time_ms": 1100.983, "learn_throughput": 39891.623, "synch_weights_time_ms": 0.94}, "counters": {"num_env_steps_sampled": 13595520, "num_env_steps_trained": 13595520, "num_agent_steps_sampled": 13595520, "num_agent_steps_trained": 13595520}, "done": false, "episodes_total": 7762, "training_iteration": 1939, "trial_id": "e8087_00000", "date": "2023-08-06_11-31-23", "timestamp": 1691310683, "time_this_iter_s": 61.285311222076416, "time_total_s": 32789.600345373154, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3308.82891702652, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 17.27701149425287, "ram_util_percent": 71.04827586206898}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1552086210112, "policy_loss": -2187007.6329505853, "vf_loss": 4608333.745444606}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37387.5, "diff_num_grad_updates_vs_sampler_policy": 37386.5}}, "num_env_steps_sampled": 13639440, "num_env_steps_trained": 13639440, "num_agent_steps_sampled": 13639440, "num_agent_steps_trained": 13639440}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154897.47374272323, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21701536847042388, "mean_inference_ms": 0.357581187851474, "mean_action_processing_ms": 0.08931800049875044, "mean_env_wait_ms": 0.6899156141060804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034982507879083805, "StateBufferConnector_ms": 0.0025970285589044743, "ViewRequirementAgentConnector_ms": 0.06652745333584872}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154897.47374272323, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21701536847042388, "mean_inference_ms": 0.357581187851474, "mean_action_processing_ms": 0.08931800049875044, "mean_env_wait_ms": 0.6899156141060804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034982507879083805, "StateBufferConnector_ms": 0.0025970285589044743, "ViewRequirementAgentConnector_ms": 0.06652745333584872}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13639440, "num_agent_steps_trained": 13639440, "num_env_steps_sampled": 13639440, "num_env_steps_trained": 13639440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.3212599914774, "num_env_steps_trained_throughput_per_sec": 717.3212599914774, "timesteps_total": 13639440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13639440, "timers": {"training_iteration_time_ms": 61179.197, "sample_time_ms": 60058.867, "load_time_ms": 17.29, "load_throughput": 2540249.754, "learn_time_ms": 1101.944, "learn_throughput": 39856.839, "synch_weights_time_ms": 0.931}, "counters": {"num_env_steps_sampled": 13639440, "num_env_steps_trained": 13639440, "num_agent_steps_sampled": 13639440, "num_agent_steps_trained": 13639440}, "done": false, "episodes_total": 7763, "training_iteration": 1940, "trial_id": "e8087_00000", "date": "2023-08-06_11-32-25", "timestamp": 1691310745, "time_this_iter_s": 61.230595111846924, "time_total_s": 32850.830940485, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3370.0595121383667, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 16.976744186046513, "ram_util_percent": 71.06279069767442}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0783507233111, "policy_loss": -2313633.71112541, "vf_loss": 4625108.563046647}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38073.5, "diff_num_grad_updates_vs_sampler_policy": 38072.5}}, "num_env_steps_sampled": 13683360, "num_env_steps_trained": 13683360, "num_agent_steps_sampled": 13683360, "num_agent_steps_trained": 13683360}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154947.7756271097, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21702201444918764, "mean_inference_ms": 0.3575775472097214, "mean_action_processing_ms": 0.08931903961873025, "mean_env_wait_ms": 0.689837562096206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003490703446524484, "StateBufferConnector_ms": 0.002602168491908482, "ViewRequirementAgentConnector_ms": 0.06652942725590297}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154947.7756271097, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21702201444918764, "mean_inference_ms": 0.3575775472097214, "mean_action_processing_ms": 0.08931903961873025, "mean_env_wait_ms": 0.689837562096206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003490703446524484, "StateBufferConnector_ms": 0.002602168491908482, "ViewRequirementAgentConnector_ms": 0.06652942725590297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13683360, "num_agent_steps_trained": 13683360, "num_env_steps_sampled": 13683360, "num_env_steps_trained": 13683360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.3512638714772, "num_env_steps_trained_throughput_per_sec": 712.3512638714772, "timesteps_total": 13683360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13683360, "timers": {"training_iteration_time_ms": 61227.441, "sample_time_ms": 60106.442, "load_time_ms": 17.137, "load_throughput": 2562875.209, "learn_time_ms": 1102.766, "learn_throughput": 39827.122, "synch_weights_time_ms": 0.931}, "counters": {"num_env_steps_sampled": 13683360, "num_env_steps_trained": 13683360, "num_agent_steps_sampled": 13683360, "num_agent_steps_trained": 13683360}, "done": false, "episodes_total": 7764, "training_iteration": 1941, "trial_id": "e8087_00000", "date": "2023-08-06_11-33-26", "timestamp": 1691310806, "time_this_iter_s": 61.65769696235657, "time_total_s": 32912.48863744736, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3431.7172091007233, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 17.123863636363637, "ram_util_percent": 71.03636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.99799673897877, "policy_loss": -2453264.2095139395, "vf_loss": 4578114.422740525}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38759.5, "diff_num_grad_updates_vs_sampler_policy": 38758.5}}, "num_env_steps_sampled": 13727280, "num_env_steps_trained": 13727280, "num_agent_steps_sampled": 13727280, "num_agent_steps_trained": 13727280}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154987.32654479184, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21702902263614227, "mean_inference_ms": 0.3575737615495697, "mean_action_processing_ms": 0.0893200663603824, "mean_env_wait_ms": 0.6897627734868089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034846757587633633, "StateBufferConnector_ms": 0.0026000173468338815, "ViewRequirementAgentConnector_ms": 0.06652631257709704}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154987.32654479184, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21702902263614227, "mean_inference_ms": 0.3575737615495697, "mean_action_processing_ms": 0.0893200663603824, "mean_env_wait_ms": 0.6897627734868089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034846757587633633, "StateBufferConnector_ms": 0.0026000173468338815, "ViewRequirementAgentConnector_ms": 0.06652631257709704}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13727280, "num_agent_steps_trained": 13727280, "num_env_steps_sampled": 13727280, "num_env_steps_trained": 13727280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.4620137246615, "num_env_steps_trained_throughput_per_sec": 715.4620137246615, "timesteps_total": 13727280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13727280, "timers": {"training_iteration_time_ms": 61284.549, "sample_time_ms": 60164.756, "load_time_ms": 17.092, "load_throughput": 2569596.117, "learn_time_ms": 1101.627, "learn_throughput": 39868.302, "synch_weights_time_ms": 0.915}, "counters": {"num_env_steps_sampled": 13727280, "num_env_steps_trained": 13727280, "num_agent_steps_sampled": 13727280, "num_agent_steps_trained": 13727280}, "done": false, "episodes_total": 7765, "training_iteration": 1942, "trial_id": "e8087_00000", "date": "2023-08-06_11-34-28", "timestamp": 1691310868, "time_this_iter_s": 61.38987588882446, "time_total_s": 32973.87851333618, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3493.1070849895477, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 17.95977011494253, "ram_util_percent": 71.09655172413792}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.04330306428517, "policy_loss": -2052774.4680894678, "vf_loss": 4366346.84803207}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 39445.5, "diff_num_grad_updates_vs_sampler_policy": 39444.5}}, "num_env_steps_sampled": 13771200, "num_env_steps_trained": 13771200, "num_agent_steps_sampled": 13771200, "num_agent_steps_trained": 13771200}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154966.03523578268, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21703556580321925, "mean_inference_ms": 0.35757017605240016, "mean_action_processing_ms": 0.08932109794350665, "mean_env_wait_ms": 0.6896900676786991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003485432986555428, "StateBufferConnector_ms": 0.00260205104433257, "ViewRequirementAgentConnector_ms": 0.06666019045073411}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154966.03523578268, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21703556580321925, "mean_inference_ms": 0.35757017605240016, "mean_action_processing_ms": 0.08932109794350665, "mean_env_wait_ms": 0.6896900676786991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003485432986555428, "StateBufferConnector_ms": 0.00260205104433257, "ViewRequirementAgentConnector_ms": 0.06666019045073411}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13771200, "num_agent_steps_trained": 13771200, "num_env_steps_sampled": 13771200, "num_env_steps_trained": 13771200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.0644818296249, "num_env_steps_trained_throughput_per_sec": 717.0644818296249, "timesteps_total": 13771200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13771200, "timers": {"training_iteration_time_ms": 61314.242, "sample_time_ms": 60187.933, "load_time_ms": 16.904, "load_throughput": 2598198.487, "learn_time_ms": 1108.333, "learn_throughput": 39627.071, "synch_weights_time_ms": 0.913}, "counters": {"num_env_steps_sampled": 13771200, "num_env_steps_trained": 13771200, "num_agent_steps_sampled": 13771200, "num_agent_steps_trained": 13771200}, "done": false, "episodes_total": 7766, "training_iteration": 1943, "trial_id": "e8087_00000", "date": "2023-08-06_11-35-29", "timestamp": 1691310929, "time_this_iter_s": 61.25254678726196, "time_total_s": 33035.13106012344, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3554.3596317768097, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 17.38372093023256, "ram_util_percent": 71.09651162790696}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.92772681233487, "policy_loss": -1994507.2483486698, "vf_loss": 4248315.311953353}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40131.5, "diff_num_grad_updates_vs_sampler_policy": 40130.5}}, "num_env_steps_sampled": 13815120, "num_env_steps_trained": 13815120, "num_agent_steps_sampled": 13815120, "num_agent_steps_trained": 13815120}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154916.2272386341, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2170420585716345, "mean_inference_ms": 0.3575675365642968, "mean_action_processing_ms": 0.08932214489931223, "mean_env_wait_ms": 0.6896232721794922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003480103056309587, "StateBufferConnector_ms": 0.002601187107926708, "ViewRequirementAgentConnector_ms": 0.06664930763891187}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154916.2272386341, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2170420585716345, "mean_inference_ms": 0.3575675365642968, "mean_action_processing_ms": 0.08932214489931223, "mean_env_wait_ms": 0.6896232721794922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003480103056309587, "StateBufferConnector_ms": 0.002601187107926708, "ViewRequirementAgentConnector_ms": 0.06664930763891187}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13815120, "num_agent_steps_trained": 13815120, "num_env_steps_sampled": 13815120, "num_env_steps_trained": 13815120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 708.7180575381221, "num_env_steps_trained_throughput_per_sec": 708.7180575381221, "timesteps_total": 13815120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13815120, "timers": {"training_iteration_time_ms": 61391.084, "sample_time_ms": 60263.9, "load_time_ms": 16.978, "load_throughput": 2586862.361, "learn_time_ms": 1109.133, "learn_throughput": 39598.511, "synch_weights_time_ms": 0.916}, "counters": {"num_env_steps_sampled": 13815120, "num_env_steps_trained": 13815120, "num_agent_steps_sampled": 13815120, "num_agent_steps_trained": 13815120}, "done": false, "episodes_total": 7767, "training_iteration": 1944, "trial_id": "e8087_00000", "date": "2023-08-06_11-36-31", "timestamp": 1691310991, "time_this_iter_s": 61.97384309768677, "time_total_s": 33097.10490322113, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3616.3334748744965, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 16.801136363636363, "ram_util_percent": 71.11363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.2825273786272, "policy_loss": -1972438.6316394862, "vf_loss": 4565938.41909621}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40817.5, "diff_num_grad_updates_vs_sampler_policy": 40816.5}}, "num_env_steps_sampled": 13859040, "num_env_steps_trained": 13859040, "num_agent_steps_sampled": 13859040, "num_agent_steps_trained": 13859040}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154943.5097053762, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21704833758555384, "mean_inference_ms": 0.35756517611926414, "mean_action_processing_ms": 0.08932312256772963, "mean_env_wait_ms": 0.6895553548122735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00347137451171875, "StateBufferConnector_ms": 0.0026007493336995444, "ViewRequirementAgentConnector_ms": 0.0666356086730957}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154943.5097053762, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21704833758555384, "mean_inference_ms": 0.35756517611926414, "mean_action_processing_ms": 0.08932312256772963, "mean_env_wait_ms": 0.6895553548122735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00347137451171875, "StateBufferConnector_ms": 0.0026007493336995444, "ViewRequirementAgentConnector_ms": 0.0666356086730957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13859040, "num_agent_steps_trained": 13859040, "num_env_steps_sampled": 13859040, "num_env_steps_trained": 13859040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 722.4583019417331, "num_env_steps_trained_throughput_per_sec": 722.4583019417331, "timesteps_total": 13859040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13859040, "timers": {"training_iteration_time_ms": 61329.844, "sample_time_ms": 60200.791, "load_time_ms": 17.14, "load_throughput": 2562415.329, "learn_time_ms": 1110.831, "learn_throughput": 39537.966, "synch_weights_time_ms": 0.925}, "counters": {"num_env_steps_sampled": 13859040, "num_env_steps_trained": 13859040, "num_agent_steps_sampled": 13859040, "num_agent_steps_trained": 13859040}, "done": false, "episodes_total": 7768, "training_iteration": 1945, "trial_id": "e8087_00000", "date": "2023-08-06_11-37-32", "timestamp": 1691311052, "time_this_iter_s": 60.79519724845886, "time_total_s": 33157.90010046959, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3677.1286721229553, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 17.204651162790697, "ram_util_percent": 71.12325581395349}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9518754252887, "policy_loss": -1865935.9719216928, "vf_loss": 4267172.334456997}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 41503.5, "diff_num_grad_updates_vs_sampler_policy": 41502.5}}, "num_env_steps_sampled": 13902960, "num_env_steps_trained": 13902960, "num_agent_steps_sampled": 13902960, "num_agent_steps_trained": 13902960}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154905.82580345293, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21705454346860592, "mean_inference_ms": 0.35756276216631905, "mean_action_processing_ms": 0.08932421128890909, "mean_env_wait_ms": 0.6894917726979882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003463322999047451, "StateBufferConnector_ms": 0.002597589961818007, "ViewRequirementAgentConnector_ms": 0.06661180590019851}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154905.82580345293, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21705454346860592, "mean_inference_ms": 0.35756276216631905, "mean_action_processing_ms": 0.08932421128890909, "mean_env_wait_ms": 0.6894917726979882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003463322999047451, "StateBufferConnector_ms": 0.002597589961818007, "ViewRequirementAgentConnector_ms": 0.06661180590019851}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13902960, "num_agent_steps_trained": 13902960, "num_env_steps_sampled": 13902960, "num_env_steps_trained": 13902960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.4339762809553, "num_env_steps_trained_throughput_per_sec": 712.4339762809553, "timesteps_total": 13902960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13902960, "timers": {"training_iteration_time_ms": 61392.429, "sample_time_ms": 60263.603, "load_time_ms": 17.088, "load_throughput": 2570202.011, "learn_time_ms": 1110.657, "learn_throughput": 39544.174, "synch_weights_time_ms": 0.924}, "counters": {"num_env_steps_sampled": 13902960, "num_env_steps_trained": 13902960, "num_agent_steps_sampled": 13902960, "num_agent_steps_trained": 13902960}, "done": false, "episodes_total": 7769, "training_iteration": 1946, "trial_id": "e8087_00000", "date": "2023-08-06_11-38-34", "timestamp": 1691311114, "time_this_iter_s": 61.650696992874146, "time_total_s": 33219.55079746246, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3738.7793691158295, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 17.281609195402297, "ram_util_percent": 71.13448275862069}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.11095581944414, "policy_loss": -2069713.0896956997, "vf_loss": 4403403.301475948}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 42189.5, "diff_num_grad_updates_vs_sampler_policy": 42188.5}}, "num_env_steps_sampled": 13946880, "num_env_steps_trained": 13946880, "num_agent_steps_sampled": 13946880, "num_agent_steps_trained": 13946880}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154894.97035647102, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21706016615563464, "mean_inference_ms": 0.3575608933304006, "mean_action_processing_ms": 0.08932522603400612, "mean_env_wait_ms": 0.6894306792597489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035082140276508945, "StateBufferConnector_ms": 0.0025922252285865044, "ViewRequirementAgentConnector_ms": 0.0665918473274477}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154894.97035647102, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21706016615563464, "mean_inference_ms": 0.3575608933304006, "mean_action_processing_ms": 0.08932522603400612, "mean_env_wait_ms": 0.6894306792597489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035082140276508945, "StateBufferConnector_ms": 0.0025922252285865044, "ViewRequirementAgentConnector_ms": 0.0665918473274477}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13946880, "num_agent_steps_trained": 13946880, "num_env_steps_sampled": 13946880, "num_env_steps_trained": 13946880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.8452235934383, "num_env_steps_trained_throughput_per_sec": 715.8452235934383, "timesteps_total": 13946880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13946880, "timers": {"training_iteration_time_ms": 61429.704, "sample_time_ms": 60301.914, "load_time_ms": 17.145, "load_throughput": 2561741.849, "learn_time_ms": 1109.573, "learn_throughput": 39582.779, "synch_weights_time_ms": 0.915}, "counters": {"num_env_steps_sampled": 13946880, "num_env_steps_trained": 13946880, "num_agent_steps_sampled": 13946880, "num_agent_steps_trained": 13946880}, "done": false, "episodes_total": 7770, "training_iteration": 1947, "trial_id": "e8087_00000", "date": "2023-08-06_11-39-35", "timestamp": 1691311175, "time_this_iter_s": 61.35699009895325, "time_total_s": 33280.90778756142, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3800.1363592147827, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 18.373563218390803, "ram_util_percent": 71.17011494252874}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0663164767162, "policy_loss": -1800081.2286010387, "vf_loss": 4408072.065779883}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 42875.5, "diff_num_grad_updates_vs_sampler_policy": 42874.5}}, "num_env_steps_sampled": 13990800, "num_env_steps_trained": 13990800, "num_agent_steps_sampled": 13990800, "num_agent_steps_trained": 13990800}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154888.36483844114, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21706550536371255, "mean_inference_ms": 0.35755952673063207, "mean_action_processing_ms": 0.08932628803089923, "mean_env_wait_ms": 0.6893689092023982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003506645323738219, "StateBufferConnector_ms": 0.002590058341858879, "ViewRequirementAgentConnector_ms": 0.0665933366805788}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154888.36483844114, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21706550536371255, "mean_inference_ms": 0.35755952673063207, "mean_action_processing_ms": 0.08932628803089923, "mean_env_wait_ms": 0.6893689092023982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003506645323738219, "StateBufferConnector_ms": 0.002590058341858879, "ViewRequirementAgentConnector_ms": 0.0665933366805788}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13990800, "num_agent_steps_trained": 13990800, "num_env_steps_sampled": 13990800, "num_env_steps_trained": 13990800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 721.1088985977881, "num_env_steps_trained_throughput_per_sec": 721.1088985977881, "timesteps_total": 13990800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13990800, "timers": {"training_iteration_time_ms": 61347.332, "sample_time_ms": 60219.945, "load_time_ms": 16.988, "load_throughput": 2585283.12, "learn_time_ms": 1109.336, "learn_throughput": 39591.239, "synch_weights_time_ms": 0.904}, "counters": {"num_env_steps_sampled": 13990800, "num_env_steps_trained": 13990800, "num_agent_steps_sampled": 13990800, "num_agent_steps_trained": 13990800}, "done": false, "episodes_total": 7771, "training_iteration": 1948, "trial_id": "e8087_00000", "date": "2023-08-06_11-40-36", "timestamp": 1691311236, "time_this_iter_s": 60.908965826034546, "time_total_s": 33341.81675338745, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3861.0453250408173, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 17.81279069767442, "ram_util_percent": 70.75000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9903541320267, "policy_loss": -2241234.9842127142, "vf_loss": 4472778.74398688}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 43561.5, "diff_num_grad_updates_vs_sampler_policy": 43560.5}}, "num_env_steps_sampled": 14034720, "num_env_steps_trained": 14034720, "num_agent_steps_sampled": 14034720, "num_agent_steps_trained": 14034720}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154904.0072501896, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2170706188963836, "mean_inference_ms": 0.35755861404759837, "mean_action_processing_ms": 0.08932736826226995, "mean_env_wait_ms": 0.6893094479713908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035025179386138916, "StateBufferConnector_ms": 0.002590566873550415, "ViewRequirementAgentConnector_ms": 0.06656758487224579}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154904.0072501896, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2170706188963836, "mean_inference_ms": 0.35755861404759837, "mean_action_processing_ms": 0.08932736826226995, "mean_env_wait_ms": 0.6893094479713908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035025179386138916, "StateBufferConnector_ms": 0.002590566873550415, "ViewRequirementAgentConnector_ms": 0.06656758487224579}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14034720, "num_agent_steps_trained": 14034720, "num_env_steps_sampled": 14034720, "num_env_steps_trained": 14034720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.2536952397488, "num_env_steps_trained_throughput_per_sec": 715.2536952397488, "timesteps_total": 14034720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14034720, "timers": {"training_iteration_time_ms": 61359.552, "sample_time_ms": 60234.354, "load_time_ms": 17.003, "load_throughput": 2583079.041, "learn_time_ms": 1107.136, "learn_throughput": 39669.922, "synch_weights_time_ms": 0.902}, "counters": {"num_env_steps_sampled": 14034720, "num_env_steps_trained": 14034720, "num_agent_steps_sampled": 14034720, "num_agent_steps_trained": 14034720}, "done": false, "episodes_total": 7772, "training_iteration": 1949, "trial_id": "e8087_00000", "date": "2023-08-06_11-41-37", "timestamp": 1691311297, "time_this_iter_s": 61.40753507614136, "time_total_s": 33403.22428846359, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3922.4528601169586, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 17.264367816091955, "ram_util_percent": 71.09540229885057}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.97432751002185, "policy_loss": -2128192.126765215, "vf_loss": 4315482.243258017}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 44247.5, "diff_num_grad_updates_vs_sampler_policy": 44246.5}}, "num_env_steps_sampled": 14078640, "num_env_steps_trained": 14078640, "num_agent_steps_sampled": 14078640, "num_agent_steps_trained": 14078640}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154883.618724023, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21707470832588205, "mean_inference_ms": 0.35755805733296814, "mean_action_processing_ms": 0.08932842751654986, "mean_env_wait_ms": 0.6892518446102934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034992511455829325, "StateBufferConnector_ms": 0.002593994140625, "ViewRequirementAgentConnector_ms": 0.0665741700392503}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154883.618724023, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21707470832588205, "mean_inference_ms": 0.35755805733296814, "mean_action_processing_ms": 0.08932842751654986, "mean_env_wait_ms": 0.6892518446102934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034992511455829325, "StateBufferConnector_ms": 0.002593994140625, "ViewRequirementAgentConnector_ms": 0.0665741700392503}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14078640, "num_agent_steps_trained": 14078640, "num_env_steps_sampled": 14078640, "num_env_steps_trained": 14078640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.7244979343768, "num_env_steps_trained_throughput_per_sec": 717.7244979343768, "timesteps_total": 14078640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14078640, "timers": {"training_iteration_time_ms": 61356.113, "sample_time_ms": 60231.77, "load_time_ms": 17.024, "load_throughput": 2579834.153, "learn_time_ms": 1106.242, "learn_throughput": 39701.966, "synch_weights_time_ms": 0.917}, "counters": {"num_env_steps_sampled": 14078640, "num_env_steps_trained": 14078640, "num_agent_steps_sampled": 14078640, "num_agent_steps_trained": 14078640}, "done": false, "episodes_total": 7773, "training_iteration": 1950, "trial_id": "e8087_00000", "date": "2023-08-06_11-42-38", "timestamp": 1691311358, "time_this_iter_s": 61.19609308242798, "time_total_s": 33464.42038154602, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3983.6489531993866, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 17.491954022988505, "ram_util_percent": 71.15287356321842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.83904744584777, "policy_loss": -2070113.4509640352, "vf_loss": 4401911.8205174925}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 44933.5, "diff_num_grad_updates_vs_sampler_policy": 44932.5}}, "num_env_steps_sampled": 14122560, "num_env_steps_trained": 14122560, "num_agent_steps_sampled": 14122560, "num_agent_steps_trained": 14122560}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154877.92368375088, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21707879921045853, "mean_inference_ms": 0.35755777204057987, "mean_action_processing_ms": 0.08932946554014445, "mean_env_wait_ms": 0.6891948670501261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034931934241092567, "StateBufferConnector_ms": 0.002591176466508345, "ViewRequirementAgentConnector_ms": 0.06655996496027167}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154877.92368375088, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21707879921045853, "mean_inference_ms": 0.35755777204057987, "mean_action_processing_ms": 0.08932946554014445, "mean_env_wait_ms": 0.6891948670501261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034931934241092567, "StateBufferConnector_ms": 0.002591176466508345, "ViewRequirementAgentConnector_ms": 0.06655996496027167}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14122560, "num_agent_steps_trained": 14122560, "num_env_steps_sampled": 14122560, "num_env_steps_trained": 14122560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.1698597829513, "num_env_steps_trained_throughput_per_sec": 718.1698597829513, "timesteps_total": 14122560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14122560, "timers": {"training_iteration_time_ms": 61306.16, "sample_time_ms": 60181.033, "load_time_ms": 16.929, "load_throughput": 2594327.155, "learn_time_ms": 1107.122, "learn_throughput": 39670.428, "synch_weights_time_ms": 0.917}, "counters": {"num_env_steps_sampled": 14122560, "num_env_steps_trained": 14122560, "num_agent_steps_sampled": 14122560, "num_agent_steps_trained": 14122560}, "done": false, "episodes_total": 7774, "training_iteration": 1951, "trial_id": "e8087_00000", "date": "2023-08-06_11-43-40", "timestamp": 1691311420, "time_this_iter_s": 61.15828895568848, "time_total_s": 33525.57867050171, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4044.807242155075, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 16.94712643678161, "ram_util_percent": 71.1574712643678}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.375000000000002e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.11571687303547, "policy_loss": -1924795.3844068877, "vf_loss": 4503808.194424198}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 45619.5, "diff_num_grad_updates_vs_sampler_policy": 45618.5}}, "num_env_steps_sampled": 14166480, "num_env_steps_trained": 14166480, "num_agent_steps_sampled": 14166480, "num_agent_steps_trained": 14166480}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154893.25110924972, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21708213488279257, "mean_inference_ms": 0.35755760636222866, "mean_action_processing_ms": 0.08933049383072639, "mean_env_wait_ms": 0.6891372307838901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035328651542094218, "StateBufferConnector_ms": 0.0025920013883220616, "ViewRequirementAgentConnector_ms": 0.06654974239975658}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154893.25110924972, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21708213488279257, "mean_inference_ms": 0.35755760636222866, "mean_action_processing_ms": 0.08933049383072639, "mean_env_wait_ms": 0.6891372307838901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035328651542094218, "StateBufferConnector_ms": 0.0025920013883220616, "ViewRequirementAgentConnector_ms": 0.06654974239975658}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14166480, "num_agent_steps_trained": 14166480, "num_env_steps_sampled": 14166480, "num_env_steps_trained": 14166480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 723.4064854302442, "num_env_steps_trained_throughput_per_sec": 723.4064854302442, "timesteps_total": 14166480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14166480, "timers": {"training_iteration_time_ms": 61238.745, "sample_time_ms": 60112.651, "load_time_ms": 16.927, "load_throughput": 2594743.738, "learn_time_ms": 1108.086, "learn_throughput": 39635.899, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 14166480, "num_env_steps_trained": 14166480, "num_agent_steps_sampled": 14166480, "num_agent_steps_trained": 14166480}, "done": false, "episodes_total": 7775, "training_iteration": 1952, "trial_id": "e8087_00000", "date": "2023-08-06_11-44-40", "timestamp": 1691311480, "time_this_iter_s": 60.71556806564331, "time_total_s": 33586.29423856735, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4105.522810220718, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 17.78470588235294, "ram_util_percent": 71.12352941176472}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.750000000000001e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.95205501634246, "policy_loss": -2106391.6673196065, "vf_loss": 4413482.684675656}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 46304.5}}, "num_env_steps_sampled": 14210400, "num_env_steps_trained": 14210400, "num_agent_steps_sampled": 14210400, "num_agent_steps_trained": 14210400}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154880.79897732017, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21708515805494058, "mean_inference_ms": 0.3575575608373999, "mean_action_processing_ms": 0.08933154943567656, "mean_env_wait_ms": 0.6890803974383898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003527192508473116, "StateBufferConnector_ms": 0.0025892958921544694, "ViewRequirementAgentConnector_ms": 0.06653491188498105}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154880.79897732017, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21708515805494058, "mean_inference_ms": 0.3575575608373999, "mean_action_processing_ms": 0.08933154943567656, "mean_env_wait_ms": 0.6890803974383898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003527192508473116, "StateBufferConnector_ms": 0.0025892958921544694, "ViewRequirementAgentConnector_ms": 0.06653491188498105}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14210400, "num_agent_steps_trained": 14210400, "num_env_steps_sampled": 14210400, "num_env_steps_trained": 14210400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.0866975777569, "num_env_steps_trained_throughput_per_sec": 718.0866975777569, "timesteps_total": 14210400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14210400, "timers": {"training_iteration_time_ms": 61230.025, "sample_time_ms": 60102.949, "load_time_ms": 16.975, "load_throughput": 2587287.452, "learn_time_ms": 1109.016, "learn_throughput": 39602.668, "synch_weights_time_ms": 0.927}, "counters": {"num_env_steps_sampled": 14210400, "num_env_steps_trained": 14210400, "num_agent_steps_sampled": 14210400, "num_agent_steps_trained": 14210400}, "done": false, "episodes_total": 7776, "training_iteration": 1953, "trial_id": "e8087_00000", "date": "2023-08-06_11-45-42", "timestamp": 1691311542, "time_this_iter_s": 61.165435791015625, "time_total_s": 33647.45967435837, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4166.688246011734, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 17.335632183908046, "ram_util_percent": 71.12873563218392}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.125000000000004e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0626992539831, "policy_loss": -2303535.684815165, "vf_loss": 4426372.046100583}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 46991.5, "diff_num_grad_updates_vs_sampler_policy": 46990.5}}, "num_env_steps_sampled": 14254320, "num_env_steps_trained": 14254320, "num_agent_steps_sampled": 14254320, "num_agent_steps_trained": 14254320}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154881.93865466834, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21708817513460374, "mean_inference_ms": 0.3575580355290335, "mean_action_processing_ms": 0.08933265347533276, "mean_env_wait_ms": 0.689024240461875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035234119581139607, "StateBufferConnector_ms": 0.002590815226236979, "ViewRequirementAgentConnector_ms": 0.06653053173120471}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154881.93865466834, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21708817513460374, "mean_inference_ms": 0.3575580355290335, "mean_action_processing_ms": 0.08933265347533276, "mean_env_wait_ms": 0.689024240461875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035234119581139607, "StateBufferConnector_ms": 0.002590815226236979, "ViewRequirementAgentConnector_ms": 0.06653053173120471}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14254320, "num_agent_steps_trained": 14254320, "num_env_steps_sampled": 14254320, "num_env_steps_trained": 14254320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.4249146087967, "num_env_steps_trained_throughput_per_sec": 717.4249146087967, "timesteps_total": 14254320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14254320, "timers": {"training_iteration_time_ms": 61154.816, "sample_time_ms": 60027.298, "load_time_ms": 16.912, "load_throughput": 2596953.133, "learn_time_ms": 1109.521, "learn_throughput": 39584.65, "synch_weights_time_ms": 0.925}, "counters": {"num_env_steps_sampled": 14254320, "num_env_steps_trained": 14254320, "num_agent_steps_sampled": 14254320, "num_agent_steps_trained": 14254320}, "done": false, "episodes_total": 7777, "training_iteration": 1954, "trial_id": "e8087_00000", "date": "2023-08-06_11-46-43", "timestamp": 1691311603, "time_this_iter_s": 61.22174620628357, "time_total_s": 33708.68142056465, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4227.909992218018, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 17.497701149425286, "ram_util_percent": 71.12988505747124}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.5e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0967461944669, "policy_loss": -2087754.5350110468, "vf_loss": 4454326.916180758}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 47677.5, "diff_num_grad_updates_vs_sampler_policy": 47676.5}}, "num_env_steps_sampled": 14298240, "num_env_steps_trained": 14298240, "num_agent_steps_sampled": 14298240, "num_agent_steps_trained": 14298240}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154882.33196221635, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21709111807857098, "mean_inference_ms": 0.3575585661712794, "mean_action_processing_ms": 0.0893337724119242, "mean_env_wait_ms": 0.6889692165077961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003517355237688337, "StateBufferConnector_ms": 0.0025916099548339844, "ViewRequirementAgentConnector_ms": 0.06651708057948522}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154882.33196221635, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21709111807857098, "mean_inference_ms": 0.3575585661712794, "mean_action_processing_ms": 0.0893337724119242, "mean_env_wait_ms": 0.6889692165077961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003517355237688337, "StateBufferConnector_ms": 0.0025916099548339844, "ViewRequirementAgentConnector_ms": 0.06651708057948522}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14298240, "num_agent_steps_trained": 14298240, "num_env_steps_sampled": 14298240, "num_env_steps_trained": 14298240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.4508385324848, "num_env_steps_trained_throughput_per_sec": 717.4508385324848, "timesteps_total": 14298240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14298240, "timers": {"training_iteration_time_ms": 61197.246, "sample_time_ms": 60068.228, "load_time_ms": 16.751, "load_throughput": 2621969.827, "learn_time_ms": 1111.18, "learn_throughput": 39525.564, "synch_weights_time_ms": 0.929}, "counters": {"num_env_steps_sampled": 14298240, "num_env_steps_trained": 14298240, "num_agent_steps_sampled": 14298240, "num_agent_steps_trained": 14298240}, "done": false, "episodes_total": 7778, "training_iteration": 1955, "trial_id": "e8087_00000", "date": "2023-08-06_11-47-44", "timestamp": 1691311664, "time_this_iter_s": 61.219696044921875, "time_total_s": 33769.90111660957, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4289.129688262939, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 16.990697674418605, "ram_util_percent": 71.17558139534883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.875e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.00969426903015, "policy_loss": -1998918.8017236472, "vf_loss": 4493008.14941691}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 48363.5, "diff_num_grad_updates_vs_sampler_policy": 48362.5}}, "num_env_steps_sampled": 14342160, "num_env_steps_trained": 14342160, "num_agent_steps_sampled": 14342160, "num_agent_steps_trained": 14342160}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154887.82711846582, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21709397289698473, "mean_inference_ms": 0.35755911590619227, "mean_action_processing_ms": 0.08933486649491834, "mean_env_wait_ms": 0.6889144880116146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003508446921764965, "StateBufferConnector_ms": 0.002592718097525583, "ViewRequirementAgentConnector_ms": 0.06651475395954831}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154887.82711846582, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21709397289698473, "mean_inference_ms": 0.35755911590619227, "mean_action_processing_ms": 0.08933486649491834, "mean_env_wait_ms": 0.6889144880116146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003508446921764965, "StateBufferConnector_ms": 0.002592718097525583, "ViewRequirementAgentConnector_ms": 0.06651475395954831}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14342160, "num_agent_steps_trained": 14342160, "num_env_steps_sampled": 14342160, "num_env_steps_trained": 14342160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.8443480442123, "num_env_steps_trained_throughput_per_sec": 719.8443480442123, "timesteps_total": 14342160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14342160, "timers": {"training_iteration_time_ms": 61133.783, "sample_time_ms": 60003.129, "load_time_ms": 16.743, "load_throughput": 2623142.176, "learn_time_ms": 1112.825, "learn_throughput": 39467.122, "synch_weights_time_ms": 0.927}, "counters": {"num_env_steps_sampled": 14342160, "num_env_steps_trained": 14342160, "num_agent_steps_sampled": 14342160, "num_agent_steps_trained": 14342160}, "done": false, "episodes_total": 7779, "training_iteration": 1956, "trial_id": "e8087_00000", "date": "2023-08-06_11-48-45", "timestamp": 1691311725, "time_this_iter_s": 61.0159170627594, "time_total_s": 33830.91703367233, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4350.145605325699, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 17.113793103448277, "ram_util_percent": 71.16206896551725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.250000000000002e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.11559386851144, "policy_loss": -1842790.455545053, "vf_loss": 4453571.02095481}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 49049.5, "diff_num_grad_updates_vs_sampler_policy": 49048.5}}, "num_env_steps_sampled": 14386080, "num_env_steps_trained": 14386080, "num_agent_steps_sampled": 14386080, "num_agent_steps_trained": 14386080}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154891.78401382713, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21709640508875305, "mean_inference_ms": 0.3575597545026882, "mean_action_processing_ms": 0.08933596886958348, "mean_env_wait_ms": 0.6888601388703172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003504090838962131, "StateBufferConnector_ms": 0.0025964445537990993, "ViewRequirementAgentConnector_ms": 0.06649990876515706}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154891.78401382713, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21709640508875305, "mean_inference_ms": 0.3575597545026882, "mean_action_processing_ms": 0.08933596886958348, "mean_env_wait_ms": 0.6888601388703172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003504090838962131, "StateBufferConnector_ms": 0.0025964445537990993, "ViewRequirementAgentConnector_ms": 0.06649990876515706}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14386080, "num_agent_steps_trained": 14386080, "num_env_steps_sampled": 14386080, "num_env_steps_trained": 14386080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 720.2261068052965, "num_env_steps_trained_throughput_per_sec": 720.2261068052965, "timesteps_total": 14386080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14386080, "timers": {"training_iteration_time_ms": 61096.463, "sample_time_ms": 59962.762, "load_time_ms": 16.745, "load_throughput": 2622862.061, "learn_time_ms": 1115.872, "learn_throughput": 39359.342, "synch_weights_time_ms": 0.924}, "counters": {"num_env_steps_sampled": 14386080, "num_env_steps_trained": 14386080, "num_agent_steps_sampled": 14386080, "num_agent_steps_trained": 14386080}, "done": false, "episodes_total": 7780, "training_iteration": 1957, "trial_id": "e8087_00000", "date": "2023-08-06_11-49-46", "timestamp": 1691311786, "time_this_iter_s": 60.983680963516235, "time_total_s": 33891.90071463585, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4411.129286289215, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 17.46395348837209, "ram_util_percent": 71.07093023255814}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.624999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1951465217435, "policy_loss": -2171371.7906156047, "vf_loss": 4624208.098852041}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 49735.5, "diff_num_grad_updates_vs_sampler_policy": 49734.5}}, "num_env_steps_sampled": 14430000, "num_env_steps_trained": 14430000, "num_agent_steps_sampled": 14430000, "num_agent_steps_trained": 14430000}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154919.54902156297, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21709876246146723, "mean_inference_ms": 0.3575603613789878, "mean_action_processing_ms": 0.08933708162047552, "mean_env_wait_ms": 0.6888052778361777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003500833903273491, "StateBufferConnector_ms": 0.0025912506939613656, "ViewRequirementAgentConnector_ms": 0.06651061854950369}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154919.54902156297, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21709876246146723, "mean_inference_ms": 0.3575603613789878, "mean_action_processing_ms": 0.08933708162047552, "mean_env_wait_ms": 0.6888052778361777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003500833903273491, "StateBufferConnector_ms": 0.0025912506939613656, "ViewRequirementAgentConnector_ms": 0.06651061854950369}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14430000, "num_agent_steps_trained": 14430000, "num_env_steps_sampled": 14430000, "num_env_steps_trained": 14430000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 722.2421691332711, "num_env_steps_trained_throughput_per_sec": 722.2421691332711, "timesteps_total": 14430000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14430000, "timers": {"training_iteration_time_ms": 61086.906, "sample_time_ms": 59952.549, "load_time_ms": 16.711, "load_throughput": 2628153.25, "learn_time_ms": 1116.563, "learn_throughput": 39335.006, "synch_weights_time_ms": 0.924}, "counters": {"num_env_steps_sampled": 14430000, "num_env_steps_trained": 14430000, "num_agent_steps_sampled": 14430000, "num_agent_steps_trained": 14430000}, "done": false, "episodes_total": 7781, "training_iteration": 1958, "trial_id": "e8087_00000", "date": "2023-08-06_11-50-47", "timestamp": 1691311847, "time_this_iter_s": 60.81353187561035, "time_total_s": 33952.71424651146, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4471.942818164825, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 17.18372093023256, "ram_util_percent": 71.06046511627906}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.034155220054, "policy_loss": -2386087.143714126, "vf_loss": 4474891.86898688}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 50421.5, "diff_num_grad_updates_vs_sampler_policy": 50420.5}}, "num_env_steps_sampled": 14473920, "num_env_steps_trained": 14473920, "num_agent_steps_sampled": 14473920, "num_agent_steps_trained": 14473920}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154930.5455258145, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21710099530025628, "mean_inference_ms": 0.35756088812174336, "mean_action_processing_ms": 0.08933817420728028, "mean_env_wait_ms": 0.6887525586698808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034954096819903397, "StateBufferConnector_ms": 0.0025897412686734585, "ViewRequirementAgentConnector_ms": 0.06650074108226879}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154930.5455258145, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21710099530025628, "mean_inference_ms": 0.35756088812174336, "mean_action_processing_ms": 0.08933817420728028, "mean_env_wait_ms": 0.6887525586698808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034954096819903397, "StateBufferConnector_ms": 0.0025897412686734585, "ViewRequirementAgentConnector_ms": 0.06650074108226879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14473920, "num_agent_steps_trained": 14473920, "num_env_steps_sampled": 14473920, "num_env_steps_trained": 14473920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.5305611677092, "num_env_steps_trained_throughput_per_sec": 715.5305611677092, "timesteps_total": 14473920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14473920, "timers": {"training_iteration_time_ms": 61084.53, "sample_time_ms": 59948.46, "load_time_ms": 16.559, "load_throughput": 2652390.596, "learn_time_ms": 1118.424, "learn_throughput": 39269.527, "synch_weights_time_ms": 0.927}, "counters": {"num_env_steps_sampled": 14473920, "num_env_steps_trained": 14473920, "num_agent_steps_sampled": 14473920, "num_agent_steps_trained": 14473920}, "done": false, "episodes_total": 7782, "training_iteration": 1959, "trial_id": "e8087_00000", "date": "2023-08-06_11-51-48", "timestamp": 1691311908, "time_this_iter_s": 61.383750200271606, "time_total_s": 34014.09799671173, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4533.326568365097, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 17.40804597701149, "ram_util_percent": 71.0632183908046}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9574317153619, "policy_loss": -2081025.212534735, "vf_loss": 4232190.6864067055}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 51107.5, "diff_num_grad_updates_vs_sampler_policy": 51106.5}}, "num_env_steps_sampled": 14517840, "num_env_steps_trained": 14517840, "num_agent_steps_sampled": 14517840, "num_agent_steps_trained": 14517840}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154894.32746589943, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2171035710423396, "mean_inference_ms": 0.3575613654671467, "mean_action_processing_ms": 0.08933929172885234, "mean_env_wait_ms": 0.6887025161431339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034917195638020835, "StateBufferConnector_ms": 0.002587000528971354, "ViewRequirementAgentConnector_ms": 0.06649208068847656}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154894.32746589943, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2171035710423396, "mean_inference_ms": 0.3575613654671467, "mean_action_processing_ms": 0.08933929172885234, "mean_env_wait_ms": 0.6887025161431339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034917195638020835, "StateBufferConnector_ms": 0.002587000528971354, "ViewRequirementAgentConnector_ms": 0.06649208068847656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14517840, "num_agent_steps_trained": 14517840, "num_env_steps_sampled": 14517840, "num_env_steps_trained": 14517840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.004710473545, "num_env_steps_trained_throughput_per_sec": 712.004710473545, "timesteps_total": 14517840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14517840, "timers": {"training_iteration_time_ms": 61133.689, "sample_time_ms": 59995.905, "load_time_ms": 16.493, "load_throughput": 2662953.918, "learn_time_ms": 1120.219, "learn_throughput": 39206.631, "synch_weights_time_ms": 0.914}, "counters": {"num_env_steps_sampled": 14517840, "num_env_steps_trained": 14517840, "num_agent_steps_sampled": 14517840, "num_agent_steps_trained": 14517840}, "done": false, "episodes_total": 7783, "training_iteration": 1960, "trial_id": "e8087_00000", "date": "2023-08-06_11-52-50", "timestamp": 1691311970, "time_this_iter_s": 61.68818998336792, "time_total_s": 34075.7861866951, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4595.014758348465, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 17.16896551724138, "ram_util_percent": 70.99195402298852}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.7297836615115, "policy_loss": -1985708.7379225127, "vf_loss": 4157184.4393221573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 51793.5, "diff_num_grad_updates_vs_sampler_policy": 51792.5}}, "num_env_steps_sampled": 14561760, "num_env_steps_trained": 14561760, "num_agent_steps_sampled": 14561760, "num_agent_steps_trained": 14561760}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154845.3871036241, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21710643935441568, "mean_inference_ms": 0.35756203001007775, "mean_action_processing_ms": 0.08934039483970924, "mean_env_wait_ms": 0.6886532626788896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034900088059274773, "StateBufferConnector_ms": 0.0025830770793714023, "ViewRequirementAgentConnector_ms": 0.06647423694008275}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154845.3871036241, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21710643935441568, "mean_inference_ms": 0.35756203001007775, "mean_action_processing_ms": 0.08934039483970924, "mean_env_wait_ms": 0.6886532626788896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034900088059274773, "StateBufferConnector_ms": 0.0025830770793714023, "ViewRequirementAgentConnector_ms": 0.06647423694008275}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14561760, "num_agent_steps_trained": 14561760, "num_env_steps_sampled": 14561760, "num_env_steps_trained": 14561760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.5339258745844, "num_env_steps_trained_throughput_per_sec": 716.5339258745844, "timesteps_total": 14561760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14561760, "timers": {"training_iteration_time_ms": 61147.651, "sample_time_ms": 60008.8, "load_time_ms": 16.503, "load_throughput": 2661288.124, "learn_time_ms": 1121.281, "learn_throughput": 39169.475, "synch_weights_time_ms": 0.909}, "counters": {"num_env_steps_sampled": 14561760, "num_env_steps_trained": 14561760, "num_agent_steps_sampled": 14561760, "num_agent_steps_trained": 14561760}, "done": false, "episodes_total": 7784, "training_iteration": 1961, "trial_id": "e8087_00000", "date": "2023-08-06_11-53-51", "timestamp": 1691312031, "time_this_iter_s": 61.29791307449341, "time_total_s": 34137.08409976959, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4656.312671422958, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 18.459770114942526, "ram_util_percent": 71.09655172413792}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.02323299663755, "policy_loss": -2109797.171168914, "vf_loss": 4524305.065142129}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 52479.5, "diff_num_grad_updates_vs_sampler_policy": 52478.5}}, "num_env_steps_sampled": 14605680, "num_env_steps_trained": 14605680, "num_agent_steps_sampled": 14605680, "num_agent_steps_trained": 14605680}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154862.33835017652, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21710920598792421, "mean_inference_ms": 0.3575626142444507, "mean_action_processing_ms": 0.0893414635566639, "mean_env_wait_ms": 0.6886045063213371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034824594274743812, "StateBufferConnector_ms": 0.0025839000553279728, "ViewRequirementAgentConnector_ms": 0.0664478772646421}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154862.33835017652, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21710920598792421, "mean_inference_ms": 0.3575626142444507, "mean_action_processing_ms": 0.0893414635566639, "mean_env_wait_ms": 0.6886045063213371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034824594274743812, "StateBufferConnector_ms": 0.0025839000553279728, "ViewRequirementAgentConnector_ms": 0.0664478772646421}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14605680, "num_agent_steps_trained": 14605680, "num_env_steps_sampled": 14605680, "num_env_steps_trained": 14605680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.5876074161678, "num_env_steps_trained_throughput_per_sec": 719.5876074161678, "timesteps_total": 14605680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14605680, "timers": {"training_iteration_time_ms": 61179.872, "sample_time_ms": 60040.553, "load_time_ms": 16.765, "load_throughput": 2619769.837, "learn_time_ms": 1121.494, "learn_throughput": 39162.043, "synch_weights_time_ms": 0.902}, "counters": {"num_env_steps_sampled": 14605680, "num_env_steps_trained": 14605680, "num_agent_steps_sampled": 14605680, "num_agent_steps_trained": 14605680}, "done": false, "episodes_total": 7785, "training_iteration": 1962, "trial_id": "e8087_00000", "date": "2023-08-06_11-54-52", "timestamp": 1691312092, "time_this_iter_s": 61.03805685043335, "time_total_s": 34198.122156620026, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4717.350728273392, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 17.30697674418605, "ram_util_percent": 70.97093023255813}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.15724391214354, "policy_loss": -2071744.433474171, "vf_loss": 4649985.1539723035}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53165.5, "diff_num_grad_updates_vs_sampler_policy": 53164.5}}, "num_env_steps_sampled": 14649600, "num_env_steps_trained": 14649600, "num_agent_steps_sampled": 14649600, "num_agent_steps_trained": 14649600}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154900.29917487167, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21711185699242486, "mean_inference_ms": 0.3575635423123964, "mean_action_processing_ms": 0.0893425312602449, "mean_env_wait_ms": 0.6885551511587781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034799942603478064, "StateBufferConnector_ms": 0.002579811291816907, "ViewRequirementAgentConnector_ms": 0.06642952943459535}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154900.29917487167, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21711185699242486, "mean_inference_ms": 0.3575635423123964, "mean_action_processing_ms": 0.0893425312602449, "mean_env_wait_ms": 0.6885551511587781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034799942603478064, "StateBufferConnector_ms": 0.002579811291816907, "ViewRequirementAgentConnector_ms": 0.06642952943459535}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14649600, "num_agent_steps_trained": 14649600, "num_env_steps_sampled": 14649600, "num_env_steps_trained": 14649600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 720.8398369732979, "num_env_steps_trained_throughput_per_sec": 720.8398369732979, "timesteps_total": 14649600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14649600, "timers": {"training_iteration_time_ms": 61156.512, "sample_time_ms": 60017.561, "load_time_ms": 16.731, "load_throughput": 2625063.508, "learn_time_ms": 1121.164, "learn_throughput": 39173.556, "synch_weights_time_ms": 0.898}, "counters": {"num_env_steps_sampled": 14649600, "num_env_steps_trained": 14649600, "num_agent_steps_sampled": 14649600, "num_agent_steps_trained": 14649600}, "done": false, "episodes_total": 7786, "training_iteration": 1963, "trial_id": "e8087_00000", "date": "2023-08-06_11-55-53", "timestamp": 1691312153, "time_this_iter_s": 60.931740045547485, "time_total_s": 34259.05389666557, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4778.282468318939, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 17.637931034482754, "ram_util_percent": 70.95287356321839}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.05828999777924, "policy_loss": -2216336.4339154745, "vf_loss": 4497720.783892129}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53851.5, "diff_num_grad_updates_vs_sampler_policy": 53850.5}}, "num_env_steps_sampled": 14693520, "num_env_steps_trained": 14693520, "num_agent_steps_sampled": 14693520, "num_agent_steps_trained": 14693520}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154911.37149980268, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21711431105257906, "mean_inference_ms": 0.35756470407560303, "mean_action_processing_ms": 0.08934358498672285, "mean_env_wait_ms": 0.6885083276301895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034757807284970825, "StateBufferConnector_ms": 0.002580051180682605, "ViewRequirementAgentConnector_ms": 0.06642854666408105}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154911.37149980268, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21711431105257906, "mean_inference_ms": 0.35756470407560303, "mean_action_processing_ms": 0.08934358498672285, "mean_env_wait_ms": 0.6885083276301895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034757807284970825, "StateBufferConnector_ms": 0.002580051180682605, "ViewRequirementAgentConnector_ms": 0.06642854666408105}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14693520, "num_agent_steps_trained": 14693520, "num_env_steps_sampled": 14693520, "num_env_steps_trained": 14693520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.555618216889, "num_env_steps_trained_throughput_per_sec": 712.555618216889, "timesteps_total": 14693520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14693520, "timers": {"training_iteration_time_ms": 61198.346, "sample_time_ms": 60059.651, "load_time_ms": 16.835, "load_throughput": 2608847.204, "learn_time_ms": 1120.804, "learn_throughput": 39186.143, "synch_weights_time_ms": 0.899}, "counters": {"num_env_steps_sampled": 14693520, "num_env_steps_trained": 14693520, "num_agent_steps_sampled": 14693520, "num_agent_steps_trained": 14693520}, "done": false, "episodes_total": 7787, "training_iteration": 1964, "trial_id": "e8087_00000", "date": "2023-08-06_11-56-55", "timestamp": 1691312215, "time_this_iter_s": 61.640259742736816, "time_total_s": 34320.69415640831, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4839.922728061676, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 17.368965517241374, "ram_util_percent": 70.8287356321839}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0624328257391, "policy_loss": -1943140.6750125273, "vf_loss": 4503489.775419096}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 54537.5, "diff_num_grad_updates_vs_sampler_policy": 54536.5}}, "num_env_steps_sampled": 14737440, "num_env_steps_trained": 14737440, "num_agent_steps_sampled": 14737440, "num_agent_steps_trained": 14737440}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154922.05016754963, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2171170590965236, "mean_inference_ms": 0.3575658959182473, "mean_action_processing_ms": 0.08934460252857127, "mean_env_wait_ms": 0.6884617511217986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034749507904052734, "StateBufferConnector_ms": 0.002582371234893799, "ViewRequirementAgentConnector_ms": 0.0664249062538147}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154922.05016754963, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2171170590965236, "mean_inference_ms": 0.3575658959182473, "mean_action_processing_ms": 0.08934460252857127, "mean_env_wait_ms": 0.6884617511217986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034749507904052734, "StateBufferConnector_ms": 0.002582371234893799, "ViewRequirementAgentConnector_ms": 0.0664249062538147}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14737440, "num_agent_steps_trained": 14737440, "num_env_steps_sampled": 14737440, "num_env_steps_trained": 14737440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.4438607355204, "num_env_steps_trained_throughput_per_sec": 718.4438607355204, "timesteps_total": 14737440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14737440, "timers": {"training_iteration_time_ms": 61189.885, "sample_time_ms": 60051.66, "load_time_ms": 16.828, "load_throughput": 2609874.725, "learn_time_ms": 1120.351, "learn_throughput": 39201.985, "synch_weights_time_ms": 0.888}, "counters": {"num_env_steps_sampled": 14737440, "num_env_steps_trained": 14737440, "num_agent_steps_sampled": 14737440, "num_agent_steps_trained": 14737440}, "done": false, "episodes_total": 7788, "training_iteration": 1965, "trial_id": "e8087_00000", "date": "2023-08-06_11-57-56", "timestamp": 1691312276, "time_this_iter_s": 61.13489007949829, "time_total_s": 34381.82904648781, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4901.057618141174, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 17.132183908045974, "ram_util_percent": 70.89195402298851}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0837061578956, "policy_loss": -1847067.9637419141, "vf_loss": 4301618.798378279}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 55223.5, "diff_num_grad_updates_vs_sampler_policy": 55222.5}}, "num_env_steps_sampled": 14781360, "num_env_steps_trained": 14781360, "num_agent_steps_sampled": 14781360, "num_agent_steps_trained": 14781360}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154897.52106272618, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21711984065180884, "mean_inference_ms": 0.35756717804657, "mean_action_processing_ms": 0.0893455989755018, "mean_env_wait_ms": 0.688416295466957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003551553796838831, "StateBufferConnector_ms": 0.0025840453159661943, "ViewRequirementAgentConnector_ms": 0.06638367970784505}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154897.52106272618, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21711984065180884, "mean_inference_ms": 0.35756717804657, "mean_action_processing_ms": 0.0893455989755018, "mean_env_wait_ms": 0.688416295466957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003551553796838831, "StateBufferConnector_ms": 0.0025840453159661943, "ViewRequirementAgentConnector_ms": 0.06638367970784505}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14781360, "num_agent_steps_trained": 14781360, "num_env_steps_sampled": 14781360, "num_env_steps_trained": 14781360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.0112065763793, "num_env_steps_trained_throughput_per_sec": 716.0112065763793, "timesteps_total": 14781360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14781360, "timers": {"training_iteration_time_ms": 61222.548, "sample_time_ms": 60083.514, "load_time_ms": 16.863, "load_throughput": 2604561.057, "learn_time_ms": 1121.124, "learn_throughput": 39174.984, "synch_weights_time_ms": 0.89}, "counters": {"num_env_steps_sampled": 14781360, "num_env_steps_trained": 14781360, "num_agent_steps_sampled": 14781360, "num_agent_steps_trained": 14781360}, "done": false, "episodes_total": 7789, "training_iteration": 1966, "trial_id": "e8087_00000", "date": "2023-08-06_11-58-58", "timestamp": 1691312338, "time_this_iter_s": 61.342626094818115, "time_total_s": 34443.171672582626, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4962.400244235992, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 16.838372093023256, "ram_util_percent": 70.87209302325579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0365085434983, "policy_loss": -1976871.1510112975, "vf_loss": 4309448.02696793}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 55909.5, "diff_num_grad_updates_vs_sampler_policy": 55908.5}}, "num_env_steps_sampled": 14825280, "num_env_steps_trained": 14825280, "num_agent_steps_sampled": 14825280, "num_agent_steps_trained": 14825280}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154877.50097922483, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21712285969740835, "mean_inference_ms": 0.35756831061232913, "mean_action_processing_ms": 0.08934657351106155, "mean_env_wait_ms": 0.6883722465320868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003543423443305783, "StateBufferConnector_ms": 0.0025833525308748572, "ViewRequirementAgentConnector_ms": 0.06636206696673137}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154877.50097922483, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21712285969740835, "mean_inference_ms": 0.35756831061232913, "mean_action_processing_ms": 0.08934657351106155, "mean_env_wait_ms": 0.6883722465320868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003543423443305783, "StateBufferConnector_ms": 0.0025833525308748572, "ViewRequirementAgentConnector_ms": 0.06636206696673137}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14825280, "num_agent_steps_trained": 14825280, "num_env_steps_sampled": 14825280, "num_env_steps_trained": 14825280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.2851477485272, "num_env_steps_trained_throughput_per_sec": 715.2851477485272, "timesteps_total": 14825280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14825280, "timers": {"training_iteration_time_ms": 61264.672, "sample_time_ms": 60126.529, "load_time_ms": 16.901, "load_throughput": 2598641.975, "learn_time_ms": 1120.198, "learn_throughput": 39207.368, "synch_weights_time_ms": 0.887}, "counters": {"num_env_steps_sampled": 14825280, "num_env_steps_trained": 14825280, "num_agent_steps_sampled": 14825280, "num_agent_steps_trained": 14825280}, "done": false, "episodes_total": 7790, "training_iteration": 1967, "trial_id": "e8087_00000", "date": "2023-08-06_11-59-59", "timestamp": 1691312399, "time_this_iter_s": 61.405049085617065, "time_total_s": 34504.57672166824, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5023.8052933216095, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 16.955172413793104, "ram_util_percent": 70.80344827586207}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.06572445349514, "policy_loss": -2013675.6866401695, "vf_loss": 4495137.664540816}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 56595.5, "diff_num_grad_updates_vs_sampler_policy": 56594.5}}, "num_env_steps_sampled": 14869200, "num_env_steps_trained": 14869200, "num_agent_steps_sampled": 14869200, "num_agent_steps_trained": 14869200}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154886.7469954287, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21712592654729604, "mean_inference_ms": 0.35756963299791084, "mean_action_processing_ms": 0.08934756369941917, "mean_env_wait_ms": 0.6883288751371843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035377870123070405, "StateBufferConnector_ms": 0.002586123455001647, "ViewRequirementAgentConnector_ms": 0.06635706108736705}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154886.7469954287, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21712592654729604, "mean_inference_ms": 0.35756963299791084, "mean_action_processing_ms": 0.08934756369941917, "mean_env_wait_ms": 0.6883288751371843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035377870123070405, "StateBufferConnector_ms": 0.002586123455001647, "ViewRequirementAgentConnector_ms": 0.06635706108736705}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14869200, "num_agent_steps_trained": 14869200, "num_env_steps_sampled": 14869200, "num_env_steps_trained": 14869200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.811691959834, "num_env_steps_trained_throughput_per_sec": 716.811691959834, "timesteps_total": 14869200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14869200, "timers": {"training_iteration_time_ms": 61310.741, "sample_time_ms": 60172.016, "load_time_ms": 17.13, "load_throughput": 2563991.728, "learn_time_ms": 1120.552, "learn_throughput": 39194.958, "synch_weights_time_ms": 0.886}, "counters": {"num_env_steps_sampled": 14869200, "num_env_steps_trained": 14869200, "num_agent_steps_sampled": 14869200, "num_agent_steps_trained": 14869200}, "done": false, "episodes_total": 7791, "training_iteration": 1968, "trial_id": "e8087_00000", "date": "2023-08-06_12-01-00", "timestamp": 1691312460, "time_this_iter_s": 61.27417778968811, "time_total_s": 34565.85089945793, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5085.079471111298, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 17.265517241379307, "ram_util_percent": 70.87586206896553}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.07167542571574, "policy_loss": -2010892.4327367665, "vf_loss": 4645622.405976676}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 57281.5, "diff_num_grad_updates_vs_sampler_policy": 57280.5}}, "num_env_steps_sampled": 14913120, "num_env_steps_trained": 14913120, "num_agent_steps_sampled": 14913120, "num_agent_steps_trained": 14913120}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154920.1264604913, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21712836366593727, "mean_inference_ms": 0.35757107919772957, "mean_action_processing_ms": 0.08934854870959674, "mean_env_wait_ms": 0.6882855787396219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035322847820463635, "StateBufferConnector_ms": 0.0025837194351922897, "ViewRequirementAgentConnector_ms": 0.06633996963500977}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154920.1264604913, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21712836366593727, "mean_inference_ms": 0.35757107919772957, "mean_action_processing_ms": 0.08934854870959674, "mean_env_wait_ms": 0.6882855787396219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035322847820463635, "StateBufferConnector_ms": 0.0025837194351922897, "ViewRequirementAgentConnector_ms": 0.06633996963500977}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14913120, "num_agent_steps_trained": 14913120, "num_env_steps_sampled": 14913120, "num_env_steps_trained": 14913120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 722.0211056320932, "num_env_steps_trained_throughput_per_sec": 722.0211056320932, "timesteps_total": 14913120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14913120, "timers": {"training_iteration_time_ms": 61255.564, "sample_time_ms": 60117.88, "load_time_ms": 17.2, "load_throughput": 2553482.312, "learn_time_ms": 1119.447, "learn_throughput": 39233.673, "synch_weights_time_ms": 0.879}, "counters": {"num_env_steps_sampled": 14913120, "num_env_steps_trained": 14913120, "num_agent_steps_sampled": 14913120, "num_agent_steps_trained": 14913120}, "done": false, "episodes_total": 7792, "training_iteration": 1969, "trial_id": "e8087_00000", "date": "2023-08-06_12-02-01", "timestamp": 1691312521, "time_this_iter_s": 60.83199095726013, "time_total_s": 34626.68289041519, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5145.911462068558, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 17.736046511627904, "ram_util_percent": 70.95348837209303}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.99667465165476, "policy_loss": -2110076.8938593296, "vf_loss": 4390913.51284621}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 57967.5, "diff_num_grad_updates_vs_sampler_policy": 57966.5}}, "num_env_steps_sampled": 14957040, "num_env_steps_trained": 14957040, "num_agent_steps_sampled": 14957040, "num_agent_steps_trained": 14957040}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154910.87468589065, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21713078777168335, "mean_inference_ms": 0.357572732985088, "mean_action_processing_ms": 0.08934952056671422, "mean_env_wait_ms": 0.6882427510771962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003528875463149127, "StateBufferConnector_ms": 0.002581932965446921, "ViewRequirementAgentConnector_ms": 0.0663283291985007}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154910.87468589065, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21713078777168335, "mean_inference_ms": 0.357572732985088, "mean_action_processing_ms": 0.08934952056671422, "mean_env_wait_ms": 0.6882427510771962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003528875463149127, "StateBufferConnector_ms": 0.002581932965446921, "ViewRequirementAgentConnector_ms": 0.0663283291985007}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14957040, "num_agent_steps_trained": 14957040, "num_env_steps_sampled": 14957040, "num_env_steps_trained": 14957040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.0525911344376, "num_env_steps_trained_throughput_per_sec": 718.0525911344376, "timesteps_total": 14957040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 14957040, "timers": {"training_iteration_time_ms": 61203.609, "sample_time_ms": 60067.841, "load_time_ms": 17.172, "load_throughput": 2557651.576, "learn_time_ms": 1117.552, "learn_throughput": 39300.177, "synch_weights_time_ms": 0.882}, "counters": {"num_env_steps_sampled": 14957040, "num_env_steps_trained": 14957040, "num_agent_steps_sampled": 14957040, "num_agent_steps_trained": 14957040}, "done": false, "episodes_total": 7793, "training_iteration": 1970, "trial_id": "e8087_00000", "date": "2023-08-06_12-03-02", "timestamp": 1691312582, "time_this_iter_s": 61.1683509349823, "time_total_s": 34687.851241350174, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5207.07981300354, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 18.59885057471264, "ram_util_percent": 70.65172413793104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.998636362504, "policy_loss": -2288603.9971372196, "vf_loss": 4493453.610058309}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 58653.5, "diff_num_grad_updates_vs_sampler_policy": 58652.5}}, "num_env_steps_sampled": 15000960, "num_env_steps_trained": 15000960, "num_agent_steps_sampled": 15000960, "num_agent_steps_trained": 15000960}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154920.87756673974, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21713301181649913, "mean_inference_ms": 0.3575743283622055, "mean_action_processing_ms": 0.08935048262005973, "mean_env_wait_ms": 0.6882006660950658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00355631806129633, "StateBufferConnector_ms": 0.002586009890534157, "ViewRequirementAgentConnector_ms": 0.06633886071138603}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154920.87756673974, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21713301181649913, "mean_inference_ms": 0.3575743283622055, "mean_action_processing_ms": 0.08935048262005973, "mean_env_wait_ms": 0.6882006660950658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00355631806129633, "StateBufferConnector_ms": 0.002586009890534157, "ViewRequirementAgentConnector_ms": 0.06633886071138603}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15000960, "num_agent_steps_trained": 15000960, "num_env_steps_sampled": 15000960, "num_env_steps_trained": 15000960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.4427231376095, "num_env_steps_trained_throughput_per_sec": 718.4427231376095, "timesteps_total": 15000960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15000960, "timers": {"training_iteration_time_ms": 61187.324, "sample_time_ms": 60051.59, "load_time_ms": 17.201, "load_throughput": 2553383.21, "learn_time_ms": 1117.475, "learn_throughput": 39302.889, "synch_weights_time_ms": 0.891}, "counters": {"num_env_steps_sampled": 15000960, "num_env_steps_trained": 15000960, "num_agent_steps_sampled": 15000960, "num_agent_steps_trained": 15000960}, "done": false, "episodes_total": 7794, "training_iteration": 1971, "trial_id": "e8087_00000", "date": "2023-08-06_12-04-04", "timestamp": 1691312644, "time_this_iter_s": 61.1361517906189, "time_total_s": 34748.98739314079, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5268.215964794159, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 17.09186046511628, "ram_util_percent": 70.89418604651162}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1735818935205, "policy_loss": -2254303.679827009, "vf_loss": 4658612.20891035}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 59339.5, "diff_num_grad_updates_vs_sampler_policy": 59338.5}}, "num_env_steps_sampled": 15044880, "num_env_steps_trained": 15044880, "num_agent_steps_sampled": 15044880, "num_agent_steps_trained": 15044880}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154953.82255864143, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21713500121175874, "mean_inference_ms": 0.3575759192275737, "mean_action_processing_ms": 0.08935147670657966, "mean_env_wait_ms": 0.6881601153297964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003552710872957076, "StateBufferConnector_ms": 0.0025817717628917477, "ViewRequirementAgentConnector_ms": 0.06633407768161817}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154953.82255864143, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21713500121175874, "mean_inference_ms": 0.3575759192275737, "mean_action_processing_ms": 0.08935147670657966, "mean_env_wait_ms": 0.6881601153297964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003552710872957076, "StateBufferConnector_ms": 0.0025817717628917477, "ViewRequirementAgentConnector_ms": 0.06633407768161817}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15044880, "num_agent_steps_trained": 15044880, "num_env_steps_sampled": 15044880, "num_env_steps_trained": 15044880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.1956438118534, "num_env_steps_trained_throughput_per_sec": 715.1956438118534, "timesteps_total": 15044880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15044880, "timers": {"training_iteration_time_ms": 61224.805, "sample_time_ms": 60089.075, "load_time_ms": 17.084, "load_throughput": 2570887.122, "learn_time_ms": 1117.593, "learn_throughput": 39298.742, "synch_weights_time_ms": 0.885}, "counters": {"num_env_steps_sampled": 15044880, "num_env_steps_trained": 15044880, "num_agent_steps_sampled": 15044880, "num_agent_steps_trained": 15044880}, "done": false, "episodes_total": 7795, "training_iteration": 1972, "trial_id": "e8087_00000", "date": "2023-08-06_12-05-05", "timestamp": 1691312705, "time_this_iter_s": 61.4126181602478, "time_total_s": 34810.40001130104, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5329.628582954407, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 17.670114942528734, "ram_util_percent": 70.88735632183908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0354565322921, "policy_loss": -2125203.6266399417, "vf_loss": 4404560.264121721}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 60025.5, "diff_num_grad_updates_vs_sampler_policy": 60024.5}}, "num_env_steps_sampled": 15088800, "num_env_steps_trained": 15088800, "num_agent_steps_sampled": 15088800, "num_agent_steps_trained": 15088800}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154948.96750971407, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2171363883081659, "mean_inference_ms": 0.35757771303624003, "mean_action_processing_ms": 0.08935246239486946, "mean_env_wait_ms": 0.6881206084994805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035445798527110705, "StateBufferConnector_ms": 0.002583590420809659, "ViewRequirementAgentConnector_ms": 0.0663115219636397}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154948.96750971407, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2171363883081659, "mean_inference_ms": 0.35757771303624003, "mean_action_processing_ms": 0.08935246239486946, "mean_env_wait_ms": 0.6881206084994805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035445798527110705, "StateBufferConnector_ms": 0.002583590420809659, "ViewRequirementAgentConnector_ms": 0.0663115219636397}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15088800, "num_agent_steps_trained": 15088800, "num_env_steps_sampled": 15088800, "num_env_steps_trained": 15088800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.5525246211736, "num_env_steps_trained_throughput_per_sec": 716.5525246211736, "timesteps_total": 15088800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15088800, "timers": {"training_iteration_time_ms": 61261.26, "sample_time_ms": 60123.14, "load_time_ms": 17.122, "load_throughput": 2565109.22, "learn_time_ms": 1119.941, "learn_throughput": 39216.357, "synch_weights_time_ms": 0.889}, "counters": {"num_env_steps_sampled": 15088800, "num_env_steps_trained": 15088800, "num_agent_steps_sampled": 15088800, "num_agent_steps_trained": 15088800}, "done": false, "episodes_total": 7796, "training_iteration": 1973, "trial_id": "e8087_00000", "date": "2023-08-06_12-06-06", "timestamp": 1691312766, "time_this_iter_s": 61.296303033828735, "time_total_s": 34871.69631433487, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5390.9248859882355, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 17.990804597701153, "ram_util_percent": 70.83678160919541}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.91132766234284, "policy_loss": -2153102.32150402, "vf_loss": 4520149.375911078}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 60711.5, "diff_num_grad_updates_vs_sampler_policy": 60710.5}}, "num_env_steps_sampled": 15132720, "num_env_steps_trained": 15132720, "num_agent_steps_sampled": 15132720, "num_agent_steps_trained": 15132720}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154965.38698481504, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2171379381261276, "mean_inference_ms": 0.3575794915001581, "mean_action_processing_ms": 0.08935342543825829, "mean_env_wait_ms": 0.6880816927669202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035486864239982004, "StateBufferConnector_ms": 0.002582957235614905, "ViewRequirementAgentConnector_ms": 0.06631143977133076}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154965.38698481504, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2171379381261276, "mean_inference_ms": 0.3575794915001581, "mean_action_processing_ms": 0.08935342543825829, "mean_env_wait_ms": 0.6880816927669202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035486864239982004, "StateBufferConnector_ms": 0.002582957235614905, "ViewRequirementAgentConnector_ms": 0.06631143977133076}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15132720, "num_agent_steps_trained": 15132720, "num_env_steps_sampled": 15132720, "num_env_steps_trained": 15132720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.0259901704597, "num_env_steps_trained_throughput_per_sec": 717.0259901704597, "timesteps_total": 15132720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15132720, "timers": {"training_iteration_time_ms": 61222.832, "sample_time_ms": 60083.242, "load_time_ms": 17.217, "load_throughput": 2550954.067, "learn_time_ms": 1121.315, "learn_throughput": 39168.285, "synch_weights_time_ms": 0.888}, "counters": {"num_env_steps_sampled": 15132720, "num_env_steps_trained": 15132720, "num_agent_steps_sampled": 15132720, "num_agent_steps_trained": 15132720}, "done": false, "episodes_total": 7797, "training_iteration": 1974, "trial_id": "e8087_00000", "date": "2023-08-06_12-07-08", "timestamp": 1691312828, "time_this_iter_s": 61.255945920944214, "time_total_s": 34932.95226025581, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5452.18083190918, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 17.193103448275863, "ram_util_percent": 70.83218390804596}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1136896339172, "policy_loss": -1746369.8748007016, "vf_loss": 4374368.587099126}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 61397.5, "diff_num_grad_updates_vs_sampler_policy": 61396.5}}, "num_env_steps_sampled": 15176640, "num_env_steps_trained": 15176640, "num_agent_steps_sampled": 15176640, "num_agent_steps_trained": 15176640}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154956.49163494725, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21713950978931082, "mean_inference_ms": 0.3575813267312866, "mean_action_processing_ms": 0.08935436644964373, "mean_env_wait_ms": 0.6880444863189468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003544224633110894, "StateBufferConnector_ms": 0.0025807486640082467, "ViewRequirementAgentConnector_ms": 0.06630818049112956}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154956.49163494725, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21713950978931082, "mean_inference_ms": 0.3575813267312866, "mean_action_processing_ms": 0.08935436644964373, "mean_env_wait_ms": 0.6880444863189468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003544224633110894, "StateBufferConnector_ms": 0.0025807486640082467, "ViewRequirementAgentConnector_ms": 0.06630818049112956}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15176640, "num_agent_steps_trained": 15176640, "num_env_steps_sampled": 15176640, "num_env_steps_trained": 15176640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.7036667378608, "num_env_steps_trained_throughput_per_sec": 712.7036667378608, "timesteps_total": 15176640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15176640, "timers": {"training_iteration_time_ms": 61272.068, "sample_time_ms": 60132.911, "load_time_ms": 17.249, "load_throughput": 2546264.469, "learn_time_ms": 1120.845, "learn_throughput": 39184.709, "synch_weights_time_ms": 0.894}, "counters": {"num_env_steps_sampled": 15176640, "num_env_steps_trained": 15176640, "num_agent_steps_sampled": 15176640, "num_agent_steps_trained": 15176640}, "done": false, "episodes_total": 7798, "training_iteration": 1975, "trial_id": "e8087_00000", "date": "2023-08-06_12-08-09", "timestamp": 1691312889, "time_this_iter_s": 61.627354860305786, "time_total_s": 34994.57961511612, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5513.8081867694855, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 16.922988505747124, "ram_util_percent": 70.81264367816092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.171762894611, "policy_loss": -2133277.439125706, "vf_loss": 4548218.157798834}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 62083.5, "diff_num_grad_updates_vs_sampler_policy": 62082.5}}, "num_env_steps_sampled": 15220560, "num_env_steps_trained": 15220560, "num_agent_steps_sampled": 15220560, "num_agent_steps_trained": 15220560}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154967.4921938533, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2224029854098622, "mean_inference_ms": 0.3575833622680984, "mean_action_processing_ms": 0.08935534638244348, "mean_env_wait_ms": 0.6907933051602059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035385509113689045, "StateBufferConnector_ms": 0.0025819946121383498, "ViewRequirementAgentConnector_ms": 0.06631521078256461}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154967.4921938533, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2224029854098622, "mean_inference_ms": 0.3575833622680984, "mean_action_processing_ms": 0.08935534638244348, "mean_env_wait_ms": 0.6907933051602059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035385509113689045, "StateBufferConnector_ms": 0.0025819946121383498, "ViewRequirementAgentConnector_ms": 0.06631521078256461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15220560, "num_agent_steps_trained": 15220560, "num_env_steps_sampled": 15220560, "num_env_steps_trained": 15220560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 14.6980763969129, "num_env_steps_trained_throughput_per_sec": 14.6980763969129, "timesteps_total": 15220560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15220560, "timers": {"training_iteration_time_ms": 353952.696, "sample_time_ms": 352815.078, "load_time_ms": 17.447, "load_throughput": 2517270.179, "learn_time_ms": 1119.089, "learn_throughput": 39246.219, "synch_weights_time_ms": 0.908}, "counters": {"num_env_steps_sampled": 15220560, "num_env_steps_trained": 15220560, "num_agent_steps_sampled": 15220560, "num_agent_steps_trained": 15220560}, "done": false, "episodes_total": 7799, "training_iteration": 1976, "trial_id": "e8087_00000", "date": "2023-08-06_12-57-57", "timestamp": 1691315877, "time_this_iter_s": 2988.1491549015045, "time_total_s": 37982.728770017624, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8501.95734167099, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 21.814606741573037, "ram_util_percent": 70.74606741573034}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9035963942636, "policy_loss": -2050304.8132858053, "vf_loss": 4388003.72303207}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 62769.5, "diff_num_grad_updates_vs_sampler_policy": 62768.5}}, "num_env_steps_sampled": 15264480, "num_env_steps_trained": 15264480, "num_agent_steps_sampled": 15264480, "num_agent_steps_trained": 15264480}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154960.83757629636, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22749567636416046, "mean_inference_ms": 0.3599833788052468, "mean_action_processing_ms": 0.08935643059563095, "mean_env_wait_ms": 0.6934637980633008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003535332887069039, "StateBufferConnector_ms": 0.002581917721292247, "ViewRequirementAgentConnector_ms": 0.06630109704059103}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154960.83757629636, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22749567636416046, "mean_inference_ms": 0.3599833788052468, "mean_action_processing_ms": 0.08935643059563095, "mean_env_wait_ms": 0.6934637980633008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003535332887069039, "StateBufferConnector_ms": 0.002581917721292247, "ViewRequirementAgentConnector_ms": 0.06630109704059103}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15264480, "num_agent_steps_trained": 15264480, "num_env_steps_sampled": 15264480, "num_env_steps_trained": 15264480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 45.889699997826206, "num_env_steps_trained_throughput_per_sec": 45.889699997826206, "timesteps_total": 15264480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15264480, "timers": {"training_iteration_time_ms": 443520.239, "sample_time_ms": 442383.313, "load_time_ms": 17.899, "load_throughput": 2453812.404, "learn_time_ms": 1117.938, "learn_throughput": 39286.604, "synch_weights_time_ms": 0.913}, "counters": {"num_env_steps_sampled": 15264480, "num_env_steps_trained": 15264480, "num_agent_steps_sampled": 15264480, "num_agent_steps_trained": 15264480}, "done": false, "episodes_total": 7800, "training_iteration": 1977, "trial_id": "e8087_00000", "date": "2023-08-06_13-13-55", "timestamp": 1691316835, "time_this_iter_s": 957.0804679393768, "time_total_s": 38939.809237957, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9459.037809610367, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 19.611363636363635, "ram_util_percent": 71.15227272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.8119569561572, "policy_loss": -2222755.7609329447, "vf_loss": 4234940.892583819}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 63455.5, "diff_num_grad_updates_vs_sampler_policy": 63454.5}}, "num_env_steps_sampled": 15308400, "num_env_steps_trained": 15308400, "num_agent_steps_sampled": 15308400, "num_agent_steps_trained": 15308400}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154931.28618531435, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2324241360130021, "mean_inference_ms": 0.36230634954296376, "mean_action_processing_ms": 0.08935751424151098, "mean_env_wait_ms": 0.6960487828670607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003531927703529276, "StateBufferConnector_ms": 0.002586713401220178, "ViewRequirementAgentConnector_ms": 0.06632189596852948}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154931.28618531435, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2324241360130021, "mean_inference_ms": 0.36230634954296376, "mean_action_processing_ms": 0.08935751424151098, "mean_env_wait_ms": 0.6960487828670607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003531927703529276, "StateBufferConnector_ms": 0.002586713401220178, "ViewRequirementAgentConnector_ms": 0.06632189596852948}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15308400, "num_agent_steps_trained": 15308400, "num_env_steps_sampled": 15308400, "num_env_steps_trained": 15308400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.6917016140164, "num_env_steps_trained_throughput_per_sec": 711.6917016140164, "timesteps_total": 15308400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15308400, "timers": {"training_iteration_time_ms": 443564.318, "sample_time_ms": 442428.258, "load_time_ms": 17.701, "load_throughput": 2481275.076, "learn_time_ms": 1117.26, "learn_throughput": 39310.465, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 15308400, "num_env_steps_trained": 15308400, "num_agent_steps_sampled": 15308400, "num_agent_steps_trained": 15308400}, "done": false, "episodes_total": 7801, "training_iteration": 1978, "trial_id": "e8087_00000", "date": "2023-08-06_13-14-56", "timestamp": 1691316896, "time_this_iter_s": 61.71489191055298, "time_total_s": 39001.524129867554, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9520.75270152092, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 17.356818181818184, "ram_util_percent": 71.2715909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9059290315945, "policy_loss": -1943984.133424631, "vf_loss": 4302803.14340379}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 64141.5, "diff_num_grad_updates_vs_sampler_policy": 64140.5}}, "num_env_steps_sampled": 15352320, "num_env_steps_trained": 15352320, "num_agent_steps_sampled": 15352320, "num_agent_steps_trained": 15352320}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154910.58176553095, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23719470953627797, "mean_inference_ms": 0.36455526637028385, "mean_action_processing_ms": 0.08935858859189107, "mean_env_wait_ms": 0.6985506019947365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035301167914207946, "StateBufferConnector_ms": 0.0025876024936107877, "ViewRequirementAgentConnector_ms": 0.06632196142318401}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154910.58176553095, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23719470953627797, "mean_inference_ms": 0.36455526637028385, "mean_action_processing_ms": 0.08935858859189107, "mean_env_wait_ms": 0.6985506019947365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035301167914207946, "StateBufferConnector_ms": 0.0025876024936107877, "ViewRequirementAgentConnector_ms": 0.06632196142318401}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15352320, "num_agent_steps_trained": 15352320, "num_env_steps_sampled": 15352320, "num_env_steps_trained": 15352320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.4361262369744, "num_env_steps_trained_throughput_per_sec": 716.4361262369744, "timesteps_total": 15352320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15352320, "timers": {"training_iteration_time_ms": 443611.737, "sample_time_ms": 442474.633, "load_time_ms": 17.712, "load_throughput": 2479695.24, "learn_time_ms": 1118.291, "learn_throughput": 39274.202, "synch_weights_time_ms": 0.926}, "counters": {"num_env_steps_sampled": 15352320, "num_env_steps_trained": 15352320, "num_agent_steps_sampled": 15352320, "num_agent_steps_trained": 15352320}, "done": false, "episodes_total": 7802, "training_iteration": 1979, "trial_id": "e8087_00000", "date": "2023-08-06_13-15-58", "timestamp": 1691316958, "time_this_iter_s": 61.306408166885376, "time_total_s": 39062.83053803444, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9582.059109687805, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 16.71379310344828, "ram_util_percent": 71.3367816091954}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.94790604927795, "policy_loss": -2142193.2067835503, "vf_loss": 4362295.193968659}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 64827.5, "diff_num_grad_updates_vs_sampler_policy": 64826.5}}, "num_env_steps_sampled": 15396240, "num_env_steps_trained": 15396240, "num_agent_steps_sampled": 15396240, "num_agent_steps_trained": 15396240}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154898.78729011855, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2418134946964963, "mean_inference_ms": 0.36673302223459747, "mean_action_processing_ms": 0.08935964805677118, "mean_env_wait_ms": 0.7009731917103458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035268382022255345, "StateBufferConnector_ms": 0.002585461265162418, "ViewRequirementAgentConnector_ms": 0.06631399455823396}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154898.78729011855, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2418134946964963, "mean_inference_ms": 0.36673302223459747, "mean_action_processing_ms": 0.08935964805677118, "mean_env_wait_ms": 0.7009731917103458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035268382022255345, "StateBufferConnector_ms": 0.002585461265162418, "ViewRequirementAgentConnector_ms": 0.06631399455823396}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15396240, "num_agent_steps_trained": 15396240, "num_env_steps_sampled": 15396240, "num_env_steps_trained": 15396240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.9856149929199, "num_env_steps_trained_throughput_per_sec": 712.9856149929199, "timesteps_total": 15396240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15396240, "timers": {"training_iteration_time_ms": 443655.206, "sample_time_ms": 442517.203, "load_time_ms": 17.791, "load_throughput": 2468626.299, "learn_time_ms": 1119.115, "learn_throughput": 39245.281, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 15396240, "num_env_steps_trained": 15396240, "num_agent_steps_sampled": 15396240, "num_agent_steps_trained": 15396240}, "done": false, "episodes_total": 7803, "training_iteration": 1980, "trial_id": "e8087_00000", "date": "2023-08-06_13-16-59", "timestamp": 1691317019, "time_this_iter_s": 61.60298490524292, "time_total_s": 39124.43352293968, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9643.662094593048, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 17.70909090909091, "ram_util_percent": 71.28068181818183}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.3066166913892, "policy_loss": -2006323.4027238407, "vf_loss": 4657216.944606414}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 65513.5, "diff_num_grad_updates_vs_sampler_policy": 65512.5}}, "num_env_steps_sampled": 15440160, "num_env_steps_trained": 15440160, "num_agent_steps_sampled": 15440160, "num_agent_steps_trained": 15440160}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154925.20215086313, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24628624744892288, "mean_inference_ms": 0.36884240948846764, "mean_action_processing_ms": 0.08936068386205853, "mean_env_wait_ms": 0.7033179581601209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035221378008524575, "StateBufferConnector_ms": 0.00258485476175944, "ViewRequirementAgentConnector_ms": 0.06631041566530864}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154925.20215086313, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24628624744892288, "mean_inference_ms": 0.36884240948846764, "mean_action_processing_ms": 0.08936068386205853, "mean_env_wait_ms": 0.7033179581601209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035221378008524575, "StateBufferConnector_ms": 0.00258485476175944, "ViewRequirementAgentConnector_ms": 0.06631041566530864}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15440160, "num_agent_steps_trained": 15440160, "num_env_steps_sampled": 15440160, "num_env_steps_trained": 15440160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 720.4258650196471, "num_env_steps_trained_throughput_per_sec": 720.4258650196471, "timesteps_total": 15440160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15440160, "timers": {"training_iteration_time_ms": 443638.378, "sample_time_ms": 442501.956, "load_time_ms": 17.842, "load_throughput": 2461609.81, "learn_time_ms": 1117.497, "learn_throughput": 39302.106, "synch_weights_time_ms": 0.915}, "counters": {"num_env_steps_sampled": 15440160, "num_env_steps_trained": 15440160, "num_agent_steps_sampled": 15440160, "num_agent_steps_trained": 15440160}, "done": false, "episodes_total": 7804, "training_iteration": 1981, "trial_id": "e8087_00000", "date": "2023-08-06_13-18-00", "timestamp": 1691317080, "time_this_iter_s": 60.96679091453552, "time_total_s": 39185.40031385422, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9704.628885507584, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 16.94302325581395, "ram_util_percent": 71.29651162790695}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.20295412825425, "policy_loss": -2073755.4005215925, "vf_loss": 4523938.287900874}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 66199.5, "diff_num_grad_updates_vs_sampler_policy": 66198.5}}, "num_env_steps_sampled": 15484080, "num_env_steps_trained": 15484080, "num_agent_steps_sampled": 15484080, "num_agent_steps_trained": 15484080}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154936.58085113013, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2506186521048584, "mean_inference_ms": 0.3708858965229883, "mean_action_processing_ms": 0.08936172131799827, "mean_env_wait_ms": 0.7055876964523713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003516305353223663, "StateBufferConnector_ms": 0.002581311255386195, "ViewRequirementAgentConnector_ms": 0.0662980620394048}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154936.58085113013, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2506186521048584, "mean_inference_ms": 0.3708858965229883, "mean_action_processing_ms": 0.08936172131799827, "mean_env_wait_ms": 0.7055876964523713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003516305353223663, "StateBufferConnector_ms": 0.002581311255386195, "ViewRequirementAgentConnector_ms": 0.0662980620394048}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15484080, "num_agent_steps_trained": 15484080, "num_env_steps_sampled": 15484080, "num_env_steps_trained": 15484080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 720.8987716419858, "num_env_steps_trained_throughput_per_sec": 720.8987716419858, "timesteps_total": 15484080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15484080, "timers": {"training_iteration_time_ms": 443589.796, "sample_time_ms": 442453.413, "load_time_ms": 17.753, "load_throughput": 2473937.397, "learn_time_ms": 1117.546, "learn_throughput": 39300.401, "synch_weights_time_ms": 0.918}, "counters": {"num_env_steps_sampled": 15484080, "num_env_steps_trained": 15484080, "num_agent_steps_sampled": 15484080, "num_agent_steps_trained": 15484080}, "done": false, "episodes_total": 7805, "training_iteration": 1982, "trial_id": "e8087_00000", "date": "2023-08-06_13-19-01", "timestamp": 1691317141, "time_this_iter_s": 60.92689609527588, "time_total_s": 39246.32720994949, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9765.55578160286, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 17.68735632183908, "ram_util_percent": 71.3103448275862}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0896130442272, "policy_loss": -2008902.5114169552, "vf_loss": 4358260.701712828}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 66885.5, "diff_num_grad_updates_vs_sampler_policy": 66884.5}}, "num_env_steps_sampled": 15528000, "num_env_steps_trained": 15528000, "num_agent_steps_sampled": 15528000, "num_agent_steps_trained": 15528000}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154926.88909286592, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2548158528740258, "mean_inference_ms": 0.3728658768779427, "mean_action_processing_ms": 0.08936275728268583, "mean_env_wait_ms": 0.7077870089257727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035137546305753745, "StateBufferConnector_ms": 0.002579056486791494, "ViewRequirementAgentConnector_ms": 0.06631466807151327}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154926.88909286592, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2548158528740258, "mean_inference_ms": 0.3728658768779427, "mean_action_processing_ms": 0.08936275728268583, "mean_env_wait_ms": 0.7077870089257727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035137546305753745, "StateBufferConnector_ms": 0.002579056486791494, "ViewRequirementAgentConnector_ms": 0.06631466807151327}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15528000, "num_agent_steps_trained": 15528000, "num_env_steps_sampled": 15528000, "num_env_steps_trained": 15528000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.5050036664371, "num_env_steps_trained_throughput_per_sec": 712.5050036664371, "timesteps_total": 15528000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15528000, "timers": {"training_iteration_time_ms": 443624.614, "sample_time_ms": 442491.033, "load_time_ms": 17.822, "load_throughput": 2464372.711, "learn_time_ms": 1114.673, "learn_throughput": 39401.674, "synch_weights_time_ms": 0.918}, "counters": {"num_env_steps_sampled": 15528000, "num_env_steps_trained": 15528000, "num_agent_steps_sampled": 15528000, "num_agent_steps_trained": 15528000}, "done": false, "episodes_total": 7806, "training_iteration": 1983, "trial_id": "e8087_00000", "date": "2023-08-06_13-20-03", "timestamp": 1691317203, "time_this_iter_s": 61.64478516578674, "time_total_s": 39307.97199511528, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9827.200566768646, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 18.393103448275863, "ram_util_percent": 71.35632183908048}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.5000000000000005e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.05473799191134, "policy_loss": -1807772.6566286671, "vf_loss": 4208574.3367346935}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 67571.5, "diff_num_grad_updates_vs_sampler_policy": 67570.5}}, "num_env_steps_sampled": 15571920, "num_env_steps_trained": 15571920, "num_agent_steps_sampled": 15571920, "num_agent_steps_trained": 15571920}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154893.71801883128, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25888299264494635, "mean_inference_ms": 0.3747847915251404, "mean_action_processing_ms": 0.0893637875804879, "mean_env_wait_ms": 0.7099171783084666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003512700398763021, "StateBufferConnector_ms": 0.0025766064422299163, "ViewRequirementAgentConnector_ms": 0.06631889728584675}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154893.71801883128, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25888299264494635, "mean_inference_ms": 0.3747847915251404, "mean_action_processing_ms": 0.0893637875804879, "mean_env_wait_ms": 0.7099171783084666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003512700398763021, "StateBufferConnector_ms": 0.0025766064422299163, "ViewRequirementAgentConnector_ms": 0.06631889728584675}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15571920, "num_agent_steps_trained": 15571920, "num_env_steps_sampled": 15571920, "num_env_steps_trained": 15571920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.9798371897565, "num_env_steps_trained_throughput_per_sec": 718.9798371897565, "timesteps_total": 15571920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15571920, "timers": {"training_iteration_time_ms": 443607.969, "sample_time_ms": 442475.382, "load_time_ms": 17.695, "load_throughput": 2482017.258, "learn_time_ms": 1113.803, "learn_throughput": 39432.469, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 15571920, "num_env_steps_trained": 15571920, "num_agent_steps_sampled": 15571920, "num_agent_steps_trained": 15571920}, "done": false, "episodes_total": 7807, "training_iteration": 1984, "trial_id": "e8087_00000", "date": "2023-08-06_13-21-04", "timestamp": 1691317264, "time_this_iter_s": 61.090052127838135, "time_total_s": 39369.06204724312, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9888.290618896484, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 17.60813953488372, "ram_util_percent": 71.54999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.92847173485046, "policy_loss": -2078849.2788185587, "vf_loss": 4387424.5521137025}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 68257.5, "diff_num_grad_updates_vs_sampler_policy": 68256.5}}, "num_env_steps_sampled": 15615840, "num_env_steps_trained": 15615840, "num_agent_steps_sampled": 15615840, "num_agent_steps_trained": 15615840}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154887.05143683832, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26282468095656264, "mean_inference_ms": 0.3766447897871749, "mean_action_processing_ms": 0.08936479588120956, "mean_env_wait_ms": 0.7119809992614995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035109519958496094, "StateBufferConnector_ms": 0.002573251724243164, "ViewRequirementAgentConnector_ms": 0.06630873680114746}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154887.05143683832, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152838.72735678652, -158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26282468095656264, "mean_inference_ms": 0.3766447897871749, "mean_action_processing_ms": 0.08936479588120956, "mean_env_wait_ms": 0.7119809992614995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035109519958496094, "StateBufferConnector_ms": 0.002573251724243164, "ViewRequirementAgentConnector_ms": 0.06630873680114746}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15615840, "num_agent_steps_trained": 15615840, "num_env_steps_sampled": 15615840, "num_env_steps_trained": 15615840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.2010693037579, "num_env_steps_trained_throughput_per_sec": 719.2010693037579, "timesteps_total": 15615840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15615840, "timers": {"training_iteration_time_ms": 443552.296, "sample_time_ms": 442419.692, "load_time_ms": 17.789, "load_throughput": 2468914.144, "learn_time_ms": 1113.733, "learn_throughput": 39434.943, "synch_weights_time_ms": 0.916}, "counters": {"num_env_steps_sampled": 15615840, "num_env_steps_trained": 15615840, "num_agent_steps_sampled": 15615840, "num_agent_steps_trained": 15615840}, "done": false, "episodes_total": 7808, "training_iteration": 1985, "trial_id": "e8087_00000", "date": "2023-08-06_13-22-05", "timestamp": 1691317325, "time_this_iter_s": 61.07094478607178, "time_total_s": 39430.13299202919, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9949.361563682556, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 16.841379310344827, "ram_util_percent": 71.57011494252872}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.4999999999999997e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.99522564501524, "policy_loss": -1929070.840974057, "vf_loss": 4420083.681851312}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 68943.5, "diff_num_grad_updates_vs_sampler_policy": 68942.5}}, "num_env_steps_sampled": 15659760, "num_env_steps_trained": 15659760, "num_agent_steps_sampled": 15659760, "num_agent_steps_trained": 15659760}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154903.49299050643, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2671642911973329, "mean_inference_ms": 0.37864821621013, "mean_action_processing_ms": 0.08936869036265539, "mean_env_wait_ms": 0.7135986172508789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003509044647216797, "StateBufferConnector_ms": 0.0025756359100341797, "ViewRequirementAgentConnector_ms": 0.06633496284484863}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154903.49299050643, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-158597.7107778979, -157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2671642911973329, "mean_inference_ms": 0.37864821621013, "mean_action_processing_ms": 0.08936869036265539, "mean_env_wait_ms": 0.7135986172508789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003509044647216797, "StateBufferConnector_ms": 0.0025756359100341797, "ViewRequirementAgentConnector_ms": 0.06633496284484863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15659760, "num_agent_steps_trained": 15659760, "num_env_steps_sampled": 15659760, "num_env_steps_trained": 15659760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.5309214021798, "num_env_steps_trained_throughput_per_sec": 716.5309214021798, "timesteps_total": 15659760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15659760, "timers": {"training_iteration_time_ms": 150867.219, "sample_time_ms": 149734.439, "load_time_ms": 17.53, "load_throughput": 2505349.399, "learn_time_ms": 1114.191, "learn_throughput": 39418.734, "synch_weights_time_ms": 0.898}, "counters": {"num_env_steps_sampled": 15659760, "num_env_steps_trained": 15659760, "num_agent_steps_sampled": 15659760, "num_agent_steps_trained": 15659760}, "done": false, "episodes_total": 7809, "training_iteration": 1986, "trial_id": "e8087_00000", "date": "2023-08-06_13-23-06", "timestamp": 1691317386, "time_this_iter_s": 61.29837989807129, "time_total_s": 39491.43137192726, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10010.659943580627, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 17.082758620689653, "ram_util_percent": 71.49310344827585}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.04149056037033, "policy_loss": -2329411.0581353637, "vf_loss": 4357708.592383382}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 69629.5, "diff_num_grad_updates_vs_sampler_policy": 69628.5}}, "num_env_steps_sampled": 15703680, "num_env_steps_trained": 15703680, "num_agent_steps_sampled": 15703680, "num_agent_steps_trained": 15703680}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154857.05344021364, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27145969016069627, "mean_inference_ms": 0.3806300584617102, "mean_action_processing_ms": 0.08937149073360333, "mean_env_wait_ms": 0.715560611619561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003509521484375, "StateBufferConnector_ms": 0.002573251724243164, "ViewRequirementAgentConnector_ms": 0.06633973121643066}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154857.05344021364, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157767.28504650603, -154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27145969016069627, "mean_inference_ms": 0.3806300584617102, "mean_action_processing_ms": 0.08937149073360333, "mean_env_wait_ms": 0.715560611619561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003509521484375, "StateBufferConnector_ms": 0.002573251724243164, "ViewRequirementAgentConnector_ms": 0.06633973121643066}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15703680, "num_agent_steps_trained": 15703680, "num_env_steps_sampled": 15703680, "num_env_steps_trained": 15703680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.4579539586169, "num_env_steps_trained_throughput_per_sec": 711.4579539586169, "timesteps_total": 15703680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15703680, "timers": {"training_iteration_time_ms": 61332.706, "sample_time_ms": 60199.987, "load_time_ms": 17.053, "load_throughput": 2575430.278, "learn_time_ms": 1114.601, "learn_throughput": 39404.241, "synch_weights_time_ms": 0.903}, "counters": {"num_env_steps_sampled": 15703680, "num_env_steps_trained": 15703680, "num_agent_steps_sampled": 15703680, "num_agent_steps_trained": 15703680}, "done": false, "episodes_total": 7810, "training_iteration": 1987, "trial_id": "e8087_00000", "date": "2023-08-06_13-24-08", "timestamp": 1691317448, "time_this_iter_s": 61.735580921173096, "time_total_s": 39553.166952848434, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10072.3955245018, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 17.7183908045977, "ram_util_percent": 71.33218390804598}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999994e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.99832927381334, "policy_loss": -1918725.6101892765, "vf_loss": 4282182.156158892}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 70315.5, "diff_num_grad_updates_vs_sampler_policy": 70314.5}}, "num_env_steps_sampled": 15747600, "num_env_steps_trained": 15747600, "num_agent_steps_sampled": 15747600, "num_agent_steps_trained": 15747600}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154807.96558381376, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2757110983415558, "mean_inference_ms": 0.38259573259589535, "mean_action_processing_ms": 0.08937444501572524, "mean_env_wait_ms": 0.7175999179679602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035119056701660156, "StateBufferConnector_ms": 0.0025734901428222656, "ViewRequirementAgentConnector_ms": 0.06634283065795898}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154807.96558381376, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154141.41620859446, -155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2757110983415558, "mean_inference_ms": 0.38259573259589535, "mean_action_processing_ms": 0.08937444501572524, "mean_env_wait_ms": 0.7175999179679602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035119056701660156, "StateBufferConnector_ms": 0.0025734901428222656, "ViewRequirementAgentConnector_ms": 0.06634283065795898}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15747600, "num_agent_steps_trained": 15747600, "num_env_steps_sampled": 15747600, "num_env_steps_trained": 15747600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.7202746925736, "num_env_steps_trained_throughput_per_sec": 716.7202746925736, "timesteps_total": 15747600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15747600, "timers": {"training_iteration_time_ms": 61289.409, "sample_time_ms": 60156.96, "load_time_ms": 17.136, "load_throughput": 2563042.803, "learn_time_ms": 1114.257, "learn_throughput": 39416.397, "synch_weights_time_ms": 0.895}, "counters": {"num_env_steps_sampled": 15747600, "num_env_steps_trained": 15747600, "num_agent_steps_sampled": 15747600, "num_agent_steps_trained": 15747600}, "done": false, "episodes_total": 7811, "training_iteration": 1988, "trial_id": "e8087_00000", "date": "2023-08-06_13-25-10", "timestamp": 1691317510, "time_this_iter_s": 61.28215408325195, "time_total_s": 39614.44910693169, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10133.677678585052, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 17.517241379310345, "ram_util_percent": 71.36436781609196}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.9999999999999996e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.2086317323735, "policy_loss": -2059407.3227553298, "vf_loss": 4601146.042456268}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 71001.5, "diff_num_grad_updates_vs_sampler_policy": 71000.5}}, "num_env_steps_sampled": 15791520, "num_env_steps_trained": 15791520, "num_agent_steps_sampled": 15791520, "num_agent_steps_trained": 15791520}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154839.39154187727, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2799187201796999, "mean_inference_ms": 0.38454526164992026, "mean_action_processing_ms": 0.08937727955080049, "mean_env_wait_ms": 0.7196572016023538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003510713577270508, "StateBufferConnector_ms": 0.002577543258666992, "ViewRequirementAgentConnector_ms": 0.06640887260437012}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154839.39154187727, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155882.52198086472, -157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2799187201796999, "mean_inference_ms": 0.38454526164992026, "mean_action_processing_ms": 0.08937727955080049, "mean_env_wait_ms": 0.7196572016023538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003510713577270508, "StateBufferConnector_ms": 0.002577543258666992, "ViewRequirementAgentConnector_ms": 0.06640887260437012}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15791520, "num_agent_steps_trained": 15791520, "num_env_steps_sampled": 15791520, "num_env_steps_trained": 15791520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.9205116142664, "num_env_steps_trained_throughput_per_sec": 718.9205116142664, "timesteps_total": 15791520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15791520, "timers": {"training_iteration_time_ms": 61268.224, "sample_time_ms": 60134.946, "load_time_ms": 17.09, "load_throughput": 2569904.406, "learn_time_ms": 1115.123, "learn_throughput": 39385.794, "synch_weights_time_ms": 0.904}, "counters": {"num_env_steps_sampled": 15791520, "num_env_steps_trained": 15791520, "num_agent_steps_sampled": 15791520, "num_agent_steps_trained": 15791520}, "done": false, "episodes_total": 7812, "training_iteration": 1989, "trial_id": "e8087_00000", "date": "2023-08-06_13-26-11", "timestamp": 1691317571, "time_this_iter_s": 61.09447407722473, "time_total_s": 39675.54358100891, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10194.772152662277, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 17.109302325581393, "ram_util_percent": 71.36860465116278}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4999999999999997e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0314065916545, "policy_loss": -2072271.661141354, "vf_loss": 4576308.644041545}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 71687.5, "diff_num_grad_updates_vs_sampler_policy": 71686.5}}, "num_env_steps_sampled": 15835440, "num_env_steps_trained": 15835440, "num_agent_steps_sampled": 15835440, "num_agent_steps_trained": 15835440}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154847.9397669862, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2840809121674419, "mean_inference_ms": 0.38647646540128106, "mean_action_processing_ms": 0.08937990607433682, "mean_env_wait_ms": 0.7217291126266354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003515481948852539, "StateBufferConnector_ms": 0.002578258514404297, "ViewRequirementAgentConnector_ms": 0.06645584106445312}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154847.9397669862, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157769.5537192523, -154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2840809121674419, "mean_inference_ms": 0.38647646540128106, "mean_action_processing_ms": 0.08937990607433682, "mean_env_wait_ms": 0.7217291126266354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003515481948852539, "StateBufferConnector_ms": 0.002578258514404297, "ViewRequirementAgentConnector_ms": 0.06645584106445312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15835440, "num_agent_steps_trained": 15835440, "num_env_steps_sampled": 15835440, "num_env_steps_trained": 15835440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.9987266988678, "num_env_steps_trained_throughput_per_sec": 716.9987266988678, "timesteps_total": 15835440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15835440, "timers": {"training_iteration_time_ms": 61233.746, "sample_time_ms": 60101.029, "load_time_ms": 17.02, "load_throughput": 2580564.175, "learn_time_ms": 1114.636, "learn_throughput": 39403.005, "synch_weights_time_ms": 0.901}, "counters": {"num_env_steps_sampled": 15835440, "num_env_steps_trained": 15835440, "num_agent_steps_sampled": 15835440, "num_agent_steps_trained": 15835440}, "done": false, "episodes_total": 7813, "training_iteration": 1990, "trial_id": "e8087_00000", "date": "2023-08-06_13-27-12", "timestamp": 1691317632, "time_this_iter_s": 61.25827980041504, "time_total_s": 39736.801860809326, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10256.030432462692, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 16.818390804597705, "ram_util_percent": 71.34712643678161}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9372785473704, "policy_loss": -2018104.6478851584, "vf_loss": 4323040.668276239}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 72373.5, "diff_num_grad_updates_vs_sampler_policy": 72372.5}}, "num_env_steps_sampled": 15879360, "num_env_steps_trained": 15879360, "num_agent_steps_sampled": 15879360, "num_agent_steps_trained": 15879360}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154799.7104300879, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2881980991274748, "mean_inference_ms": 0.3883902955047794, "mean_action_processing_ms": 0.08938227185219129, "mean_env_wait_ms": 0.7238049333522736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035135746002197266, "StateBufferConnector_ms": 0.0025768280029296875, "ViewRequirementAgentConnector_ms": 0.06643319129943848}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154799.7104300879, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154070.3063412413, -153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2881980991274748, "mean_inference_ms": 0.3883902955047794, "mean_action_processing_ms": 0.08938227185219129, "mean_env_wait_ms": 0.7238049333522736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035135746002197266, "StateBufferConnector_ms": 0.0025768280029296875, "ViewRequirementAgentConnector_ms": 0.06643319129943848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15879360, "num_agent_steps_trained": 15879360, "num_env_steps_sampled": 15879360, "num_env_steps_trained": 15879360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.6318609430883, "num_env_steps_trained_throughput_per_sec": 716.6318609430883, "timesteps_total": 15879360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15879360, "timers": {"training_iteration_time_ms": 61266.021, "sample_time_ms": 60131.156, "load_time_ms": 17.053, "load_throughput": 2575570.71, "learn_time_ms": 1116.758, "learn_throughput": 39328.134, "synch_weights_time_ms": 0.895}, "counters": {"num_env_steps_sampled": 15879360, "num_env_steps_trained": 15879360, "num_agent_steps_sampled": 15879360, "num_agent_steps_trained": 15879360}, "done": false, "episodes_total": 7814, "training_iteration": 1991, "trial_id": "e8087_00000", "date": "2023-08-06_13-28-13", "timestamp": 1691317693, "time_this_iter_s": 61.289531230926514, "time_total_s": 39798.09139204025, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10317.319963693619, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 17.910344827586208, "ram_util_percent": 71.32298850574713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.17199257719966, "policy_loss": -1971605.2725620102, "vf_loss": 4418623.894770408}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 73059.5, "diff_num_grad_updates_vs_sampler_policy": 73058.5}}, "num_env_steps_sampled": 15923280, "num_env_steps_trained": 15923280, "num_agent_steps_sampled": 15923280, "num_agent_steps_trained": 15923280}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154805.03471193646, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29227536896082174, "mean_inference_ms": 0.3902873756074161, "mean_action_processing_ms": 0.08938468715261755, "mean_env_wait_ms": 0.7258629835441621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003512859344482422, "StateBufferConnector_ms": 0.0025751590728759766, "ViewRequirementAgentConnector_ms": 0.06642341613769531}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154805.03471193646, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153859.98208106722, -156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29227536896082174, "mean_inference_ms": 0.3902873756074161, "mean_action_processing_ms": 0.08938468715261755, "mean_env_wait_ms": 0.7258629835441621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003512859344482422, "StateBufferConnector_ms": 0.0025751590728759766, "ViewRequirementAgentConnector_ms": 0.06642341613769531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15923280, "num_agent_steps_trained": 15923280, "num_env_steps_sampled": 15923280, "num_env_steps_trained": 15923280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.5634262629812, "num_env_steps_trained_throughput_per_sec": 713.5634262629812, "timesteps_total": 15923280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15923280, "timers": {"training_iteration_time_ms": 61328.65, "sample_time_ms": 60192.468, "load_time_ms": 17.034, "load_throughput": 2578411.438, "learn_time_ms": 1118.092, "learn_throughput": 39281.208, "synch_weights_time_ms": 0.895}, "counters": {"num_env_steps_sampled": 15923280, "num_env_steps_trained": 15923280, "num_agent_steps_sampled": 15923280, "num_agent_steps_trained": 15923280}, "done": false, "episodes_total": 7815, "training_iteration": 1992, "trial_id": "e8087_00000", "date": "2023-08-06_13-29-15", "timestamp": 1691317755, "time_this_iter_s": 61.55331778526306, "time_total_s": 39859.644709825516, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10378.873281478882, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 17.535632183908046, "ram_util_percent": 71.32528735632187}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.01583021514267, "policy_loss": -2230598.3731209002, "vf_loss": 4514133.119806851}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 73745.5, "diff_num_grad_updates_vs_sampler_policy": 73744.5}}, "num_env_steps_sampled": 15967200, "num_env_steps_trained": 15967200, "num_agent_steps_sampled": 15967200, "num_agent_steps_trained": 15967200}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154824.31208602723, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29631326756185955, "mean_inference_ms": 0.3921674067633253, "mean_action_processing_ms": 0.08938680480662864, "mean_env_wait_ms": 0.7279223074192928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035152435302734375, "StateBufferConnector_ms": 0.0025746822357177734, "ViewRequirementAgentConnector_ms": 0.06644797325134277}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154824.31208602723, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156271.95405323265, -157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29631326756185955, "mean_inference_ms": 0.3921674067633253, "mean_action_processing_ms": 0.08938680480662864, "mean_env_wait_ms": 0.7279223074192928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035152435302734375, "StateBufferConnector_ms": 0.0025746822357177734, "ViewRequirementAgentConnector_ms": 0.06644797325134277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15967200, "num_agent_steps_trained": 15967200, "num_env_steps_sampled": 15967200, "num_env_steps_trained": 15967200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.1461971483702, "num_env_steps_trained_throughput_per_sec": 715.1461971483702, "timesteps_total": 15967200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 15967200, "timers": {"training_iteration_time_ms": 61305.884, "sample_time_ms": 60175.303, "load_time_ms": 16.943, "load_throughput": 2592198.823, "learn_time_ms": 1112.59, "learn_throughput": 39475.455, "synch_weights_time_ms": 0.888}, "counters": {"num_env_steps_sampled": 15967200, "num_env_steps_trained": 15967200, "num_agent_steps_sampled": 15967200, "num_agent_steps_trained": 15967200}, "done": false, "episodes_total": 7816, "training_iteration": 1993, "trial_id": "e8087_00000", "date": "2023-08-06_13-30-16", "timestamp": 1691317816, "time_this_iter_s": 61.41699409484863, "time_total_s": 39921.061703920364, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10440.29027557373, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 17.388505747126437, "ram_util_percent": 71.38735632183906}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0816613022162, "policy_loss": -2084666.3552466745, "vf_loss": 4533798.375546647}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 74431.5, "diff_num_grad_updates_vs_sampler_policy": 74430.5}}, "num_env_steps_sampled": 16011120, "num_env_steps_trained": 16011120, "num_agent_steps_sampled": 16011120, "num_agent_steps_trained": 16011120}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154823.78973237926, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30031264046244355, "mean_inference_ms": 0.3940291668174873, "mean_action_processing_ms": 0.08938869718289222, "mean_env_wait_ms": 0.7299785856355292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519296646118164, "StateBufferConnector_ms": 0.002575397491455078, "ViewRequirementAgentConnector_ms": 0.06645464897155762}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154823.78973237926, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157640.5757364542, -156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30031264046244355, "mean_inference_ms": 0.3940291668174873, "mean_action_processing_ms": 0.08938869718289222, "mean_env_wait_ms": 0.7299785856355292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519296646118164, "StateBufferConnector_ms": 0.002575397491455078, "ViewRequirementAgentConnector_ms": 0.06645464897155762}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16011120, "num_agent_steps_trained": 16011120, "num_env_steps_sampled": 16011120, "num_env_steps_trained": 16011120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.9338246755002, "num_env_steps_trained_throughput_per_sec": 717.9338246755002, "timesteps_total": 16011120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16011120, "timers": {"training_iteration_time_ms": 61314.784, "sample_time_ms": 60184.887, "load_time_ms": 17.029, "load_throughput": 2579075.658, "learn_time_ms": 1111.823, "learn_throughput": 39502.676, "synch_weights_time_ms": 0.884}, "counters": {"num_env_steps_sampled": 16011120, "num_env_steps_trained": 16011120, "num_agent_steps_sampled": 16011120, "num_agent_steps_trained": 16011120}, "done": false, "episodes_total": 7817, "training_iteration": 1994, "trial_id": "e8087_00000", "date": "2023-08-06_13-31-17", "timestamp": 1691317877, "time_this_iter_s": 61.17844080924988, "time_total_s": 39982.240144729614, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10501.46871638298, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 17.07790697674419, "ram_util_percent": 71.39186046511627}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.04143188298616, "policy_loss": -2139934.645559061, "vf_loss": 4475153.5196793005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 75117.5, "diff_num_grad_updates_vs_sampler_policy": 75116.5}}, "num_env_steps_sampled": 16055040, "num_env_steps_trained": 16055040, "num_agent_steps_sampled": 16055040, "num_agent_steps_trained": 16055040}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154799.16378321068, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3042755524518445, "mean_inference_ms": 0.39587552303281237, "mean_action_processing_ms": 0.08939042940349026, "mean_env_wait_ms": 0.7320290918026047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035181045532226562, "StateBufferConnector_ms": 0.0025734901428222656, "ViewRequirementAgentConnector_ms": 0.06643795967102051}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154799.16378321068, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156628.48632530237, -153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3042755524518445, "mean_inference_ms": 0.39587552303281237, "mean_action_processing_ms": 0.08939042940349026, "mean_env_wait_ms": 0.7320290918026047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035181045532226562, "StateBufferConnector_ms": 0.0025734901428222656, "ViewRequirementAgentConnector_ms": 0.06643795967102051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16055040, "num_agent_steps_trained": 16055040, "num_env_steps_sampled": 16055040, "num_env_steps_trained": 16055040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.6905859934573, "num_env_steps_trained_throughput_per_sec": 712.6905859934573, "timesteps_total": 16055040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16055040, "timers": {"training_iteration_time_ms": 61370.57, "sample_time_ms": 60234.904, "load_time_ms": 16.943, "load_throughput": 2592198.823, "learn_time_ms": 1117.67, "learn_throughput": 39296.032, "synch_weights_time_ms": 0.888}, "counters": {"num_env_steps_sampled": 16055040, "num_env_steps_trained": 16055040, "num_agent_steps_sampled": 16055040, "num_agent_steps_trained": 16055040}, "done": false, "episodes_total": 7818, "training_iteration": 1995, "trial_id": "e8087_00000", "date": "2023-08-06_13-32-19", "timestamp": 1691317939, "time_this_iter_s": 61.628662109375, "time_total_s": 40043.86880683899, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10563.097378492355, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 17.38390804597701, "ram_util_percent": 71.36781609195404}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9375214868662, "policy_loss": -2328939.3311429485, "vf_loss": 4473132.9757653065}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 75803.5, "diff_num_grad_updates_vs_sampler_policy": 75802.5}}, "num_env_steps_sampled": 16098960, "num_env_steps_trained": 16098960, "num_agent_steps_sampled": 16098960, "num_agent_steps_trained": 16098960}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154789.19917330676, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3082030560898586, "mean_inference_ms": 0.39770623359326285, "mean_action_processing_ms": 0.08939205781716303, "mean_env_wait_ms": 0.7340528356928597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035169124603271484, "StateBufferConnector_ms": 0.0025730133056640625, "ViewRequirementAgentConnector_ms": 0.06643819808959961}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154789.19917330676, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153112.74054010294, -155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3082030560898586, "mean_inference_ms": 0.39770623359326285, "mean_action_processing_ms": 0.08939205781716303, "mean_env_wait_ms": 0.7340528356928597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035169124603271484, "StateBufferConnector_ms": 0.0025730133056640625, "ViewRequirementAgentConnector_ms": 0.06643819808959961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16098960, "num_agent_steps_trained": 16098960, "num_env_steps_sampled": 16098960, "num_env_steps_trained": 16098960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 708.2461321611236, "num_env_steps_trained_throughput_per_sec": 708.2461321611236, "timesteps_total": 16098960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16098960, "timers": {"training_iteration_time_ms": 61442.271, "sample_time_ms": 60306.406, "load_time_ms": 17.165, "load_throughput": 2558745.776, "learn_time_ms": 1117.64, "learn_throughput": 39297.075, "synch_weights_time_ms": 0.895}, "counters": {"num_env_steps_sampled": 16098960, "num_env_steps_trained": 16098960, "num_agent_steps_sampled": 16098960, "num_agent_steps_trained": 16098960}, "done": false, "episodes_total": 7819, "training_iteration": 1996, "trial_id": "e8087_00000", "date": "2023-08-06_13-33-21", "timestamp": 1691318001, "time_this_iter_s": 62.015636920928955, "time_total_s": 40105.88444375992, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10625.113015413284, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 17.27840909090909, "ram_util_percent": 71.39545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9822778284724, "policy_loss": -2219605.5794403697, "vf_loss": 4505180.566508747}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 76489.5, "diff_num_grad_updates_vs_sampler_policy": 76488.5}}, "num_env_steps_sampled": 16142880, "num_env_steps_trained": 16142880, "num_agent_steps_sampled": 16142880, "num_agent_steps_trained": 16142880}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154811.64662271747, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3120936720719676, "mean_inference_ms": 0.3995202740778913, "mean_action_processing_ms": 0.08939349935642886, "mean_env_wait_ms": 0.7360650891700218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035200119018554688, "StateBufferConnector_ms": 0.002575397491455078, "ViewRequirementAgentConnector_ms": 0.06646108627319336}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154811.64662271747, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155959.00368400363, -152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3120936720719676, "mean_inference_ms": 0.3995202740778913, "mean_action_processing_ms": 0.08939349935642886, "mean_env_wait_ms": 0.7360650891700218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035200119018554688, "StateBufferConnector_ms": 0.002575397491455078, "ViewRequirementAgentConnector_ms": 0.06646108627319336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16142880, "num_agent_steps_trained": 16142880, "num_env_steps_sampled": 16142880, "num_env_steps_trained": 16142880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.6323920174557, "num_env_steps_trained_throughput_per_sec": 717.6323920174557, "timesteps_total": 16142880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16142880, "timers": {"training_iteration_time_ms": 61389.158, "sample_time_ms": 60253.026, "load_time_ms": 17.154, "load_throughput": 2560278.52, "learn_time_ms": 1117.926, "learn_throughput": 39287.028, "synch_weights_time_ms": 0.887}, "counters": {"num_env_steps_sampled": 16142880, "num_env_steps_trained": 16142880, "num_agent_steps_sampled": 16142880, "num_agent_steps_trained": 16142880}, "done": false, "episodes_total": 7820, "training_iteration": 1997, "trial_id": "e8087_00000", "date": "2023-08-06_13-34-22", "timestamp": 1691318062, "time_this_iter_s": 61.20413684844971, "time_total_s": 40167.08858060837, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10686.317152261734, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 17.398850574712643, "ram_util_percent": 71.27011494252874}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.8901691937238, "policy_loss": -2223947.637179984, "vf_loss": 4286285.272776968}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 77175.5, "diff_num_grad_updates_vs_sampler_policy": 77174.5}}, "num_env_steps_sampled": 16186800, "num_env_steps_trained": 16186800, "num_agent_steps_sampled": 16186800, "num_agent_steps_trained": 16186800}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154782.06367363437, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31595173617964956, "mean_inference_ms": 0.4013185918031466, "mean_action_processing_ms": 0.08939506315616916, "mean_env_wait_ms": 0.7380683196100434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003522157669067383, "StateBufferConnector_ms": 0.0025777816772460938, "ViewRequirementAgentConnector_ms": 0.06647682189941406}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154782.06367363437, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152067.5220349097, -155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31595173617964956, "mean_inference_ms": 0.4013185918031466, "mean_action_processing_ms": 0.08939506315616916, "mean_env_wait_ms": 0.7380683196100434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003522157669067383, "StateBufferConnector_ms": 0.0025777816772460938, "ViewRequirementAgentConnector_ms": 0.06647682189941406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16186800, "num_agent_steps_trained": 16186800, "num_env_steps_sampled": 16186800, "num_env_steps_trained": 16186800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.8266172133704, "num_env_steps_trained_throughput_per_sec": 712.8266172133704, "timesteps_total": 16186800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16186800, "timers": {"training_iteration_time_ms": 61422.63, "sample_time_ms": 60286.509, "load_time_ms": 17.069, "load_throughput": 2573081.217, "learn_time_ms": 1117.999, "learn_throughput": 39284.466, "synch_weights_time_ms": 0.887}, "counters": {"num_env_steps_sampled": 16186800, "num_env_steps_trained": 16186800, "num_agent_steps_sampled": 16186800, "num_agent_steps_trained": 16186800}, "done": false, "episodes_total": 7821, "training_iteration": 1998, "trial_id": "e8087_00000", "date": "2023-08-06_13-35-24", "timestamp": 1691318124, "time_this_iter_s": 61.617148876190186, "time_total_s": 40228.70572948456, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10747.934301137924, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 17.820689655172416, "ram_util_percent": 71.2919540229885}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0915215495029, "policy_loss": -2069718.905048515, "vf_loss": 4427133.503097667}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 77861.5, "diff_num_grad_updates_vs_sampler_policy": 77860.5}}, "num_env_steps_sampled": 16230720, "num_env_steps_trained": 16230720, "num_agent_steps_sampled": 16230720, "num_agent_steps_trained": 16230720}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154808.55239795393, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3197770905456728, "mean_inference_ms": 0.4031014653081693, "mean_action_processing_ms": 0.089396763788286, "mean_env_wait_ms": 0.7400521370684789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003518819808959961, "StateBufferConnector_ms": 0.0025756359100341797, "ViewRequirementAgentConnector_ms": 0.06645035743713379}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154808.55239795393, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155280.42477858113, -151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3197770905456728, "mean_inference_ms": 0.4031014653081693, "mean_action_processing_ms": 0.089396763788286, "mean_env_wait_ms": 0.7400521370684789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003518819808959961, "StateBufferConnector_ms": 0.0025756359100341797, "ViewRequirementAgentConnector_ms": 0.06645035743713379}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16230720, "num_agent_steps_trained": 16230720, "num_env_steps_sampled": 16230720, "num_env_steps_trained": 16230720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.929795758717, "num_env_steps_trained_throughput_per_sec": 718.929795758717, "timesteps_total": 16230720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16230720, "timers": {"training_iteration_time_ms": 61422.551, "sample_time_ms": 60286.52, "load_time_ms": 17.13, "load_throughput": 2563977.453, "learn_time_ms": 1117.849, "learn_throughput": 39289.748, "synch_weights_time_ms": 0.887}, "counters": {"num_env_steps_sampled": 16230720, "num_env_steps_trained": 16230720, "num_agent_steps_sampled": 16230720, "num_agent_steps_trained": 16230720}, "done": false, "episodes_total": 7822, "training_iteration": 1999, "trial_id": "e8087_00000", "date": "2023-08-06_13-36-25", "timestamp": 1691318185, "time_this_iter_s": 61.09365200996399, "time_total_s": 40289.79938149452, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10809.027953147888, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 17.052873563218387, "ram_util_percent": 71.27126436781612}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9422154551692, "policy_loss": -1926854.0695508951, "vf_loss": 4318436.146683673}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 78547.5, "diff_num_grad_updates_vs_sampler_policy": 78546.5}}, "num_env_steps_sampled": 16274640, "num_env_steps_trained": 16274640, "num_agent_steps_sampled": 16274640, "num_agent_steps_trained": 16274640}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154790.18089244378, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32357035436858467, "mean_inference_ms": 0.4048692001538224, "mean_action_processing_ms": 0.08939857349422545, "mean_env_wait_ms": 0.7420185684609598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003518342971801758, "StateBufferConnector_ms": 0.0025756359100341797, "ViewRequirementAgentConnector_ms": 0.06646156311035156}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154790.18089244378, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-151935.40643110286, -153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32357035436858467, "mean_inference_ms": 0.4048692001538224, "mean_action_processing_ms": 0.08939857349422545, "mean_env_wait_ms": 0.7420185684609598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003518342971801758, "StateBufferConnector_ms": 0.0025756359100341797, "ViewRequirementAgentConnector_ms": 0.06646156311035156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16274640, "num_agent_steps_trained": 16274640, "num_env_steps_sampled": 16274640, "num_env_steps_trained": 16274640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.6811546670145, "num_env_steps_trained_throughput_per_sec": 714.6811546670145, "timesteps_total": 16274640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16274640, "timers": {"training_iteration_time_ms": 61442.415, "sample_time_ms": 60305.506, "load_time_ms": 17.127, "load_throughput": 2564320.091, "learn_time_ms": 1118.71, "learn_throughput": 39259.5, "synch_weights_time_ms": 0.905}, "counters": {"num_env_steps_sampled": 16274640, "num_env_steps_trained": 16274640, "num_agent_steps_sampled": 16274640, "num_agent_steps_trained": 16274640}, "done": false, "episodes_total": 7823, "training_iteration": 2000, "trial_id": "e8087_00000", "date": "2023-08-06_13-37-27", "timestamp": 1691318247, "time_this_iter_s": 61.457112073898315, "time_total_s": 40351.25649356842, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10870.485065221786, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 17.316091954022987, "ram_util_percent": 71.21264367816094}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.139384189083, "policy_loss": -2002179.1282542592, "vf_loss": 4606830.144132653}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 79233.5, "diff_num_grad_updates_vs_sampler_policy": 79232.5}}, "num_env_steps_sampled": 16318560, "num_env_steps_trained": 16318560, "num_agent_steps_sampled": 16318560, "num_agent_steps_trained": 16318560}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154842.1909406864, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32733015834124024, "mean_inference_ms": 0.4066221274065542, "mean_action_processing_ms": 0.08940041068106451, "mean_env_wait_ms": 0.7439734311729618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035181045532226562, "StateBufferConnector_ms": 0.0025758743286132812, "ViewRequirementAgentConnector_ms": 0.06645941734313965}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154842.1909406864, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153659.49085866238, -156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32733015834124024, "mean_inference_ms": 0.4066221274065542, "mean_action_processing_ms": 0.08940041068106451, "mean_env_wait_ms": 0.7439734311729618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035181045532226562, "StateBufferConnector_ms": 0.0025758743286132812, "ViewRequirementAgentConnector_ms": 0.06645941734313965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16318560, "num_agent_steps_trained": 16318560, "num_env_steps_sampled": 16318560, "num_env_steps_trained": 16318560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 721.2705229419279, "num_env_steps_trained_throughput_per_sec": 721.2705229419279, "timesteps_total": 16318560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16318560, "timers": {"training_iteration_time_ms": 61403.0, "sample_time_ms": 60267.707, "load_time_ms": 17.121, "load_throughput": 2565234.24, "learn_time_ms": 1117.094, "learn_throughput": 39316.29, "synch_weights_time_ms": 0.913}, "counters": {"num_env_steps_sampled": 16318560, "num_env_steps_trained": 16318560, "num_agent_steps_sampled": 16318560, "num_agent_steps_trained": 16318560}, "done": false, "episodes_total": 7824, "training_iteration": 2001, "trial_id": "e8087_00000", "date": "2023-08-06_13-38-28", "timestamp": 1691318308, "time_this_iter_s": 60.89552593231201, "time_total_s": 40412.15201950073, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10931.380591154099, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 17.482558139534888, "ram_util_percent": 71.15930232558141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.018853457259, "policy_loss": -2154202.809863566, "vf_loss": 4419859.983053936}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 79919.5, "diff_num_grad_updates_vs_sampler_policy": 79918.5}}, "num_env_steps_sampled": 16362480, "num_env_steps_trained": 16362480, "num_agent_steps_sampled": 16362480, "num_agent_steps_trained": 16362480}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154854.03606983385, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33105750348931734, "mean_inference_ms": 0.4083602103218675, "mean_action_processing_ms": 0.08940219206782735, "mean_env_wait_ms": 0.7459160479880619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519773483276367, "StateBufferConnector_ms": 0.002576112747192383, "ViewRequirementAgentConnector_ms": 0.06646728515625}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154854.03606983385, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156603.94320883768, -154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33105750348931734, "mean_inference_ms": 0.4083602103218675, "mean_action_processing_ms": 0.08940219206782735, "mean_env_wait_ms": 0.7459160479880619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519773483276367, "StateBufferConnector_ms": 0.002576112747192383, "ViewRequirementAgentConnector_ms": 0.06646728515625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16362480, "num_agent_steps_trained": 16362480, "num_env_steps_sampled": 16362480, "num_env_steps_trained": 16362480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.0758841477357, "num_env_steps_trained_throughput_per_sec": 717.0758841477357, "timesteps_total": 16362480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16362480, "timers": {"training_iteration_time_ms": 61372.851, "sample_time_ms": 60238.898, "load_time_ms": 17.123, "load_throughput": 2565037.786, "learn_time_ms": 1115.757, "learn_throughput": 39363.398, "synch_weights_time_ms": 0.909}, "counters": {"num_env_steps_sampled": 16362480, "num_env_steps_trained": 16362480, "num_agent_steps_sampled": 16362480, "num_agent_steps_trained": 16362480}, "done": false, "episodes_total": 7825, "training_iteration": 2002, "trial_id": "e8087_00000", "date": "2023-08-06_13-39-29", "timestamp": 1691318369, "time_this_iter_s": 61.2518630027771, "time_total_s": 40473.40388250351, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10992.632454156876, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 17.609302325581393, "ram_util_percent": 71.18604651162791}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.06010761761456, "policy_loss": -1942855.2532400237, "vf_loss": 4438476.987427114}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 80605.5, "diff_num_grad_updates_vs_sampler_policy": 80604.5}}, "num_env_steps_sampled": 16406400, "num_env_steps_trained": 16406400, "num_agent_steps_sampled": 16406400, "num_agent_steps_trained": 16406400}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154833.5822462363, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33475211371874297, "mean_inference_ms": 0.4100839958937621, "mean_action_processing_ms": 0.08940399833502793, "mean_env_wait_ms": 0.7478448034917983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035276412963867188, "StateBufferConnector_ms": 0.002577543258666992, "ViewRequirementAgentConnector_ms": 0.06645488739013672}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154833.5822462363, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154283.6987694579, -154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33475211371874297, "mean_inference_ms": 0.4100839958937621, "mean_action_processing_ms": 0.08940399833502793, "mean_env_wait_ms": 0.7478448034917983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035276412963867188, "StateBufferConnector_ms": 0.002577543258666992, "ViewRequirementAgentConnector_ms": 0.06645488739013672}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16406400, "num_agent_steps_trained": 16406400, "num_env_steps_sampled": 16406400, "num_env_steps_trained": 16406400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 722.8757908337403, "num_env_steps_trained_throughput_per_sec": 722.8757908337403, "timesteps_total": 16406400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16406400, "timers": {"training_iteration_time_ms": 61307.182, "sample_time_ms": 60173.067, "load_time_ms": 17.065, "load_throughput": 2573663.586, "learn_time_ms": 1115.974, "learn_throughput": 39355.767, "synch_weights_time_ms": 0.913}, "counters": {"num_env_steps_sampled": 16406400, "num_env_steps_trained": 16406400, "num_agent_steps_sampled": 16406400, "num_agent_steps_trained": 16406400}, "done": false, "episodes_total": 7826, "training_iteration": 2003, "trial_id": "e8087_00000", "date": "2023-08-06_13-40-30", "timestamp": 1691318430, "time_this_iter_s": 60.76035714149475, "time_total_s": 40534.164239645004, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11053.39281129837, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 20.988372093023255, "ram_util_percent": 70.98023255813953}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1230927403397, "policy_loss": -1796900.6705026876, "vf_loss": 4353237.207361516}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 81291.5, "diff_num_grad_updates_vs_sampler_policy": 81290.5}}, "num_env_steps_sampled": 16450320, "num_env_steps_trained": 16450320, "num_agent_steps_sampled": 16450320, "num_agent_steps_trained": 16450320}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154825.4736090849, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3384149358159755, "mean_inference_ms": 0.41179318706883195, "mean_action_processing_ms": 0.08940587878279863, "mean_env_wait_ms": 0.7497609175237302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035262107849121094, "StateBufferConnector_ms": 0.002580404281616211, "ViewRequirementAgentConnector_ms": 0.06645369529724121}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154825.4736090849, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154211.48728079372, -154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3384149358159755, "mean_inference_ms": 0.41179318706883195, "mean_action_processing_ms": 0.08940587878279863, "mean_env_wait_ms": 0.7497609175237302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035262107849121094, "StateBufferConnector_ms": 0.002580404281616211, "ViewRequirementAgentConnector_ms": 0.06645369529724121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16450320, "num_agent_steps_trained": 16450320, "num_env_steps_sampled": 16450320, "num_env_steps_trained": 16450320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.7308876771447, "num_env_steps_trained_throughput_per_sec": 717.7308876771447, "timesteps_total": 16450320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16450320, "timers": {"training_iteration_time_ms": 61308.912, "sample_time_ms": 60175.267, "load_time_ms": 16.993, "load_throughput": 2584666.469, "learn_time_ms": 1115.573, "learn_throughput": 39369.899, "synch_weights_time_ms": 0.916}, "counters": {"num_env_steps_sampled": 16450320, "num_env_steps_trained": 16450320, "num_agent_steps_sampled": 16450320, "num_agent_steps_trained": 16450320}, "done": false, "episodes_total": 7827, "training_iteration": 2004, "trial_id": "e8087_00000", "date": "2023-08-06_13-41-31", "timestamp": 1691318491, "time_this_iter_s": 61.195821046829224, "time_total_s": 40595.36006069183, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11114.5886323452, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 17.024137931034485, "ram_util_percent": 71.16206896551725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.97774187538437, "policy_loss": -1900125.3804807079, "vf_loss": 4553389.28380102}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 81977.5, "diff_num_grad_updates_vs_sampler_policy": 81976.5}}, "num_env_steps_sampled": 16494240, "num_env_steps_trained": 16494240, "num_agent_steps_sampled": 16494240, "num_agent_steps_trained": 16494240}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154844.95856908776, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.342048902775105, "mean_inference_ms": 0.4134874653744246, "mean_action_processing_ms": 0.08940759471902898, "mean_env_wait_ms": 0.7516613900807064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035283565521240234, "StateBufferConnector_ms": 0.0025794506072998047, "ViewRequirementAgentConnector_ms": 0.06643176078796387}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154844.95856908776, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154076.57016882804, -154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.342048902775105, "mean_inference_ms": 0.4134874653744246, "mean_action_processing_ms": 0.08940759471902898, "mean_env_wait_ms": 0.7516613900807064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035283565521240234, "StateBufferConnector_ms": 0.0025794506072998047, "ViewRequirementAgentConnector_ms": 0.06643176078796387}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16494240, "num_agent_steps_trained": 16494240, "num_env_steps_sampled": 16494240, "num_env_steps_trained": 16494240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.7224454109523, "num_env_steps_trained_throughput_per_sec": 717.7224454109523, "timesteps_total": 16494240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16494240, "timers": {"training_iteration_time_ms": 61265.707, "sample_time_ms": 60132.116, "load_time_ms": 17.058, "load_throughput": 2574681.567, "learn_time_ms": 1115.453, "learn_throughput": 39374.127, "synch_weights_time_ms": 0.915}, "counters": {"num_env_steps_sampled": 16494240, "num_env_steps_trained": 16494240, "num_agent_steps_sampled": 16494240, "num_agent_steps_trained": 16494240}, "done": false, "episodes_total": 7828, "training_iteration": 2005, "trial_id": "e8087_00000", "date": "2023-08-06_13-42-32", "timestamp": 1691318552, "time_this_iter_s": 61.19654893875122, "time_total_s": 40656.556609630585, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11175.78518128395, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 17.587356321839078, "ram_util_percent": 71.21034482758621}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.08797412572034, "policy_loss": -2437958.4599965266, "vf_loss": 4728832.940142129}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 82663.5, "diff_num_grad_updates_vs_sampler_policy": 82662.5}}, "num_env_steps_sampled": 16538160, "num_env_steps_trained": 16538160, "num_agent_steps_sampled": 16538160, "num_agent_steps_trained": 16538160}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154894.22756026092, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3456519798435677, "mean_inference_ms": 0.4151680978933274, "mean_action_processing_ms": 0.08940927510147624, "mean_env_wait_ms": 0.7535434079728479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035228729248046875, "StateBufferConnector_ms": 0.0025780200958251953, "ViewRequirementAgentConnector_ms": 0.06636834144592285}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154894.22756026092, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154259.03854921533, -154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3456519798435677, "mean_inference_ms": 0.4151680978933274, "mean_action_processing_ms": 0.08940927510147624, "mean_env_wait_ms": 0.7535434079728479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035228729248046875, "StateBufferConnector_ms": 0.0025780200958251953, "ViewRequirementAgentConnector_ms": 0.06636834144592285}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16538160, "num_agent_steps_trained": 16538160, "num_env_steps_sampled": 16538160, "num_env_steps_trained": 16538160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.7824260552949, "num_env_steps_trained_throughput_per_sec": 712.7824260552949, "timesteps_total": 16538160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16538160, "timers": {"training_iteration_time_ms": 61226.241, "sample_time_ms": 60093.608, "load_time_ms": 17.132, "load_throughput": 2563638.475, "learn_time_ms": 1114.429, "learn_throughput": 39410.31, "synch_weights_time_ms": 0.908}, "counters": {"num_env_steps_sampled": 16538160, "num_env_steps_trained": 16538160, "num_agent_steps_sampled": 16538160, "num_agent_steps_trained": 16538160}, "done": false, "episodes_total": 7829, "training_iteration": 2006, "trial_id": "e8087_00000", "date": "2023-08-06_13-43-34", "timestamp": 1691318614, "time_this_iter_s": 61.620583295822144, "time_total_s": 40718.17719292641, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11237.405764579773, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 17.768965517241377, "ram_util_percent": 71.1367816091954}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9253502225737, "policy_loss": -2110814.463502756, "vf_loss": 4129522.572248542}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 83349.5, "diff_num_grad_updates_vs_sampler_policy": 83348.5}}, "num_env_steps_sampled": 16582080, "num_env_steps_trained": 16582080, "num_agent_steps_sampled": 16582080, "num_agent_steps_trained": 16582080}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154856.0946865512, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34922511794874433, "mean_inference_ms": 0.41683511368878096, "mean_action_processing_ms": 0.08941089167659685, "mean_env_wait_ms": 0.7554172729516124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035240650177001953, "StateBufferConnector_ms": 0.0025777816772460938, "ViewRequirementAgentConnector_ms": 0.06635260581970215}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154856.0946865512, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154889.6318215341, -157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34922511794874433, "mean_inference_ms": 0.41683511368878096, "mean_action_processing_ms": 0.08941089167659685, "mean_env_wait_ms": 0.7554172729516124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035240650177001953, "StateBufferConnector_ms": 0.0025777816772460938, "ViewRequirementAgentConnector_ms": 0.06635260581970215}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16582080, "num_agent_steps_trained": 16582080, "num_env_steps_sampled": 16582080, "num_env_steps_trained": 16582080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.3553600570924, "num_env_steps_trained_throughput_per_sec": 712.3553600570924, "timesteps_total": 16582080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16582080, "timers": {"training_iteration_time_ms": 61271.578, "sample_time_ms": 60139.038, "load_time_ms": 17.15, "load_throughput": 2560979.712, "learn_time_ms": 1114.32, "learn_throughput": 39414.165, "synch_weights_time_ms": 0.907}, "counters": {"num_env_steps_sampled": 16582080, "num_env_steps_trained": 16582080, "num_agent_steps_sampled": 16582080, "num_agent_steps_trained": 16582080}, "done": false, "episodes_total": 7830, "training_iteration": 2007, "trial_id": "e8087_00000", "date": "2023-08-06_13-44-35", "timestamp": 1691318675, "time_this_iter_s": 61.658052921295166, "time_total_s": 40779.8352458477, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11299.063817501068, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 16.945977011494254, "ram_util_percent": 71.10459770114942}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.88167796677124, "policy_loss": -2322742.379495604, "vf_loss": 4350218.260204081}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 84035.5, "diff_num_grad_updates_vs_sampler_policy": 84034.5}}, "num_env_steps_sampled": 16626000, "num_env_steps_trained": 16626000, "num_agent_steps_sampled": 16626000, "num_agent_steps_trained": 16626000}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154847.09441003806, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.352768753471743, "mean_inference_ms": 0.4184887629639891, "mean_action_processing_ms": 0.08941250835800701, "mean_env_wait_ms": 0.7572772679896487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003524303436279297, "StateBufferConnector_ms": 0.0025751590728759766, "ViewRequirementAgentConnector_ms": 0.06635522842407227}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154847.09441003806, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157956.6126890624, -154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.352768753471743, "mean_inference_ms": 0.4184887629639891, "mean_action_processing_ms": 0.08941250835800701, "mean_env_wait_ms": 0.7572772679896487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003524303436279297, "StateBufferConnector_ms": 0.0025751590728759766, "ViewRequirementAgentConnector_ms": 0.06635522842407227}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16626000, "num_agent_steps_trained": 16626000, "num_env_steps_sampled": 16626000, "num_env_steps_trained": 16626000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.6057365442686, "num_env_steps_trained_throughput_per_sec": 717.6057365442686, "timesteps_total": 16626000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16626000, "timers": {"training_iteration_time_ms": 61230.544, "sample_time_ms": 60098.524, "load_time_ms": 17.311, "load_throughput": 2537139.469, "learn_time_ms": 1113.633, "learn_throughput": 39438.491, "synch_weights_time_ms": 0.913}, "counters": {"num_env_steps_sampled": 16626000, "num_env_steps_trained": 16626000, "num_agent_steps_sampled": 16626000, "num_agent_steps_trained": 16626000}, "done": false, "episodes_total": 7831, "training_iteration": 2008, "trial_id": "e8087_00000", "date": "2023-08-06_13-45-37", "timestamp": 1691318737, "time_this_iter_s": 61.20674419403076, "time_total_s": 40841.04199004173, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11360.270561695099, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 17.30574712643678, "ram_util_percent": 71.08965517241379}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.05455057127483, "policy_loss": -1920951.8584696155, "vf_loss": 4524940.0924744895}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 84721.5, "diff_num_grad_updates_vs_sampler_policy": 84720.5}}, "num_env_steps_sampled": 16669920, "num_env_steps_trained": 16669920, "num_agent_steps_sampled": 16669920, "num_agent_steps_trained": 16669920}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154829.8305107662, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3562835037892009, "mean_inference_ms": 0.4201296812634544, "mean_action_processing_ms": 0.08941413016831018, "mean_env_wait_ms": 0.7591221402899013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035207271575927734, "StateBufferConnector_ms": 0.002569437026977539, "ViewRequirementAgentConnector_ms": 0.0663456916809082}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154829.8305107662, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154282.86646872349, -152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3562835037892009, "mean_inference_ms": 0.4201296812634544, "mean_action_processing_ms": 0.08941413016831018, "mean_env_wait_ms": 0.7591221402899013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035207271575927734, "StateBufferConnector_ms": 0.002569437026977539, "ViewRequirementAgentConnector_ms": 0.0663456916809082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16669920, "num_agent_steps_trained": 16669920, "num_env_steps_sampled": 16669920, "num_env_steps_trained": 16669920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.1636772021972, "num_env_steps_trained_throughput_per_sec": 715.1636772021972, "timesteps_total": 16669920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16669920, "timers": {"training_iteration_time_ms": 61262.715, "sample_time_ms": 60132.178, "load_time_ms": 17.192, "load_throughput": 2554689.857, "learn_time_ms": 1112.267, "learn_throughput": 39486.912, "synch_weights_time_ms": 0.915}, "counters": {"num_env_steps_sampled": 16669920, "num_env_steps_trained": 16669920, "num_agent_steps_sampled": 16669920, "num_agent_steps_trained": 16669920}, "done": false, "episodes_total": 7832, "training_iteration": 2009, "trial_id": "e8087_00000", "date": "2023-08-06_13-46-38", "timestamp": 1691318798, "time_this_iter_s": 61.41554021835327, "time_total_s": 40902.457530260086, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11421.686101913452, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 17.53333333333333, "ram_util_percent": 71.06321839080458}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1309277059038, "policy_loss": -2044902.4551436089, "vf_loss": 4402745.141672741}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 85407.5, "diff_num_grad_updates_vs_sampler_policy": 85406.5}}, "num_env_steps_sampled": 16713840, "num_env_steps_trained": 16713840, "num_agent_steps_sampled": 16713840, "num_agent_steps_trained": 16713840}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154830.64612695284, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35977089605166523, "mean_inference_ms": 0.42175774398578425, "mean_action_processing_ms": 0.08941580321607724, "mean_env_wait_ms": 0.7609571621318778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035254955291748047, "StateBufferConnector_ms": 0.002568960189819336, "ViewRequirementAgentConnector_ms": 0.06637954711914062}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154830.64612695284, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152960.00439065052, -158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35977089605166523, "mean_inference_ms": 0.42175774398578425, "mean_action_processing_ms": 0.08941580321607724, "mean_env_wait_ms": 0.7609571621318778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035254955291748047, "StateBufferConnector_ms": 0.002568960189819336, "ViewRequirementAgentConnector_ms": 0.06637954711914062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16713840, "num_agent_steps_trained": 16713840, "num_env_steps_sampled": 16713840, "num_env_steps_trained": 16713840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.0210279470775, "num_env_steps_trained_throughput_per_sec": 717.0210279470775, "timesteps_total": 16713840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16713840, "timers": {"training_iteration_time_ms": 61242.661, "sample_time_ms": 60112.951, "load_time_ms": 17.237, "load_throughput": 2548021.927, "learn_time_ms": 1111.41, "learn_throughput": 39517.352, "synch_weights_time_ms": 0.899}, "counters": {"num_env_steps_sampled": 16713840, "num_env_steps_trained": 16713840, "num_agent_steps_sampled": 16713840, "num_agent_steps_trained": 16713840}, "done": false, "episodes_total": 7833, "training_iteration": 2010, "trial_id": "e8087_00000", "date": "2023-08-06_13-47-39", "timestamp": 1691318859, "time_this_iter_s": 61.25645112991333, "time_total_s": 40963.71398139, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11482.942553043365, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 16.915116279069764, "ram_util_percent": 71.07906976744185}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.2506665377158, "policy_loss": -1973865.0718442511, "vf_loss": 4480898.846392129}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 86093.5, "diff_num_grad_updates_vs_sampler_policy": 86092.5}}, "num_env_steps_sampled": 16757760, "num_env_steps_trained": 16757760, "num_agent_steps_sampled": 16757760, "num_agent_steps_trained": 16757760}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154854.83189601812, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3632294860994203, "mean_inference_ms": 0.42337323182942493, "mean_action_processing_ms": 0.08941746821217272, "mean_env_wait_ms": 0.762774768570846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003523588180541992, "StateBufferConnector_ms": 0.0025641918182373047, "ViewRequirementAgentConnector_ms": 0.06630373001098633}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154854.83189601812, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-158147.60830948554, -158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3632294860994203, "mean_inference_ms": 0.42337323182942493, "mean_action_processing_ms": 0.08941746821217272, "mean_env_wait_ms": 0.762774768570846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003523588180541992, "StateBufferConnector_ms": 0.0025641918182373047, "ViewRequirementAgentConnector_ms": 0.06630373001098633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16757760, "num_agent_steps_trained": 16757760, "num_env_steps_sampled": 16757760, "num_env_steps_trained": 16757760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.1689121016823, "num_env_steps_trained_throughput_per_sec": 719.1689121016823, "timesteps_total": 16757760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16757760, "timers": {"training_iteration_time_ms": 61260.455, "sample_time_ms": 60131.523, "load_time_ms": 17.226, "load_throughput": 2549591.247, "learn_time_ms": 1110.626, "learn_throughput": 39545.255, "synch_weights_time_ms": 0.909}, "counters": {"num_env_steps_sampled": 16757760, "num_env_steps_trained": 16757760, "num_agent_steps_sampled": 16757760, "num_agent_steps_trained": 16757760}, "done": false, "episodes_total": 7834, "training_iteration": 2011, "trial_id": "e8087_00000", "date": "2023-08-06_13-48-40", "timestamp": 1691318920, "time_this_iter_s": 61.074403047561646, "time_total_s": 41024.78838443756, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11544.016956090927, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 17.30689655172414, "ram_util_percent": 71.08620689655172}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9927324567522, "policy_loss": -2231611.1635158528, "vf_loss": 4460384.23414723}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 86779.5, "diff_num_grad_updates_vs_sampler_policy": 86778.5}}, "num_env_steps_sampled": 16801680, "num_env_steps_trained": 16801680, "num_agent_steps_sampled": 16801680, "num_agent_steps_trained": 16801680}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154830.37273867935, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3666607256246297, "mean_inference_ms": 0.42497619851413726, "mean_action_processing_ms": 0.08941911038284919, "mean_env_wait_ms": 0.7645797398164311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035207271575927734, "StateBufferConnector_ms": 0.0025625228881835938, "ViewRequirementAgentConnector_ms": 0.06630349159240723}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154830.37273867935, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-158762.7047080434, -156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3666607256246297, "mean_inference_ms": 0.42497619851413726, "mean_action_processing_ms": 0.08941911038284919, "mean_env_wait_ms": 0.7645797398164311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035207271575927734, "StateBufferConnector_ms": 0.0025625228881835938, "ViewRequirementAgentConnector_ms": 0.06630349159240723}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16801680, "num_agent_steps_trained": 16801680, "num_env_steps_sampled": 16801680, "num_env_steps_trained": 16801680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.3879705277718, "num_env_steps_trained_throughput_per_sec": 716.3879705277718, "timesteps_total": 16801680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16801680, "timers": {"training_iteration_time_ms": 61266.336, "sample_time_ms": 60137.13, "load_time_ms": 17.262, "load_throughput": 2544337.226, "learn_time_ms": 1110.863, "learn_throughput": 39536.826, "synch_weights_time_ms": 0.91}, "counters": {"num_env_steps_sampled": 16801680, "num_env_steps_trained": 16801680, "num_agent_steps_sampled": 16801680, "num_agent_steps_trained": 16801680}, "done": false, "episodes_total": 7835, "training_iteration": 2012, "trial_id": "e8087_00000", "date": "2023-08-06_13-49-42", "timestamp": 1691318982, "time_this_iter_s": 61.31042695045471, "time_total_s": 41086.098811388016, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11605.327383041382, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 17.522988505747122, "ram_util_percent": 71.09310344827587}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0887549486522, "policy_loss": -1970459.2656620126, "vf_loss": 4466520.007926385}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 87465.5, "diff_num_grad_updates_vs_sampler_policy": 87464.5}}, "num_env_steps_sampled": 16845600, "num_env_steps_trained": 16845600, "num_agent_steps_sampled": 16845600, "num_agent_steps_trained": 16845600}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154795.78137412225, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3700655382942681, "mean_inference_ms": 0.4265668323104036, "mean_action_processing_ms": 0.08942074471248665, "mean_env_wait_ms": 0.7663744247556622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035223960876464844, "StateBufferConnector_ms": 0.0025610923767089844, "ViewRequirementAgentConnector_ms": 0.06629562377929688}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154795.78137412225, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156365.5607065109, -152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3700655382942681, "mean_inference_ms": 0.4265668323104036, "mean_action_processing_ms": 0.08942074471248665, "mean_env_wait_ms": 0.7663744247556622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035223960876464844, "StateBufferConnector_ms": 0.0025610923767089844, "ViewRequirementAgentConnector_ms": 0.06629562377929688}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16845600, "num_agent_steps_trained": 16845600, "num_env_steps_sampled": 16845600, "num_env_steps_trained": 16845600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.8865417112555, "num_env_steps_trained_throughput_per_sec": 717.8865417112555, "timesteps_total": 16845600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16845600, "timers": {"training_iteration_time_ms": 61308.562, "sample_time_ms": 60181.231, "load_time_ms": 17.266, "load_throughput": 2543676.727, "learn_time_ms": 1108.981, "learn_throughput": 39603.921, "synch_weights_time_ms": 0.912}, "counters": {"num_env_steps_sampled": 16845600, "num_env_steps_trained": 16845600, "num_agent_steps_sampled": 16845600, "num_agent_steps_trained": 16845600}, "done": false, "episodes_total": 7836, "training_iteration": 2013, "trial_id": "e8087_00000", "date": "2023-08-06_13-50-43", "timestamp": 1691319043, "time_this_iter_s": 61.18247890472412, "time_total_s": 41147.28129029274, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11666.509861946106, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 17.38372093023256, "ram_util_percent": 71.05232558139535}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.170753990596, "policy_loss": -1944181.2334112495, "vf_loss": 4403955.943148688}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 88151.5, "diff_num_grad_updates_vs_sampler_policy": 88150.5}}, "num_env_steps_sampled": 16889520, "num_env_steps_trained": 16889520, "num_agent_steps_sampled": 16889520, "num_agent_steps_trained": 16889520}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154777.65398576873, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37344371538499355, "mean_inference_ms": 0.4281449201727178, "mean_action_processing_ms": 0.08942247832393319, "mean_env_wait_ms": 0.7681546437306913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035240650177001953, "StateBufferConnector_ms": 0.002562999725341797, "ViewRequirementAgentConnector_ms": 0.06627559661865234}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154777.65398576873, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152125.38391822285, -152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37344371538499355, "mean_inference_ms": 0.4281449201727178, "mean_action_processing_ms": 0.08942247832393319, "mean_env_wait_ms": 0.7681546437306913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035240650177001953, "StateBufferConnector_ms": 0.002562999725341797, "ViewRequirementAgentConnector_ms": 0.06627559661865234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16889520, "num_agent_steps_trained": 16889520, "num_env_steps_sampled": 16889520, "num_env_steps_trained": 16889520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 720.442091084865, "num_env_steps_trained_throughput_per_sec": 720.442091084865, "timesteps_total": 16889520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16889520, "timers": {"training_iteration_time_ms": 61285.533, "sample_time_ms": 60158.447, "load_time_ms": 17.148, "load_throughput": 2561296.621, "learn_time_ms": 1108.856, "learn_throughput": 39608.382, "synch_weights_time_ms": 0.912}, "counters": {"num_env_steps_sampled": 16889520, "num_env_steps_trained": 16889520, "num_agent_steps_sampled": 16889520, "num_agent_steps_trained": 16889520}, "done": false, "episodes_total": 7837, "training_iteration": 2014, "trial_id": "e8087_00000", "date": "2023-08-06_13-51-44", "timestamp": 1691319104, "time_this_iter_s": 60.96553111076355, "time_total_s": 41208.2468214035, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11727.47539305687, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 17.211627906976748, "ram_util_percent": 71.05930232558141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9165057301869, "policy_loss": -2503716.475244283, "vf_loss": 4595397.852860787}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 88837.5, "diff_num_grad_updates_vs_sampler_policy": 88836.5}}, "num_env_steps_sampled": 16933440, "num_env_steps_trained": 16933440, "num_agent_steps_sampled": 16933440, "num_agent_steps_trained": 16933440}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154825.72649910097, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767961761242008, "mean_inference_ms": 0.42971115617907996, "mean_action_processing_ms": 0.08942409868254016, "mean_env_wait_ms": 0.7699193848689839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035247802734375, "StateBufferConnector_ms": 0.0025625228881835938, "ViewRequirementAgentConnector_ms": 0.0662686824798584}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154825.72649910097, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152984.73537749608, -154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3767961761242008, "mean_inference_ms": 0.42971115617907996, "mean_action_processing_ms": 0.08942409868254016, "mean_env_wait_ms": 0.7699193848689839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035247802734375, "StateBufferConnector_ms": 0.0025625228881835938, "ViewRequirementAgentConnector_ms": 0.0662686824798584}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16933440, "num_agent_steps_trained": 16933440, "num_env_steps_sampled": 16933440, "num_env_steps_trained": 16933440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.0179881802251, "num_env_steps_trained_throughput_per_sec": 711.0179881802251, "timesteps_total": 16933440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16933440, "timers": {"training_iteration_time_ms": 61343.235, "sample_time_ms": 60215.691, "load_time_ms": 17.085, "load_throughput": 2570736.438, "learn_time_ms": 1109.382, "learn_throughput": 39589.6, "synch_weights_time_ms": 0.907}, "counters": {"num_env_steps_sampled": 16933440, "num_env_steps_trained": 16933440, "num_agent_steps_sampled": 16933440, "num_agent_steps_trained": 16933440}, "done": false, "episodes_total": 7838, "training_iteration": 2015, "trial_id": "e8087_00000", "date": "2023-08-06_13-52-46", "timestamp": 1691319166, "time_this_iter_s": 61.77356004714966, "time_total_s": 41270.02038145065, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11789.24895310402, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 17.404545454545453, "ram_util_percent": 71.05227272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.375e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0375005872187, "policy_loss": -1953962.9525271046, "vf_loss": 4422056.840196793}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 89523.5, "diff_num_grad_updates_vs_sampler_policy": 89522.5}}, "num_env_steps_sampled": 16977360, "num_env_steps_trained": 16977360, "num_agent_steps_sampled": 16977360, "num_agent_steps_trained": 16977360}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154840.707373952, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3801220646008668, "mean_inference_ms": 0.4312658707193572, "mean_action_processing_ms": 0.08942556309596503, "mean_env_wait_ms": 0.771674732516535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519773483276367, "StateBufferConnector_ms": 0.002563953399658203, "ViewRequirementAgentConnector_ms": 0.06625485420227051}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154840.707373952, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154798.0817665556, -155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3801220646008668, "mean_inference_ms": 0.4312658707193572, "mean_action_processing_ms": 0.08942556309596503, "mean_env_wait_ms": 0.771674732516535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519773483276367, "StateBufferConnector_ms": 0.002563953399658203, "ViewRequirementAgentConnector_ms": 0.06625485420227051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16977360, "num_agent_steps_trained": 16977360, "num_env_steps_sampled": 16977360, "num_env_steps_trained": 16977360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.0714619396986, "num_env_steps_trained_throughput_per_sec": 718.0714619396986, "timesteps_total": 16977360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 16977360, "timers": {"training_iteration_time_ms": 61297.85, "sample_time_ms": 60171.624, "load_time_ms": 17.009, "load_throughput": 2582115.938, "learn_time_ms": 1108.137, "learn_throughput": 39634.075, "synch_weights_time_ms": 0.909}, "counters": {"num_env_steps_sampled": 16977360, "num_env_steps_trained": 16977360, "num_agent_steps_sampled": 16977360, "num_agent_steps_trained": 16977360}, "done": false, "episodes_total": 7839, "training_iteration": 2016, "trial_id": "e8087_00000", "date": "2023-08-06_13-53-47", "timestamp": 1691319227, "time_this_iter_s": 61.16668486595154, "time_total_s": 41331.187066316605, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11850.41563796997, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 17.13372093023256, "ram_util_percent": 71.11627906976743}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.749999999999999e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9879562778306, "policy_loss": -2129095.9624720984, "vf_loss": 4409012.472303207}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 90209.5, "diff_num_grad_updates_vs_sampler_policy": 90208.5}}, "num_env_steps_sampled": 17021280, "num_env_steps_trained": 17021280, "num_agent_steps_sampled": 17021280, "num_agent_steps_trained": 17021280}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154841.62464542888, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38342263656027886, "mean_inference_ms": 0.4328090475314713, "mean_action_processing_ms": 0.089426887493949, "mean_env_wait_ms": 0.7734164469125827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519296646118164, "StateBufferConnector_ms": 0.002560853958129883, "ViewRequirementAgentConnector_ms": 0.06626725196838379}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154841.62464542888, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155853.7404081629, -157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38342263656027886, "mean_inference_ms": 0.4328090475314713, "mean_action_processing_ms": 0.089426887493949, "mean_env_wait_ms": 0.7734164469125827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519296646118164, "StateBufferConnector_ms": 0.002560853958129883, "ViewRequirementAgentConnector_ms": 0.06626725196838379}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17021280, "num_agent_steps_trained": 17021280, "num_env_steps_sampled": 17021280, "num_env_steps_trained": 17021280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.7286850330437, "num_env_steps_trained_throughput_per_sec": 716.7286850330437, "timesteps_total": 17021280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17021280, "timers": {"training_iteration_time_ms": 61260.23, "sample_time_ms": 60135.398, "load_time_ms": 16.908, "load_throughput": 2597557.347, "learn_time_ms": 1106.846, "learn_throughput": 39680.322, "synch_weights_time_ms": 0.907}, "counters": {"num_env_steps_sampled": 17021280, "num_env_steps_trained": 17021280, "num_agent_steps_sampled": 17021280, "num_agent_steps_trained": 17021280}, "done": false, "episodes_total": 7840, "training_iteration": 2017, "trial_id": "e8087_00000", "date": "2023-08-06_13-54-48", "timestamp": 1691319288, "time_this_iter_s": 61.28139781951904, "time_total_s": 41392.468464136124, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11911.69703578949, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 16.970114942528735, "ram_util_percent": 71.07011494252873}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.125e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.94773348705417, "policy_loss": -2155396.20034621, "vf_loss": 4354016.051111516}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 90895.5, "diff_num_grad_updates_vs_sampler_policy": 90894.5}}, "num_env_steps_sampled": 17065200, "num_env_steps_trained": 17065200, "num_agent_steps_sampled": 17065200, "num_agent_steps_trained": 17065200}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154818.80289797706, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38669794728268203, "mean_inference_ms": 0.4343405359637957, "mean_action_processing_ms": 0.0894281622159944, "mean_env_wait_ms": 0.7751466610112714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519773483276367, "StateBufferConnector_ms": 0.002562999725341797, "ViewRequirementAgentConnector_ms": 0.06629157066345215}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154818.80289797706, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157450.0271603387, -156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38669794728268203, "mean_inference_ms": 0.4343405359637957, "mean_action_processing_ms": 0.0894281622159944, "mean_env_wait_ms": 0.7751466610112714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519773483276367, "StateBufferConnector_ms": 0.002562999725341797, "ViewRequirementAgentConnector_ms": 0.06629157066345215}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17065200, "num_agent_steps_trained": 17065200, "num_env_steps_sampled": 17065200, "num_env_steps_trained": 17065200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.0703509433358, "num_env_steps_trained_throughput_per_sec": 715.0703509433358, "timesteps_total": 17065200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17065200, "timers": {"training_iteration_time_ms": 61281.93, "sample_time_ms": 60158.625, "load_time_ms": 16.693, "load_throughput": 2630964.667, "learn_time_ms": 1105.541, "learn_throughput": 39727.146, "synch_weights_time_ms": 0.902}, "counters": {"num_env_steps_sampled": 17065200, "num_env_steps_trained": 17065200, "num_agent_steps_sampled": 17065200, "num_agent_steps_trained": 17065200}, "done": false, "episodes_total": 7841, "training_iteration": 2018, "trial_id": "e8087_00000", "date": "2023-08-06_13-55-50", "timestamp": 1691319350, "time_this_iter_s": 61.4233877658844, "time_total_s": 41453.89185190201, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11973.120423555374, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 17.43103448275862, "ram_util_percent": 71.11494252873564}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9149498675377, "policy_loss": -2286566.9753268496, "vf_loss": 4349753.602131925}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 91581.5, "diff_num_grad_updates_vs_sampler_policy": 91580.5}}, "num_env_steps_sampled": 17109120, "num_env_steps_trained": 17109120, "num_agent_steps_sampled": 17109120, "num_agent_steps_trained": 17109120}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154786.0300417663, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38994847135553945, "mean_inference_ms": 0.4358608241575899, "mean_action_processing_ms": 0.08942951044175533, "mean_env_wait_ms": 0.776865098290306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003521442413330078, "StateBufferConnector_ms": 0.002562999725341797, "ViewRequirementAgentConnector_ms": 0.06630086898803711}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154786.0300417663, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156214.25620246158, -154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38994847135553945, "mean_inference_ms": 0.4358608241575899, "mean_action_processing_ms": 0.08942951044175533, "mean_env_wait_ms": 0.776865098290306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003521442413330078, "StateBufferConnector_ms": 0.002562999725341797, "ViewRequirementAgentConnector_ms": 0.06630086898803711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17109120, "num_agent_steps_trained": 17109120, "num_env_steps_sampled": 17109120, "num_env_steps_trained": 17109120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.7117738926247, "num_env_steps_trained_throughput_per_sec": 711.7117738926247, "timesteps_total": 17109120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17109120, "timers": {"training_iteration_time_ms": 61311.716, "sample_time_ms": 60188.532, "load_time_ms": 16.729, "load_throughput": 2625370.285, "learn_time_ms": 1105.384, "learn_throughput": 39732.808, "synch_weights_time_ms": 0.901}, "counters": {"num_env_steps_sampled": 17109120, "num_env_steps_trained": 17109120, "num_agent_steps_sampled": 17109120, "num_agent_steps_trained": 17109120}, "done": false, "episodes_total": 7842, "training_iteration": 2019, "trial_id": "e8087_00000", "date": "2023-08-06_13-56-51", "timestamp": 1691319411, "time_this_iter_s": 61.713313817977905, "time_total_s": 41515.605165719986, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12034.833737373352, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 17.83563218390805, "ram_util_percent": 71.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.874999999999998e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0398981744972, "policy_loss": -2008170.993599672, "vf_loss": 4593973.578170554}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 92267.5, "diff_num_grad_updates_vs_sampler_policy": 92266.5}}, "num_env_steps_sampled": 17153040, "num_env_steps_trained": 17153040, "num_agent_steps_sampled": 17153040, "num_agent_steps_trained": 17153040}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154793.01457993657, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3931749589333814, "mean_inference_ms": 0.4373698033447831, "mean_action_processing_ms": 0.08943082811129845, "mean_env_wait_ms": 0.7785730064351283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035228729248046875, "StateBufferConnector_ms": 0.002564668655395508, "ViewRequirementAgentConnector_ms": 0.06631326675415039}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154793.01457993657, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154611.8371249862, -151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3931749589333814, "mean_inference_ms": 0.4373698033447831, "mean_action_processing_ms": 0.08943082811129845, "mean_env_wait_ms": 0.7785730064351283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035228729248046875, "StateBufferConnector_ms": 0.002564668655395508, "ViewRequirementAgentConnector_ms": 0.06631326675415039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17153040, "num_agent_steps_trained": 17153040, "num_env_steps_sampled": 17153040, "num_env_steps_trained": 17153040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.5663557144967, "num_env_steps_trained_throughput_per_sec": 718.5663557144967, "timesteps_total": 17153040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17153040, "timers": {"training_iteration_time_ms": 61298.543, "sample_time_ms": 60175.647, "load_time_ms": 16.821, "load_throughput": 2610980.769, "learn_time_ms": 1104.999, "learn_throughput": 39746.633, "synch_weights_time_ms": 0.905}, "counters": {"num_env_steps_sampled": 17153040, "num_env_steps_trained": 17153040, "num_agent_steps_sampled": 17153040, "num_agent_steps_trained": 17153040}, "done": false, "episodes_total": 7843, "training_iteration": 2020, "trial_id": "e8087_00000", "date": "2023-08-06_13-57-53", "timestamp": 1691319473, "time_this_iter_s": 61.12464475631714, "time_total_s": 41576.7298104763, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12095.95838212967, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 16.957471264367815, "ram_util_percent": 71.13563218390804}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.249999999999999e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0822868235952, "policy_loss": -2050485.1570642765, "vf_loss": 4445071.686862245}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 92953.5, "diff_num_grad_updates_vs_sampler_policy": 92952.5}}, "num_env_steps_sampled": 17196960, "num_env_steps_trained": 17196960, "num_agent_steps_sampled": 17196960, "num_agent_steps_trained": 17196960}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154794.34847587417, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3963778692692557, "mean_inference_ms": 0.4388678071033006, "mean_action_processing_ms": 0.08943217327246555, "mean_env_wait_ms": 0.7802675724014625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035245418548583984, "StateBufferConnector_ms": 0.0025632381439208984, "ViewRequirementAgentConnector_ms": 0.06630563735961914}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154794.34847587417, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-151042.48829549566, -153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3963778692692557, "mean_inference_ms": 0.4388678071033006, "mean_action_processing_ms": 0.08943217327246555, "mean_env_wait_ms": 0.7802675724014625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035245418548583984, "StateBufferConnector_ms": 0.0025632381439208984, "ViewRequirementAgentConnector_ms": 0.06630563735961914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17196960, "num_agent_steps_trained": 17196960, "num_env_steps_sampled": 17196960, "num_env_steps_trained": 17196960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 722.0728576624093, "num_env_steps_trained_throughput_per_sec": 722.0728576624093, "timesteps_total": 17196960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17196960, "timers": {"training_iteration_time_ms": 61273.983, "sample_time_ms": 60151.456, "load_time_ms": 16.945, "load_throughput": 2591965.394, "learn_time_ms": 1104.51, "learn_throughput": 39764.23, "synch_weights_time_ms": 0.903}, "counters": {"num_env_steps_sampled": 17196960, "num_env_steps_trained": 17196960, "num_agent_steps_sampled": 17196960, "num_agent_steps_trained": 17196960}, "done": false, "episodes_total": 7844, "training_iteration": 2021, "trial_id": "e8087_00000", "date": "2023-08-06_13-58-54", "timestamp": 1691319534, "time_this_iter_s": 60.82790398597717, "time_total_s": 41637.55771446228, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12156.786286115646, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 17.934883720930234, "ram_util_percent": 71.41279069767442}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.6250000000000006e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9123660162656, "policy_loss": -2260408.98111647, "vf_loss": 4444294.089194606}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 93639.5, "diff_num_grad_updates_vs_sampler_policy": 93638.5}}, "num_env_steps_sampled": 17240880, "num_env_steps_trained": 17240880, "num_agent_steps_sampled": 17240880, "num_agent_steps_trained": 17240880}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154835.00424522377, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3995568372883868, "mean_inference_ms": 0.44035488027842445, "mean_action_processing_ms": 0.08943343542517562, "mean_env_wait_ms": 0.7819486846765321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035254955291748047, "StateBufferConnector_ms": 0.0025620460510253906, "ViewRequirementAgentConnector_ms": 0.06629061698913574}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154835.00424522377, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153807.518778591, -154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3995568372883868, "mean_inference_ms": 0.44035488027842445, "mean_action_processing_ms": 0.08943343542517562, "mean_env_wait_ms": 0.7819486846765321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035254955291748047, "StateBufferConnector_ms": 0.0025620460510253906, "ViewRequirementAgentConnector_ms": 0.06629061698913574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17240880, "num_agent_steps_trained": 17240880, "num_env_steps_sampled": 17240880, "num_env_steps_trained": 17240880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.9686187080019, "num_env_steps_trained_throughput_per_sec": 714.9686187080019, "timesteps_total": 17240880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17240880, "timers": {"training_iteration_time_ms": 61286.154, "sample_time_ms": 60164.869, "load_time_ms": 16.908, "load_throughput": 2597637.93, "learn_time_ms": 1103.292, "learn_throughput": 39808.132, "synch_weights_time_ms": 0.918}, "counters": {"num_env_steps_sampled": 17240880, "num_env_steps_trained": 17240880, "num_agent_steps_sampled": 17240880, "num_agent_steps_trained": 17240880}, "done": false, "episodes_total": 7845, "training_iteration": 2022, "trial_id": "e8087_00000", "date": "2023-08-06_13-59-55", "timestamp": 1691319595, "time_this_iter_s": 61.43214511871338, "time_total_s": 41698.989859580994, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12218.21843123436, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 17.328735632183907, "ram_util_percent": 71.50689655172414}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.8556002069145, "policy_loss": -2219653.2532656477, "vf_loss": 4147988.5996720116}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 94325.5, "diff_num_grad_updates_vs_sampler_policy": 94324.5}}, "num_env_steps_sampled": 17284800, "num_env_steps_trained": 17284800, "num_agent_steps_sampled": 17284800, "num_agent_steps_trained": 17284800}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154809.22321790655, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40271350464932, "mean_inference_ms": 0.4418313291165893, "mean_action_processing_ms": 0.08943462961165156, "mean_env_wait_ms": 0.7836192756261968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035247802734375, "StateBufferConnector_ms": 0.002566099166870117, "ViewRequirementAgentConnector_ms": 0.06629562377929688}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154809.22321790655, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154659.19624613217, -150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40271350464932, "mean_inference_ms": 0.4418313291165893, "mean_action_processing_ms": 0.08943462961165156, "mean_env_wait_ms": 0.7836192756261968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035247802734375, "StateBufferConnector_ms": 0.002566099166870117, "ViewRequirementAgentConnector_ms": 0.06629562377929688}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17284800, "num_agent_steps_trained": 17284800, "num_env_steps_sampled": 17284800, "num_env_steps_trained": 17284800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.7982305526529, "num_env_steps_trained_throughput_per_sec": 713.7982305526529, "timesteps_total": 17284800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17284800, "timers": {"training_iteration_time_ms": 61321.195, "sample_time_ms": 60199.992, "load_time_ms": 16.882, "load_throughput": 2601526.505, "learn_time_ms": 1103.236, "learn_throughput": 39810.143, "synch_weights_time_ms": 0.916}, "counters": {"num_env_steps_sampled": 17284800, "num_env_steps_trained": 17284800, "num_agent_steps_sampled": 17284800, "num_agent_steps_trained": 17284800}, "done": false, "episodes_total": 7846, "training_iteration": 2023, "trial_id": "e8087_00000", "date": "2023-08-06_14-00-57", "timestamp": 1691319657, "time_this_iter_s": 61.53338122367859, "time_total_s": 41760.52324080467, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12279.751812458038, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 17.504597701149425, "ram_util_percent": 71.56436781609194}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9473076645209, "policy_loss": -2331920.063393996, "vf_loss": 4563632.193330904}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 95011.5, "diff_num_grad_updates_vs_sampler_policy": 95010.5}}, "num_env_steps_sampled": 17328720, "num_env_steps_trained": 17328720, "num_agent_steps_sampled": 17328720, "num_agent_steps_trained": 17328720}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154830.4144415763, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4058474730461583, "mean_inference_ms": 0.4432965170261232, "mean_action_processing_ms": 0.08943572372978237, "mean_env_wait_ms": 0.7852772542085618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035200119018554688, "StateBufferConnector_ms": 0.002568960189819336, "ViewRequirementAgentConnector_ms": 0.06623196601867676}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154830.4144415763, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-150023.33206758465, -157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4058474730461583, "mean_inference_ms": 0.4432965170261232, "mean_action_processing_ms": 0.08943572372978237, "mean_env_wait_ms": 0.7852772542085618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035200119018554688, "StateBufferConnector_ms": 0.002568960189819336, "ViewRequirementAgentConnector_ms": 0.06623196601867676}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17328720, "num_agent_steps_trained": 17328720, "num_env_steps_sampled": 17328720, "num_env_steps_trained": 17328720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.3056713684898, "num_env_steps_trained_throughput_per_sec": 717.3056713684898, "timesteps_total": 17328720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17328720, "timers": {"training_iteration_time_ms": 61347.851, "sample_time_ms": 60227.195, "load_time_ms": 17.019, "load_throughput": 2580705.167, "learn_time_ms": 1102.55, "learn_throughput": 39834.921, "synch_weights_time_ms": 0.918}, "counters": {"num_env_steps_sampled": 17328720, "num_env_steps_trained": 17328720, "num_agent_steps_sampled": 17328720, "num_agent_steps_trained": 17328720}, "done": false, "episodes_total": 7847, "training_iteration": 2024, "trial_id": "e8087_00000", "date": "2023-08-06_14-01-58", "timestamp": 1691319718, "time_this_iter_s": 61.23199009895325, "time_total_s": 41821.755230903625, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12340.983802556992, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 17.65402298850575, "ram_util_percent": 71.54942528735631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.20690166150865, "policy_loss": -1949356.145059391, "vf_loss": 4272406.69005102}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 95697.5, "diff_num_grad_updates_vs_sampler_policy": 95696.5}}, "num_env_steps_sampled": 17372640, "num_env_steps_trained": 17372640, "num_agent_steps_sampled": 17372640, "num_agent_steps_trained": 17372640}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154857.99452909332, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4089591776597807, "mean_inference_ms": 0.44475180829795663, "mean_action_processing_ms": 0.08943682181322282, "mean_env_wait_ms": 0.7869206152065538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035169124603271484, "StateBufferConnector_ms": 0.0025703907012939453, "ViewRequirementAgentConnector_ms": 0.06621217727661133}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154857.99452909332, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157682.81044972042, -155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4089591776597807, "mean_inference_ms": 0.44475180829795663, "mean_action_processing_ms": 0.08943682181322282, "mean_env_wait_ms": 0.7869206152065538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035169124603271484, "StateBufferConnector_ms": 0.0025703907012939453, "ViewRequirementAgentConnector_ms": 0.06621217727661133}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17372640, "num_agent_steps_trained": 17372640, "num_env_steps_sampled": 17372640, "num_env_steps_trained": 17372640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.8182270502692, "num_env_steps_trained_throughput_per_sec": 714.8182270502692, "timesteps_total": 17372640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17372640, "timers": {"training_iteration_time_ms": 61315.012, "sample_time_ms": 60193.117, "load_time_ms": 16.995, "load_throughput": 2584260.366, "learn_time_ms": 1103.802, "learn_throughput": 39789.73, "synch_weights_time_ms": 0.932}, "counters": {"num_env_steps_sampled": 17372640, "num_env_steps_trained": 17372640, "num_agent_steps_sampled": 17372640, "num_agent_steps_trained": 17372640}, "done": false, "episodes_total": 7848, "training_iteration": 2025, "trial_id": "e8087_00000", "date": "2023-08-06_14-02-59", "timestamp": 1691319779, "time_this_iter_s": 61.44558501243591, "time_total_s": 41883.20081591606, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12402.429387569427, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 17.551724137931036, "ram_util_percent": 71.5689655172414}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.3171093999123, "policy_loss": -2070641.0431082589, "vf_loss": 4374537.834639213}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 96383.5, "diff_num_grad_updates_vs_sampler_policy": 96382.5}}, "num_env_steps_sampled": 17416560, "num_env_steps_trained": 17416560, "num_agent_steps_sampled": 17416560, "num_agent_steps_trained": 17416560}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154819.18631457083, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41204951712236204, "mean_inference_ms": 0.44619702052013077, "mean_action_processing_ms": 0.08943793679345834, "mean_env_wait_ms": 0.7885529669638279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003515958786010742, "StateBufferConnector_ms": 0.002568960189819336, "ViewRequirementAgentConnector_ms": 0.06622028350830078}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154819.18631457083, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155636.14080940615, -157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41204951712236204, "mean_inference_ms": 0.44619702052013077, "mean_action_processing_ms": 0.08943793679345834, "mean_env_wait_ms": 0.7885529669638279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003515958786010742, "StateBufferConnector_ms": 0.002568960189819336, "ViewRequirementAgentConnector_ms": 0.06622028350830078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17416560, "num_agent_steps_trained": 17416560, "num_env_steps_sampled": 17416560, "num_env_steps_trained": 17416560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.6014997140948, "num_env_steps_trained_throughput_per_sec": 716.6014997140948, "timesteps_total": 17416560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17416560, "timers": {"training_iteration_time_ms": 61327.558, "sample_time_ms": 60205.244, "load_time_ms": 16.788, "load_throughput": 2616186.927, "learn_time_ms": 1104.42, "learn_throughput": 39767.489, "synch_weights_time_ms": 0.94}, "counters": {"num_env_steps_sampled": 17416560, "num_env_steps_trained": 17416560, "num_agent_steps_sampled": 17416560, "num_agent_steps_trained": 17416560}, "done": false, "episodes_total": 7849, "training_iteration": 2026, "trial_id": "e8087_00000", "date": "2023-08-06_14-04-01", "timestamp": 1691319841, "time_this_iter_s": 61.29219317436218, "time_total_s": 41944.49300909042, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12463.72158074379, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 17.199999999999996, "ram_util_percent": 71.55697674418604}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.03062114215106, "policy_loss": -2012218.6927557853, "vf_loss": 4411494.880830904}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 97069.5, "diff_num_grad_updates_vs_sampler_policy": 97068.5}}, "num_env_steps_sampled": 17460480, "num_env_steps_trained": 17460480, "num_agent_steps_sampled": 17460480, "num_agent_steps_trained": 17460480}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154807.91529974522, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41511828204214596, "mean_inference_ms": 0.4476322701432248, "mean_action_processing_ms": 0.08943912670820067, "mean_env_wait_ms": 0.7901770119473825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035152435302734375, "StateBufferConnector_ms": 0.0025632381439208984, "ViewRequirementAgentConnector_ms": 0.06620216369628906}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154807.91529974522, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157471.13749561692, -155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41511828204214596, "mean_inference_ms": 0.4476322701432248, "mean_action_processing_ms": 0.08943912670820067, "mean_env_wait_ms": 0.7901770119473825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035152435302734375, "StateBufferConnector_ms": 0.0025632381439208984, "ViewRequirementAgentConnector_ms": 0.06620216369628906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17460480, "num_agent_steps_trained": 17460480, "num_env_steps_sampled": 17460480, "num_env_steps_trained": 17460480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.5578567165891, "num_env_steps_trained_throughput_per_sec": 711.5578567165891, "timesteps_total": 17460480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17460480, "timers": {"training_iteration_time_ms": 61372.089, "sample_time_ms": 60249.652, "load_time_ms": 16.866, "load_throughput": 2604115.546, "learn_time_ms": 1104.467, "learn_throughput": 39765.799, "synch_weights_time_ms": 0.939}, "counters": {"num_env_steps_sampled": 17460480, "num_env_steps_trained": 17460480, "num_agent_steps_sampled": 17460480, "num_agent_steps_trained": 17460480}, "done": false, "episodes_total": 7850, "training_iteration": 2027, "trial_id": "e8087_00000", "date": "2023-08-06_14-05-02", "timestamp": 1691319902, "time_this_iter_s": 61.72703695297241, "time_total_s": 42006.220046043396, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12525.448617696762, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 17.07840909090909, "ram_util_percent": 71.55340909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9359481411147, "policy_loss": -1936336.1751264122, "vf_loss": 4201837.001548834}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 97755.5, "diff_num_grad_updates_vs_sampler_policy": 97754.5}}, "num_env_steps_sampled": 17504400, "num_env_steps_trained": 17504400, "num_agent_steps_sampled": 17504400, "num_agent_steps_trained": 17504400}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154748.5939529236, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4181660820278409, "mean_inference_ms": 0.4490575210928542, "mean_action_processing_ms": 0.08944026421297116, "mean_env_wait_ms": 0.7917891977851949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035245418548583984, "StateBufferConnector_ms": 0.0025670528411865234, "ViewRequirementAgentConnector_ms": 0.06629323959350586}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154748.5939529236, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155527.9400938122, -146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4181660820278409, "mean_inference_ms": 0.4490575210928542, "mean_action_processing_ms": 0.08944026421297116, "mean_env_wait_ms": 0.7917891977851949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035245418548583984, "StateBufferConnector_ms": 0.0025670528411865234, "ViewRequirementAgentConnector_ms": 0.06629323959350586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17504400, "num_agent_steps_trained": 17504400, "num_env_steps_sampled": 17504400, "num_env_steps_trained": 17504400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.381375587083, "num_env_steps_trained_throughput_per_sec": 713.381375587083, "timesteps_total": 17504400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17504400, "timers": {"training_iteration_time_ms": 61386.631, "sample_time_ms": 60263.548, "load_time_ms": 16.995, "load_throughput": 2584260.366, "learn_time_ms": 1104.972, "learn_throughput": 39747.596, "synch_weights_time_ms": 0.948}, "counters": {"num_env_steps_sampled": 17504400, "num_env_steps_trained": 17504400, "num_agent_steps_sampled": 17504400, "num_agent_steps_trained": 17504400}, "done": false, "episodes_total": 7851, "training_iteration": 2028, "trial_id": "e8087_00000", "date": "2023-08-06_14-06-04", "timestamp": 1691319964, "time_this_iter_s": 61.568997859954834, "time_total_s": 42067.78904390335, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12587.017615556717, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 17.09425287356322, "ram_util_percent": 71.51954022988505}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9198870422541, "policy_loss": -2045496.927099467, "vf_loss": 4276740.334639213}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 98441.5, "diff_num_grad_updates_vs_sampler_policy": 98440.5}}, "num_env_steps_sampled": 17548320, "num_env_steps_trained": 17548320, "num_agent_steps_sampled": 17548320, "num_agent_steps_trained": 17548320}, "sampler_results": {"episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154721.43428941525, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42119248828392336, "mean_inference_ms": 0.4504730797157701, "mean_action_processing_ms": 0.08944144762345527, "mean_env_wait_ms": 0.7933923441246377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035223960876464844, "StateBufferConnector_ms": 0.0025582313537597656, "ViewRequirementAgentConnector_ms": 0.06630873680114746}}, "episode_reward_max": -146468.57211707867, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154721.43428941525, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-146468.57211707867, -155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42119248828392336, "mean_inference_ms": 0.4504730797157701, "mean_action_processing_ms": 0.08944144762345527, "mean_env_wait_ms": 0.7933923441246377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035223960876464844, "StateBufferConnector_ms": 0.0025582313537597656, "ViewRequirementAgentConnector_ms": 0.06630873680114746}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17548320, "num_agent_steps_trained": 17548320, "num_env_steps_sampled": 17548320, "num_env_steps_trained": 17548320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.5069077847842, "num_env_steps_trained_throughput_per_sec": 718.5069077847842, "timesteps_total": 17548320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17548320, "timers": {"training_iteration_time_ms": 61328.27, "sample_time_ms": 60205.28, "load_time_ms": 17.083, "load_throughput": 2570991.176, "learn_time_ms": 1104.8, "learn_throughput": 39753.788, "synch_weights_time_ms": 0.938}, "counters": {"num_env_steps_sampled": 17548320, "num_env_steps_trained": 17548320, "num_agent_steps_sampled": 17548320, "num_agent_steps_trained": 17548320}, "done": false, "episodes_total": 7852, "training_iteration": 2029, "trial_id": "e8087_00000", "date": "2023-08-06_14-07-05", "timestamp": 1691320025, "time_this_iter_s": 61.129656076431274, "time_total_s": 42128.91869997978, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12648.147271633148, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 19.270114942528732, "ram_util_percent": 71.19999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0404022928577, "policy_loss": -2090180.165093158, "vf_loss": 4587390.748177842}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 99127.5, "diff_num_grad_updates_vs_sampler_policy": 99126.5}}, "num_env_steps_sampled": 17592240, "num_env_steps_trained": 17592240, "num_agent_steps_sampled": 17592240, "num_agent_steps_trained": 17592240}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154823.53394917873, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42419771335681977, "mean_inference_ms": 0.45187911151571053, "mean_action_processing_ms": 0.08944266222963568, "mean_env_wait_ms": 0.7949797435305287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003522157669067383, "StateBufferConnector_ms": 0.002560138702392578, "ViewRequirementAgentConnector_ms": 0.06632590293884277}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154823.53394917873, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155080.28765361017, -153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42419771335681977, "mean_inference_ms": 0.45187911151571053, "mean_action_processing_ms": 0.08944266222963568, "mean_env_wait_ms": 0.7949797435305287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003522157669067383, "StateBufferConnector_ms": 0.002560138702392578, "ViewRequirementAgentConnector_ms": 0.06632590293884277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17592240, "num_agent_steps_trained": 17592240, "num_env_steps_sampled": 17592240, "num_env_steps_trained": 17592240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.9835638374668, "num_env_steps_trained_throughput_per_sec": 715.9835638374668, "timesteps_total": 17592240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17592240, "timers": {"training_iteration_time_ms": 61350.318, "sample_time_ms": 60227.974, "load_time_ms": 16.921, "load_throughput": 2595588.278, "learn_time_ms": 1104.321, "learn_throughput": 39771.059, "synch_weights_time_ms": 0.934}, "counters": {"num_env_steps_sampled": 17592240, "num_env_steps_trained": 17592240, "num_agent_steps_sampled": 17592240, "num_agent_steps_trained": 17592240}, "done": false, "episodes_total": 7853, "training_iteration": 2030, "trial_id": "e8087_00000", "date": "2023-08-06_14-08-06", "timestamp": 1691320086, "time_this_iter_s": 61.34508299827576, "time_total_s": 42190.26378297806, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12709.492354631424, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 17.38255813953488, "ram_util_percent": 71.31162790697677}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9161447686287, "policy_loss": -2005540.904604364, "vf_loss": 4473956.021865889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 99813.5, "diff_num_grad_updates_vs_sampler_policy": 99812.5}}, "num_env_steps_sampled": 17636160, "num_env_steps_trained": 17636160, "num_agent_steps_sampled": 17636160, "num_agent_steps_trained": 17636160}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154824.93106246824, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42718192610727074, "mean_inference_ms": 0.45327574140623056, "mean_action_processing_ms": 0.08944381334479658, "mean_env_wait_ms": 0.7965567017994394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003522157669067383, "StateBufferConnector_ms": 0.002559661865234375, "ViewRequirementAgentConnector_ms": 0.06633734703063965}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154824.93106246824, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153828.42694087798, -153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42718192610727074, "mean_inference_ms": 0.45327574140623056, "mean_action_processing_ms": 0.08944381334479658, "mean_env_wait_ms": 0.7965567017994394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003522157669067383, "StateBufferConnector_ms": 0.002559661865234375, "ViewRequirementAgentConnector_ms": 0.06633734703063965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17636160, "num_agent_steps_trained": 17636160, "num_env_steps_sampled": 17636160, "num_env_steps_trained": 17636160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.4311671649369, "num_env_steps_trained_throughput_per_sec": 719.4311671649369, "timesteps_total": 17636160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17636160, "timers": {"training_iteration_time_ms": 61372.652, "sample_time_ms": 60250.594, "load_time_ms": 16.683, "load_throughput": 2632585.18, "learn_time_ms": 1104.274, "learn_throughput": 39772.741, "synch_weights_time_ms": 0.938}, "counters": {"num_env_steps_sampled": 17636160, "num_env_steps_trained": 17636160, "num_agent_steps_sampled": 17636160, "num_agent_steps_trained": 17636160}, "done": false, "episodes_total": 7854, "training_iteration": 2031, "trial_id": "e8087_00000", "date": "2023-08-06_14-09-08", "timestamp": 1691320148, "time_this_iter_s": 61.051064014434814, "time_total_s": 42251.31484699249, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12770.543418645859, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 17.040229885057467, "ram_util_percent": 71.46896551724136}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.6875e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.90955070295416, "policy_loss": -2291346.1371572064, "vf_loss": 4519369.80010933}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 100499.5, "diff_num_grad_updates_vs_sampler_policy": 100498.5}}, "num_env_steps_sampled": 17680080, "num_env_steps_trained": 17680080, "num_agent_steps_sampled": 17680080, "num_agent_steps_trained": 17680080}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154849.67448502092, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43014593370318166, "mean_inference_ms": 0.45466307760245217, "mean_action_processing_ms": 0.08944504583199105, "mean_env_wait_ms": 0.7981253802510332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035223960876464844, "StateBufferConnector_ms": 0.0025620460510253906, "ViewRequirementAgentConnector_ms": 0.06634092330932617}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154849.67448502092, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153579.3338485257, -151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43014593370318166, "mean_inference_ms": 0.45466307760245217, "mean_action_processing_ms": 0.08944504583199105, "mean_env_wait_ms": 0.7981253802510332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035223960876464844, "StateBufferConnector_ms": 0.0025620460510253906, "ViewRequirementAgentConnector_ms": 0.06634092330932617}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17680080, "num_agent_steps_trained": 17680080, "num_env_steps_sampled": 17680080, "num_env_steps_trained": 17680080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.8436384136287, "num_env_steps_trained_throughput_per_sec": 711.8436384136287, "timesteps_total": 17680080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17680080, "timers": {"training_iteration_time_ms": 61399.619, "sample_time_ms": 60268.843, "load_time_ms": 16.769, "load_throughput": 2619118.008, "learn_time_ms": 1112.915, "learn_throughput": 39463.919, "synch_weights_time_ms": 0.924}, "counters": {"num_env_steps_sampled": 17680080, "num_env_steps_trained": 17680080, "num_agent_steps_sampled": 17680080, "num_agent_steps_trained": 17680080}, "done": false, "episodes_total": 7855, "training_iteration": 2032, "trial_id": "e8087_00000", "date": "2023-08-06_14-10-09", "timestamp": 1691320209, "time_this_iter_s": 61.70190501213074, "time_total_s": 42313.01675200462, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12832.24532365799, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 17.778160919540227, "ram_util_percent": 71.44252873563218}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.3749999999999997e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.08844870520056, "policy_loss": -2021463.961387345, "vf_loss": 4524166.727223032}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 101185.5, "diff_num_grad_updates_vs_sampler_policy": 101184.5}}, "num_env_steps_sampled": 17724000, "num_env_steps_trained": 17724000, "num_agent_steps_sampled": 17724000, "num_agent_steps_trained": 17724000}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154873.326964763, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43309015530609407, "mean_inference_ms": 0.4560411795066425, "mean_action_processing_ms": 0.08944627474530606, "mean_env_wait_ms": 0.7996844365113814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003529787063598633, "StateBufferConnector_ms": 0.002560853958129883, "ViewRequirementAgentConnector_ms": 0.06635499000549316}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154873.326964763, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-151857.9485943401, -153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43309015530609407, "mean_inference_ms": 0.4560411795066425, "mean_action_processing_ms": 0.08944627474530606, "mean_env_wait_ms": 0.7996844365113814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003529787063598633, "StateBufferConnector_ms": 0.002560853958129883, "ViewRequirementAgentConnector_ms": 0.06635499000549316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17724000, "num_agent_steps_trained": 17724000, "num_env_steps_sampled": 17724000, "num_env_steps_trained": 17724000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.2638848806921, "num_env_steps_trained_throughput_per_sec": 718.2638848806921, "timesteps_total": 17724000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17724000, "timers": {"training_iteration_time_ms": 61361.364, "sample_time_ms": 60230.515, "load_time_ms": 16.75, "load_throughput": 2622029.539, "learn_time_ms": 1113.013, "learn_throughput": 39460.472, "synch_weights_time_ms": 0.92}, "counters": {"num_env_steps_sampled": 17724000, "num_env_steps_trained": 17724000, "num_agent_steps_sampled": 17724000, "num_agent_steps_trained": 17724000}, "done": false, "episodes_total": 7856, "training_iteration": 2033, "trial_id": "e8087_00000", "date": "2023-08-06_14-11-10", "timestamp": 1691320270, "time_this_iter_s": 61.15090298652649, "time_total_s": 42374.16765499115, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12893.396226644516, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 16.98045977011494, "ram_util_percent": 71.25747126436782}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.0625e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0497950339804, "policy_loss": -1985517.372211245, "vf_loss": 4322834.8715379005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 101871.5, "diff_num_grad_updates_vs_sampler_policy": 101870.5}}, "num_env_steps_sampled": 17767920, "num_env_steps_trained": 17767920, "num_agent_steps_sampled": 17767920, "num_agent_steps_trained": 17767920}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154887.96091326413, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43601447111821, "mean_inference_ms": 0.45740999049403797, "mean_action_processing_ms": 0.08944750826054529, "mean_env_wait_ms": 0.8012344718588652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035295486450195312, "StateBufferConnector_ms": 0.0025625228881835938, "ViewRequirementAgentConnector_ms": 0.0663602352142334}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154887.96091326413, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153761.12850162285, -155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43601447111821, "mean_inference_ms": 0.45740999049403797, "mean_action_processing_ms": 0.08944750826054529, "mean_env_wait_ms": 0.8012344718588652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035295486450195312, "StateBufferConnector_ms": 0.0025625228881835938, "ViewRequirementAgentConnector_ms": 0.0663602352142334}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17767920, "num_agent_steps_trained": 17767920, "num_env_steps_sampled": 17767920, "num_env_steps_trained": 17767920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 709.4534314379069, "num_env_steps_trained_throughput_per_sec": 709.4534314379069, "timesteps_total": 17767920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17767920, "timers": {"training_iteration_time_ms": 61429.133, "sample_time_ms": 60297.586, "load_time_ms": 16.646, "load_throughput": 2638501.348, "learn_time_ms": 1113.806, "learn_throughput": 39432.369, "synch_weights_time_ms": 0.929}, "counters": {"num_env_steps_sampled": 17767920, "num_env_steps_trained": 17767920, "num_agent_steps_sampled": 17767920, "num_agent_steps_trained": 17767920}, "done": false, "episodes_total": 7857, "training_iteration": 2034, "trial_id": "e8087_00000", "date": "2023-08-06_14-12-12", "timestamp": 1691320332, "time_this_iter_s": 61.90971279144287, "time_total_s": 42436.07736778259, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12955.305939435959, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 16.958620689655174, "ram_util_percent": 71.3632183908046}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.75e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1559603499254, "policy_loss": -1995522.5101442921, "vf_loss": 4497070.837463557}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 102557.5, "diff_num_grad_updates_vs_sampler_policy": 102556.5}}, "num_env_steps_sampled": 17811840, "num_env_steps_trained": 17811840, "num_agent_steps_sampled": 17811840, "num_agent_steps_trained": 17811840}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154907.40934584007, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4389194145680996, "mean_inference_ms": 0.4587696631478159, "mean_action_processing_ms": 0.0894487520209842, "mean_env_wait_ms": 0.8027736314564811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003534078598022461, "StateBufferConnector_ms": 0.0025572776794433594, "ViewRequirementAgentConnector_ms": 0.0663614273071289}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154907.40934584007, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155657.81372673795, -153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4389194145680996, "mean_inference_ms": 0.4587696631478159, "mean_action_processing_ms": 0.0894487520209842, "mean_env_wait_ms": 0.8027736314564811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003534078598022461, "StateBufferConnector_ms": 0.0025572776794433594, "ViewRequirementAgentConnector_ms": 0.0663614273071289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17811840, "num_agent_steps_trained": 17811840, "num_env_steps_sampled": 17811840, "num_env_steps_trained": 17811840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.8866844737701, "num_env_steps_trained_throughput_per_sec": 714.8866844737701, "timesteps_total": 17811840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17811840, "timers": {"training_iteration_time_ms": 61428.544, "sample_time_ms": 60306.227, "load_time_ms": 16.742, "load_throughput": 2623403.67, "learn_time_ms": 1104.496, "learn_throughput": 39764.737, "synch_weights_time_ms": 0.912}, "counters": {"num_env_steps_sampled": 17811840, "num_env_steps_trained": 17811840, "num_agent_steps_sampled": 17811840, "num_agent_steps_trained": 17811840}, "done": false, "episodes_total": 7858, "training_iteration": 2035, "trial_id": "e8087_00000", "date": "2023-08-06_14-13-14", "timestamp": 1691320394, "time_this_iter_s": 61.43932509422302, "time_total_s": 42497.516692876816, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13016.745264530182, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 17.817241379310342, "ram_util_percent": 71.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.437499999999999e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0561937159769, "policy_loss": -2170471.358344342, "vf_loss": 4640714.444059767}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 103243.5, "diff_num_grad_updates_vs_sampler_policy": 103242.5}}, "num_env_steps_sampled": 17855760, "num_env_steps_trained": 17855760, "num_agent_steps_sampled": 17855760, "num_agent_steps_trained": 17855760}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154923.92518919104, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44180471005093935, "mean_inference_ms": 0.46012054783364903, "mean_action_processing_ms": 0.08944997966575109, "mean_env_wait_ms": 0.8043032946256752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035409927368164062, "StateBufferConnector_ms": 0.0025587081909179688, "ViewRequirementAgentConnector_ms": 0.06643533706665039}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154923.92518919104, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153587.99118433212, -154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44180471005093935, "mean_inference_ms": 0.46012054783364903, "mean_action_processing_ms": 0.08944997966575109, "mean_env_wait_ms": 0.8043032946256752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035409927368164062, "StateBufferConnector_ms": 0.0025587081909179688, "ViewRequirementAgentConnector_ms": 0.06643533706665039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17855760, "num_agent_steps_trained": 17855760, "num_env_steps_sampled": 17855760, "num_env_steps_trained": 17855760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 721.2407811539605, "num_env_steps_trained_throughput_per_sec": 721.2407811539605, "timesteps_total": 17855760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17855760, "timers": {"training_iteration_time_ms": 61389.121, "sample_time_ms": 60266.577, "load_time_ms": 16.742, "load_throughput": 2623272.916, "learn_time_ms": 1104.731, "learn_throughput": 39756.28, "synch_weights_time_ms": 0.903}, "counters": {"num_env_steps_sampled": 17855760, "num_env_steps_trained": 17855760, "num_agent_steps_sampled": 17855760, "num_agent_steps_trained": 17855760}, "done": false, "episodes_total": 7859, "training_iteration": 2036, "trial_id": "e8087_00000", "date": "2023-08-06_14-14-15", "timestamp": 1691320455, "time_this_iter_s": 60.89844107627869, "time_total_s": 42558.415133953094, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13077.64370560646, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 17.23218390804598, "ram_util_percent": 71.39425287356323}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.124999999999999e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.8522401592822, "policy_loss": -2051992.2232114386, "vf_loss": 4147593.2277696794}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 103929.5, "diff_num_grad_updates_vs_sampler_policy": 103928.5}}, "num_env_steps_sampled": 17899680, "num_env_steps_trained": 17899680, "num_agent_steps_sampled": 17899680, "num_agent_steps_trained": 17899680}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154900.1043019175, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4446706883899671, "mean_inference_ms": 0.4614627324273102, "mean_action_processing_ms": 0.08945114572505558, "mean_env_wait_ms": 0.8058246398872035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003543853759765625, "StateBufferConnector_ms": 0.0025594234466552734, "ViewRequirementAgentConnector_ms": 0.06646871566772461}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154900.1043019175, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154721.57510299265, -159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4446706883899671, "mean_inference_ms": 0.4614627324273102, "mean_action_processing_ms": 0.08945114572505558, "mean_env_wait_ms": 0.8058246398872035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003543853759765625, "StateBufferConnector_ms": 0.0025594234466552734, "ViewRequirementAgentConnector_ms": 0.06646871566772461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17899680, "num_agent_steps_trained": 17899680, "num_env_steps_sampled": 17899680, "num_env_steps_trained": 17899680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.6344072795342, "num_env_steps_trained_throughput_per_sec": 714.6344072795342, "timesteps_total": 17899680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17899680, "timers": {"training_iteration_time_ms": 61362.548, "sample_time_ms": 60239.959, "load_time_ms": 16.693, "load_throughput": 2631069.884, "learn_time_ms": 1104.816, "learn_throughput": 39753.229, "synch_weights_time_ms": 0.914}, "counters": {"num_env_steps_sampled": 17899680, "num_env_steps_trained": 17899680, "num_agent_steps_sampled": 17899680, "num_agent_steps_trained": 17899680}, "done": false, "episodes_total": 7860, "training_iteration": 2037, "trial_id": "e8087_00000", "date": "2023-08-06_14-15-16", "timestamp": 1691320516, "time_this_iter_s": 61.46101093292236, "time_total_s": 42619.87614488602, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13139.104716539383, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 17.259770114942526, "ram_util_percent": 71.41379310344828}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8125000000000003e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.2343174792587, "policy_loss": -1946346.9609944425, "vf_loss": 4619820.577077259}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 104615.5, "diff_num_grad_updates_vs_sampler_policy": 104614.5}}, "num_env_steps_sampled": 17943600, "num_env_steps_trained": 17943600, "num_agent_steps_sampled": 17943600, "num_agent_steps_trained": 17943600}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154924.4891637115, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4475174872556164, "mean_inference_ms": 0.46279605194640355, "mean_action_processing_ms": 0.08945226022868903, "mean_env_wait_ms": 0.8073341146979242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003544330596923828, "StateBufferConnector_ms": 0.0025610923767089844, "ViewRequirementAgentConnector_ms": 0.06647586822509766}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159670.7615602403, "episode_reward_mean": -154924.4891637115, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-159670.7615602403, -156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4475174872556164, "mean_inference_ms": 0.46279605194640355, "mean_action_processing_ms": 0.08945226022868903, "mean_env_wait_ms": 0.8073341146979242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003544330596923828, "StateBufferConnector_ms": 0.0025610923767089844, "ViewRequirementAgentConnector_ms": 0.06647586822509766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17943600, "num_agent_steps_trained": 17943600, "num_env_steps_sampled": 17943600, "num_env_steps_trained": 17943600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 720.8311634566197, "num_env_steps_trained_throughput_per_sec": 720.8311634566197, "timesteps_total": 17943600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17943600, "timers": {"training_iteration_time_ms": 61298.92, "sample_time_ms": 60175.519, "load_time_ms": 16.601, "load_throughput": 2645572.111, "learn_time_ms": 1105.727, "learn_throughput": 39720.49, "synch_weights_time_ms": 0.906}, "counters": {"num_env_steps_sampled": 17943600, "num_env_steps_trained": 17943600, "num_agent_steps_sampled": 17943600, "num_agent_steps_trained": 17943600}, "done": false, "episodes_total": 7861, "training_iteration": 2038, "trial_id": "e8087_00000", "date": "2023-08-06_14-16-17", "timestamp": 1691320577, "time_this_iter_s": 60.93262505531311, "time_total_s": 42680.80876994133, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13200.037341594696, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 16.694186046511625, "ram_util_percent": 71.35697674418607}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1777227195984, "policy_loss": -1974397.7760326508, "vf_loss": 4347256.207543732}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 105301.5, "diff_num_grad_updates_vs_sampler_policy": 105300.5}}, "num_env_steps_sampled": 17987520, "num_env_steps_trained": 17987520, "num_agent_steps_sampled": 17987520, "num_agent_steps_trained": 17987520}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159003.46928614422, "episode_reward_mean": -154865.66965642385, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4503456846018188, "mean_inference_ms": 0.4641209187154482, "mean_action_processing_ms": 0.08945339918741389, "mean_env_wait_ms": 0.8088338957063193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035440921783447266, "StateBufferConnector_ms": 0.0025589466094970703, "ViewRequirementAgentConnector_ms": 0.06648564338684082}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159003.46928614422, "episode_reward_mean": -154865.66965642385, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156975.75539913066, -157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4503456846018188, "mean_inference_ms": 0.4641209187154482, "mean_action_processing_ms": 0.08945339918741389, "mean_env_wait_ms": 0.8088338957063193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035440921783447266, "StateBufferConnector_ms": 0.0025589466094970703, "ViewRequirementAgentConnector_ms": 0.06648564338684082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17987520, "num_agent_steps_trained": 17987520, "num_env_steps_sampled": 17987520, "num_env_steps_trained": 17987520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.7387371336317, "num_env_steps_trained_throughput_per_sec": 714.7387371336317, "timesteps_total": 17987520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 17987520, "timers": {"training_iteration_time_ms": 61331.147, "sample_time_ms": 60206.837, "load_time_ms": 16.736, "load_throughput": 2624308.096, "learn_time_ms": 1106.493, "learn_throughput": 39692.979, "synch_weights_time_ms": 0.916}, "counters": {"num_env_steps_sampled": 17987520, "num_env_steps_trained": 17987520, "num_agent_steps_sampled": 17987520, "num_agent_steps_trained": 17987520}, "done": false, "episodes_total": 7862, "training_iteration": 2039, "trial_id": "e8087_00000", "date": "2023-08-06_14-17-19", "timestamp": 1691320639, "time_this_iter_s": 61.45191812515259, "time_total_s": 42742.26068806648, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13261.489259719849, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 17.597701149425294, "ram_util_percent": 71.36206896551725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.05920895056545, "policy_loss": -2254767.568365069, "vf_loss": 4783224.764486152}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 105987.5, "diff_num_grad_updates_vs_sampler_policy": 105986.5}}, "num_env_steps_sampled": 18031440, "num_env_steps_trained": 18031440, "num_agent_steps_sampled": 18031440, "num_agent_steps_trained": 18031440}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154888.07833688392, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4531555609698673, "mean_inference_ms": 0.46543755201654596, "mean_action_processing_ms": 0.08945461501832369, "mean_env_wait_ms": 0.8103237005093631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545045852661133, "StateBufferConnector_ms": 0.0025551319122314453, "ViewRequirementAgentConnector_ms": 0.06649923324584961}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154888.07833688392, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157714.37926836574, -157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4531555609698673, "mean_inference_ms": 0.46543755201654596, "mean_action_processing_ms": 0.08945461501832369, "mean_env_wait_ms": 0.8103237005093631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545045852661133, "StateBufferConnector_ms": 0.0025551319122314453, "ViewRequirementAgentConnector_ms": 0.06649923324584961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18031440, "num_agent_steps_trained": 18031440, "num_env_steps_sampled": 18031440, "num_env_steps_trained": 18031440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.6904374134227, "num_env_steps_trained_throughput_per_sec": 718.6904374134227, "timesteps_total": 18031440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18031440, "timers": {"training_iteration_time_ms": 61308.043, "sample_time_ms": 60183.215, "load_time_ms": 16.783, "load_throughput": 2616963.693, "learn_time_ms": 1106.963, "learn_throughput": 39676.112, "synch_weights_time_ms": 0.918}, "counters": {"num_env_steps_sampled": 18031440, "num_env_steps_trained": 18031440, "num_agent_steps_sampled": 18031440, "num_agent_steps_trained": 18031440}, "done": false, "episodes_total": 7863, "training_iteration": 2040, "trial_id": "e8087_00000", "date": "2023-08-06_14-18-20", "timestamp": 1691320700, "time_this_iter_s": 61.114617109298706, "time_total_s": 42803.37530517578, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13322.603876829147, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 17.416279069767437, "ram_util_percent": 71.34534883720931}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.02012674314983, "policy_loss": -2307810.787103681, "vf_loss": 4438401.21018586}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 106673.5, "diff_num_grad_updates_vs_sampler_policy": 106672.5}}, "num_env_steps_sampled": 18075360, "num_env_steps_trained": 18075360, "num_agent_steps_sampled": 18075360, "num_agent_steps_trained": 18075360}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154858.92983150267, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45594705031152133, "mean_inference_ms": 0.4667455872506138, "mean_action_processing_ms": 0.08945581236917706, "mean_env_wait_ms": 0.8118033941817715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003542661666870117, "StateBufferConnector_ms": 0.0025527477264404297, "ViewRequirementAgentConnector_ms": 0.06651496887207031}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154858.92983150267, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157202.17793499358, -153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45594705031152133, "mean_inference_ms": 0.4667455872506138, "mean_action_processing_ms": 0.08945581236917706, "mean_env_wait_ms": 0.8118033941817715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003542661666870117, "StateBufferConnector_ms": 0.0025527477264404297, "ViewRequirementAgentConnector_ms": 0.06651496887207031}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18075360, "num_agent_steps_trained": 18075360, "num_env_steps_sampled": 18075360, "num_env_steps_trained": 18075360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.045165677752, "num_env_steps_trained_throughput_per_sec": 713.045165677752, "timesteps_total": 18075360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18075360, "timers": {"training_iteration_time_ms": 61362.717, "sample_time_ms": 60238.045, "load_time_ms": 16.758, "load_throughput": 2620820.897, "learn_time_ms": 1106.844, "learn_throughput": 39680.385, "synch_weights_time_ms": 0.906}, "counters": {"num_env_steps_sampled": 18075360, "num_env_steps_trained": 18075360, "num_agent_steps_sampled": 18075360, "num_agent_steps_trained": 18075360}, "done": false, "episodes_total": 7864, "training_iteration": 2041, "trial_id": "e8087_00000", "date": "2023-08-06_14-19-21", "timestamp": 1691320761, "time_this_iter_s": 61.59838104248047, "time_total_s": 42864.97368621826, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13384.202257871628, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 17.147727272727273, "ram_util_percent": 71.41704545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9187107809083, "policy_loss": -2096371.217959924, "vf_loss": 4293420.807944606}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 107359.5, "diff_num_grad_updates_vs_sampler_policy": 107358.5}}, "num_env_steps_sampled": 18119280, "num_env_steps_trained": 18119280, "num_agent_steps_sampled": 18119280, "num_agent_steps_trained": 18119280}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154815.34752089906, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4587203116102561, "mean_inference_ms": 0.46804567275017755, "mean_action_processing_ms": 0.08945700995430665, "mean_env_wait_ms": 0.8132735829850972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035398006439208984, "StateBufferConnector_ms": 0.002553701400756836, "ViewRequirementAgentConnector_ms": 0.06653499603271484}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154815.34752089906, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153752.43062225956, -152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4587203116102561, "mean_inference_ms": 0.46804567275017755, "mean_action_processing_ms": 0.08945700995430665, "mean_env_wait_ms": 0.8132735829850972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035398006439208984, "StateBufferConnector_ms": 0.002553701400756836, "ViewRequirementAgentConnector_ms": 0.06653499603271484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18119280, "num_agent_steps_trained": 18119280, "num_env_steps_sampled": 18119280, "num_env_steps_trained": 18119280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.0532556052083, "num_env_steps_trained_throughput_per_sec": 714.0532556052083, "timesteps_total": 18119280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18119280, "timers": {"training_iteration_time_ms": 61343.625, "sample_time_ms": 60227.58, "load_time_ms": 16.691, "load_throughput": 2631291.617, "learn_time_ms": 1098.274, "learn_throughput": 39990.036, "synch_weights_time_ms": 0.918}, "counters": {"num_env_steps_sampled": 18119280, "num_env_steps_trained": 18119280, "num_agent_steps_sampled": 18119280, "num_agent_steps_trained": 18119280}, "done": false, "episodes_total": 7865, "training_iteration": 2042, "trial_id": "e8087_00000", "date": "2023-08-06_14-20-23", "timestamp": 1691320823, "time_this_iter_s": 61.5108540058136, "time_total_s": 42926.484540224075, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13445.713111877441, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 17.644827586206898, "ram_util_percent": 71.42988505747127}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9856143873565, "policy_loss": -2202364.3408943377, "vf_loss": 4582677.907798834}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 108045.5, "diff_num_grad_updates_vs_sampler_policy": 108044.5}}, "num_env_steps_sampled": 18163200, "num_env_steps_trained": 18163200, "num_agent_steps_sampled": 18163200, "num_agent_steps_trained": 18163200}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154844.53385507475, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4614761989954991, "mean_inference_ms": 0.4693376923960227, "mean_action_processing_ms": 0.0894581963413202, "mean_env_wait_ms": 0.8147349152265351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003534555435180664, "StateBufferConnector_ms": 0.002550840377807617, "ViewRequirementAgentConnector_ms": 0.06644654273986816}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154844.53385507475, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152027.36340401723, -156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4614761989954991, "mean_inference_ms": 0.4693376923960227, "mean_action_processing_ms": 0.0894581963413202, "mean_env_wait_ms": 0.8147349152265351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003534555435180664, "StateBufferConnector_ms": 0.002550840377807617, "ViewRequirementAgentConnector_ms": 0.06644654273986816}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18163200, "num_agent_steps_trained": 18163200, "num_env_steps_sampled": 18163200, "num_env_steps_trained": 18163200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.226821099266, "num_env_steps_trained_throughput_per_sec": 713.226821099266, "timesteps_total": 18163200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18163200, "timers": {"training_iteration_time_ms": 61386.809, "sample_time_ms": 60270.585, "load_time_ms": 16.79, "load_throughput": 2615886.007, "learn_time_ms": 1098.351, "learn_throughput": 39987.229, "synch_weights_time_ms": 0.921}, "counters": {"num_env_steps_sampled": 18163200, "num_env_steps_trained": 18163200, "num_agent_steps_sampled": 18163200, "num_agent_steps_trained": 18163200}, "done": false, "episodes_total": 7866, "training_iteration": 2043, "trial_id": "e8087_00000", "date": "2023-08-06_14-21-25", "timestamp": 1691320885, "time_this_iter_s": 61.5828537940979, "time_total_s": 42988.06739401817, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13507.29596567154, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 17.13218390804598, "ram_util_percent": 71.38620689655174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.99147291711745, "policy_loss": -1872208.211996629, "vf_loss": 4434871.760659621}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 108731.5, "diff_num_grad_updates_vs_sampler_policy": 108730.5}}, "num_env_steps_sampled": 18207120, "num_env_steps_trained": 18207120, "num_agent_steps_sampled": 18207120, "num_agent_steps_trained": 18207120}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154871.43717523382, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4642147813508486, "mean_inference_ms": 0.4706212789499039, "mean_action_processing_ms": 0.08945935752477141, "mean_env_wait_ms": 0.8161845731549374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035316944122314453, "StateBufferConnector_ms": 0.0025506019592285156, "ViewRequirementAgentConnector_ms": 0.06644082069396973}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154871.43717523382, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156553.17524315888, -152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4642147813508486, "mean_inference_ms": 0.4706212789499039, "mean_action_processing_ms": 0.08945935752477141, "mean_env_wait_ms": 0.8161845731549374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035316944122314453, "StateBufferConnector_ms": 0.0025506019592285156, "ViewRequirementAgentConnector_ms": 0.06644082069396973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18207120, "num_agent_steps_trained": 18207120, "num_env_steps_sampled": 18207120, "num_env_steps_trained": 18207120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.17008367816, "num_env_steps_trained_throughput_per_sec": 717.17008367816, "timesteps_total": 18207120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18207120, "timers": {"training_iteration_time_ms": 61320.198, "sample_time_ms": 60197.664, "load_time_ms": 16.799, "load_throughput": 2614478.92, "learn_time_ms": 1104.659, "learn_throughput": 39758.877, "synch_weights_time_ms": 0.914}, "counters": {"num_env_steps_sampled": 18207120, "num_env_steps_trained": 18207120, "num_agent_steps_sampled": 18207120, "num_agent_steps_trained": 18207120}, "done": false, "episodes_total": 7867, "training_iteration": 2044, "trial_id": "e8087_00000", "date": "2023-08-06_14-22-26", "timestamp": 1691320946, "time_this_iter_s": 61.243711948394775, "time_total_s": 43049.31110596657, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13568.539677619934, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 17.195348837209306, "ram_util_percent": 71.3825581395349}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.2007830650396, "policy_loss": -2103629.21505159, "vf_loss": 4645419.765123907}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 109417.5, "diff_num_grad_updates_vs_sampler_policy": 109416.5}}, "num_env_steps_sampled": 18251040, "num_env_steps_trained": 18251040, "num_agent_steps_sampled": 18251040, "num_agent_steps_trained": 18251040}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154882.25803477658, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46693621257176915, "mean_inference_ms": 0.47189710793144635, "mean_action_processing_ms": 0.08946057040758303, "mean_env_wait_ms": 0.8176269975750259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003530263900756836, "StateBufferConnector_ms": 0.0025506019592285156, "ViewRequirementAgentConnector_ms": 0.06643176078796387}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154882.25803477658, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152644.79168805608, -154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46693621257176915, "mean_inference_ms": 0.47189710793144635, "mean_action_processing_ms": 0.08946057040758303, "mean_env_wait_ms": 0.8176269975750259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003530263900756836, "StateBufferConnector_ms": 0.0025506019592285156, "ViewRequirementAgentConnector_ms": 0.06643176078796387}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18251040, "num_agent_steps_trained": 18251040, "num_env_steps_sampled": 18251040, "num_env_steps_trained": 18251040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.2500710886551, "num_env_steps_trained_throughput_per_sec": 715.2500710886551, "timesteps_total": 18251040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18251040, "timers": {"training_iteration_time_ms": 61317.077, "sample_time_ms": 60195.14, "load_time_ms": 16.771, "load_throughput": 2618749.402, "learn_time_ms": 1104.09, "learn_throughput": 39779.371, "synch_weights_time_ms": 0.915}, "counters": {"num_env_steps_sampled": 18251040, "num_env_steps_trained": 18251040, "num_agent_steps_sampled": 18251040, "num_agent_steps_trained": 18251040}, "done": false, "episodes_total": 7868, "training_iteration": 2045, "trial_id": "e8087_00000", "date": "2023-08-06_14-23-27", "timestamp": 1691321007, "time_this_iter_s": 61.40800189971924, "time_total_s": 43110.71910786629, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13629.947679519653, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 17.90114942528736, "ram_util_percent": 71.36551724137932}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.2251342684465, "policy_loss": -1889346.5762345116, "vf_loss": 4615563.280976676}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 110103.5, "diff_num_grad_updates_vs_sampler_policy": 110102.5}}, "num_env_steps_sampled": 18294960, "num_env_steps_trained": 18294960, "num_agent_steps_sampled": 18294960, "num_agent_steps_trained": 18294960}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154924.2593955598, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46964049083240994, "mean_inference_ms": 0.47316520702328135, "mean_action_processing_ms": 0.08946169285592037, "mean_env_wait_ms": 0.8190591173836447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003532886505126953, "StateBufferConnector_ms": 0.0025565624237060547, "ViewRequirementAgentConnector_ms": 0.06645655632019043}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154924.2593955598, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154232.78809057508, -154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46964049083240994, "mean_inference_ms": 0.47316520702328135, "mean_action_processing_ms": 0.08946169285592037, "mean_env_wait_ms": 0.8190591173836447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003532886505126953, "StateBufferConnector_ms": 0.0025565624237060547, "ViewRequirementAgentConnector_ms": 0.06645655632019043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18294960, "num_agent_steps_trained": 18294960, "num_env_steps_sampled": 18294960, "num_env_steps_trained": 18294960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.6581184536218, "num_env_steps_trained_throughput_per_sec": 717.6581184536218, "timesteps_total": 18294960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18294960, "timers": {"training_iteration_time_ms": 61347.477, "sample_time_ms": 60225.873, "load_time_ms": 16.82, "load_throughput": 2611169.519, "learn_time_ms": 1103.699, "learn_throughput": 39793.474, "synch_weights_time_ms": 0.924}, "counters": {"num_env_steps_sampled": 18294960, "num_env_steps_trained": 18294960, "num_agent_steps_sampled": 18294960, "num_agent_steps_trained": 18294960}, "done": false, "episodes_total": 7869, "training_iteration": 2046, "trial_id": "e8087_00000", "date": "2023-08-06_14-24-29", "timestamp": 1691321069, "time_this_iter_s": 61.2018620967865, "time_total_s": 43171.920969963074, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13691.14954161644, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 16.637931034482754, "ram_util_percent": 71.39540229885057}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0554023942864, "policy_loss": -2074236.8672786078, "vf_loss": 4474341.2684948975}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 110789.5, "diff_num_grad_updates_vs_sampler_policy": 110788.5}}, "num_env_steps_sampled": 18338880, "num_env_steps_trained": 18338880, "num_agent_steps_sampled": 18338880, "num_agent_steps_trained": 18338880}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154935.2404904349, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4723284023943709, "mean_inference_ms": 0.47442541799031523, "mean_action_processing_ms": 0.08946283829566422, "mean_env_wait_ms": 0.8204816549267373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035326480865478516, "StateBufferConnector_ms": 0.0025603771209716797, "ViewRequirementAgentConnector_ms": 0.06646609306335449}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154935.2404904349, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154478.82272058714, -155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4723284023943709, "mean_inference_ms": 0.47442541799031523, "mean_action_processing_ms": 0.08946283829566422, "mean_env_wait_ms": 0.8204816549267373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035326480865478516, "StateBufferConnector_ms": 0.0025603771209716797, "ViewRequirementAgentConnector_ms": 0.06646609306335449}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18338880, "num_agent_steps_trained": 18338880, "num_env_steps_sampled": 18338880, "num_env_steps_trained": 18338880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.8192064138136, "num_env_steps_trained_throughput_per_sec": 717.8192064138136, "timesteps_total": 18338880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18338880, "timers": {"training_iteration_time_ms": 61320.209, "sample_time_ms": 60198.292, "load_time_ms": 16.814, "load_throughput": 2612098.862, "learn_time_ms": 1104.027, "learn_throughput": 39781.634, "synch_weights_time_ms": 0.916}, "counters": {"num_env_steps_sampled": 18338880, "num_env_steps_trained": 18338880, "num_agent_steps_sampled": 18338880, "num_agent_steps_trained": 18338880}, "done": false, "episodes_total": 7870, "training_iteration": 2047, "trial_id": "e8087_00000", "date": "2023-08-06_14-25-30", "timestamp": 1691321130, "time_this_iter_s": 61.18820595741272, "time_total_s": 43233.10917592049, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13752.337747573853, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 17.942528735632187, "ram_util_percent": 71.42643678160918}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.312500000000001e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.87866771464445, "policy_loss": -2254060.559040748, "vf_loss": 4436952.817784256}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 111475.5, "diff_num_grad_updates_vs_sampler_policy": 111474.5}}, "num_env_steps_sampled": 18382800, "num_env_steps_trained": 18382800, "num_agent_steps_sampled": 18382800, "num_agent_steps_trained": 18382800}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154937.3089027567, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4749998833180619, "mean_inference_ms": 0.4756776328093231, "mean_action_processing_ms": 0.08946392895194272, "mean_env_wait_ms": 0.8218970612095536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035305023193359375, "StateBufferConnector_ms": 0.0025625228881835938, "ViewRequirementAgentConnector_ms": 0.06645655632019043}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154937.3089027567, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155889.47919034518, -153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4749998833180619, "mean_inference_ms": 0.4756776328093231, "mean_action_processing_ms": 0.08946392895194272, "mean_env_wait_ms": 0.8218970612095536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035305023193359375, "StateBufferConnector_ms": 0.0025625228881835938, "ViewRequirementAgentConnector_ms": 0.06645655632019043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18382800, "num_agent_steps_trained": 18382800, "num_env_steps_sampled": 18382800, "num_env_steps_trained": 18382800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.2242589874738, "num_env_steps_trained_throughput_per_sec": 717.2242589874738, "timesteps_total": 18382800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18382800, "timers": {"training_iteration_time_ms": 61350.85, "sample_time_ms": 60230.049, "load_time_ms": 16.906, "load_throughput": 2597835.746, "learn_time_ms": 1102.814, "learn_throughput": 39825.406, "synch_weights_time_ms": 0.92}, "counters": {"num_env_steps_sampled": 18382800, "num_env_steps_trained": 18382800, "num_agent_steps_sampled": 18382800, "num_agent_steps_trained": 18382800}, "done": false, "episodes_total": 7871, "training_iteration": 2048, "trial_id": "e8087_00000", "date": "2023-08-06_14-26-31", "timestamp": 1691321191, "time_this_iter_s": 61.239169120788574, "time_total_s": 43294.348345041275, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13813.576916694641, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 17.230232558139534, "ram_util_percent": 71.38953488372093}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.1250000000000007e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9414248007727, "policy_loss": -1759940.391829332, "vf_loss": 4220454.938411078}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 112161.5, "diff_num_grad_updates_vs_sampler_policy": 112160.5}}, "num_env_steps_sampled": 18426720, "num_env_steps_trained": 18426720, "num_agent_steps_sampled": 18426720, "num_agent_steps_trained": 18426720}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154899.77594651643, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4776548673072044, "mean_inference_ms": 0.4769219528840631, "mean_action_processing_ms": 0.08946498316788123, "mean_env_wait_ms": 0.8233035609551436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003530740737915039, "StateBufferConnector_ms": 0.002560853958129883, "ViewRequirementAgentConnector_ms": 0.06647634506225586}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154899.77594651643, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153578.7530493595, -154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4776548673072044, "mean_inference_ms": 0.4769219528840631, "mean_action_processing_ms": 0.08946498316788123, "mean_env_wait_ms": 0.8233035609551436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003530740737915039, "StateBufferConnector_ms": 0.002560853958129883, "ViewRequirementAgentConnector_ms": 0.06647634506225586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18426720, "num_agent_steps_trained": 18426720, "num_env_steps_sampled": 18426720, "num_env_steps_trained": 18426720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.9755746701879, "num_env_steps_trained_throughput_per_sec": 718.9755746701879, "timesteps_total": 18426720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18426720, "timers": {"training_iteration_time_ms": 61314.638, "sample_time_ms": 60194.334, "load_time_ms": 16.684, "load_throughput": 2632528.748, "learn_time_ms": 1102.545, "learn_throughput": 39835.104, "synch_weights_time_ms": 0.915}, "counters": {"num_env_steps_sampled": 18426720, "num_env_steps_trained": 18426720, "num_agent_steps_sampled": 18426720, "num_agent_steps_trained": 18426720}, "done": false, "episodes_total": 7872, "training_iteration": 2049, "trial_id": "e8087_00000", "date": "2023-08-06_14-27-32", "timestamp": 1691321252, "time_this_iter_s": 61.089842081069946, "time_total_s": 43355.438187122345, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13874.666758775711, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 17.470114942528735, "ram_util_percent": 71.39655172413794}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.9375000000000003e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.95825831466095, "policy_loss": -1913219.2513267584, "vf_loss": 4300820.236333819}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 112847.5, "diff_num_grad_updates_vs_sampler_policy": 112846.5}}, "num_env_steps_sampled": 18470640, "num_env_steps_trained": 18470640, "num_agent_steps_sampled": 18470640, "num_agent_steps_trained": 18470640}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154892.7222290713, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802941514711847, "mean_inference_ms": 0.4781585623474401, "mean_action_processing_ms": 0.08946602931083411, "mean_env_wait_ms": 0.8247016049879562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003529787063598633, "StateBufferConnector_ms": 0.00255584716796875, "ViewRequirementAgentConnector_ms": 0.06646347045898438}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154892.7222290713, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154507.74606606344, -155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802941514711847, "mean_inference_ms": 0.4781585623474401, "mean_action_processing_ms": 0.08946602931083411, "mean_env_wait_ms": 0.8247016049879562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003529787063598633, "StateBufferConnector_ms": 0.00255584716796875, "ViewRequirementAgentConnector_ms": 0.06646347045898438}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18470640, "num_agent_steps_trained": 18470640, "num_env_steps_sampled": 18470640, "num_env_steps_trained": 18470640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.0970736044915, "num_env_steps_trained_throughput_per_sec": 717.0970736044915, "timesteps_total": 18470640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18470640, "timers": {"training_iteration_time_ms": 61328.217, "sample_time_ms": 60208.178, "load_time_ms": 16.768, "load_throughput": 2619255.796, "learn_time_ms": 1102.18, "learn_throughput": 39848.316, "synch_weights_time_ms": 0.931}, "counters": {"num_env_steps_sampled": 18470640, "num_env_steps_trained": 18470640, "num_agent_steps_sampled": 18470640, "num_agent_steps_trained": 18470640}, "done": false, "episodes_total": 7873, "training_iteration": 2050, "trial_id": "e8087_00000", "date": "2023-08-06_14-28-33", "timestamp": 1691321313, "time_this_iter_s": 61.249955892562866, "time_total_s": 43416.68814301491, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13935.916714668274, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 17.380459770114943, "ram_util_percent": 71.38735632183909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.75e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0007681443462, "policy_loss": -2135687.5103862975, "vf_loss": 4349933.838921282}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 113533.5, "diff_num_grad_updates_vs_sampler_policy": 113532.5}}, "num_env_steps_sampled": 18514560, "num_env_steps_trained": 18514560, "num_agent_steps_sampled": 18514560, "num_agent_steps_trained": 18514560}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154885.49939071084, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4829174766644607, "mean_inference_ms": 0.47938757799473763, "mean_action_processing_ms": 0.08946706997732369, "mean_env_wait_ms": 0.8260919612533817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035314559936523438, "StateBufferConnector_ms": 0.0025544166564941406, "ViewRequirementAgentConnector_ms": 0.06647229194641113}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154885.49939071084, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155904.86119217402, -154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4829174766644607, "mean_inference_ms": 0.47938757799473763, "mean_action_processing_ms": 0.08946706997732369, "mean_env_wait_ms": 0.8260919612533817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035314559936523438, "StateBufferConnector_ms": 0.0025544166564941406, "ViewRequirementAgentConnector_ms": 0.06647229194641113}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18514560, "num_agent_steps_trained": 18514560, "num_env_steps_sampled": 18514560, "num_env_steps_trained": 18514560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.4526690665174, "num_env_steps_trained_throughput_per_sec": 716.4526690665174, "timesteps_total": 18514560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18514560, "timers": {"training_iteration_time_ms": 61298.922, "sample_time_ms": 60179.428, "load_time_ms": 16.781, "load_throughput": 2617272.298, "learn_time_ms": 1101.623, "learn_throughput": 39868.457, "synch_weights_time_ms": 0.93}, "counters": {"num_env_steps_sampled": 18514560, "num_env_steps_trained": 18514560, "num_agent_steps_sampled": 18514560, "num_agent_steps_trained": 18514560}, "done": false, "episodes_total": 7874, "training_iteration": 2051, "trial_id": "e8087_00000", "date": "2023-08-06_14-29-35", "timestamp": 1691321375, "time_this_iter_s": 61.30503606796265, "time_total_s": 43477.99317908287, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13997.221750736237, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 17.479069767441857, "ram_util_percent": 71.4220930232558}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.5624999999999997e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0422007391126, "policy_loss": -2122620.6417353773, "vf_loss": 4387187.691873178}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 114219.5, "diff_num_grad_updates_vs_sampler_policy": 114218.5}}, "num_env_steps_sampled": 18558480, "num_env_steps_trained": 18558480, "num_agent_steps_sampled": 18558480, "num_agent_steps_trained": 18558480}, "sampler_results": {"episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154868.97732827262, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48552551435951385, "mean_inference_ms": 0.4806091761073098, "mean_action_processing_ms": 0.08946810515313203, "mean_env_wait_ms": 0.8274760367193025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003537416458129883, "StateBufferConnector_ms": 0.002554655075073242, "ViewRequirementAgentConnector_ms": 0.06653070449829102}}, "episode_reward_max": -150445.75117824425, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154868.97732827262, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154046.5061380403, -154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48552551435951385, "mean_inference_ms": 0.4806091761073098, "mean_action_processing_ms": 0.08946810515313203, "mean_env_wait_ms": 0.8274760367193025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003537416458129883, "StateBufferConnector_ms": 0.002554655075073242, "ViewRequirementAgentConnector_ms": 0.06653070449829102}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18558480, "num_agent_steps_trained": 18558480, "num_env_steps_sampled": 18558480, "num_env_steps_trained": 18558480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.6189840441039, "num_env_steps_trained_throughput_per_sec": 712.6189840441039, "timesteps_total": 18558480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18558480, "timers": {"training_iteration_time_ms": 61311.301, "sample_time_ms": 60191.69, "load_time_ms": 16.826, "load_throughput": 2610222.344, "learn_time_ms": 1101.71, "learn_throughput": 39865.315, "synch_weights_time_ms": 0.917}, "counters": {"num_env_steps_sampled": 18558480, "num_env_steps_trained": 18558480, "num_agent_steps_sampled": 18558480, "num_agent_steps_trained": 18558480}, "done": false, "episodes_total": 7875, "training_iteration": 2052, "trial_id": "e8087_00000", "date": "2023-08-06_14-30-36", "timestamp": 1691321436, "time_this_iter_s": 61.63465476036072, "time_total_s": 43539.62783384323, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14058.856405496597, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 16.898863636363636, "ram_util_percent": 71.41931818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.3750000000000003e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.83783951028096, "policy_loss": -1946004.0297495672, "vf_loss": 4098738.337281341}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 114905.5, "diff_num_grad_updates_vs_sampler_policy": 114904.5}}, "num_env_steps_sampled": 18602400, "num_env_steps_trained": 18602400, "num_agent_steps_sampled": 18602400, "num_agent_steps_trained": 18602400}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154832.92625285182, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4881182208716212, "mean_inference_ms": 0.4818234591073103, "mean_action_processing_ms": 0.08946911175323276, "mean_env_wait_ms": 0.828852144375881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003539562225341797, "StateBufferConnector_ms": 0.0025565624237060547, "ViewRequirementAgentConnector_ms": 0.06652617454528809}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154832.92625285182, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154959.43671434326, -154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4881182208716212, "mean_inference_ms": 0.4818234591073103, "mean_action_processing_ms": 0.08946911175323276, "mean_env_wait_ms": 0.828852144375881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003539562225341797, "StateBufferConnector_ms": 0.0025565624237060547, "ViewRequirementAgentConnector_ms": 0.06652617454528809}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18602400, "num_agent_steps_trained": 18602400, "num_env_steps_sampled": 18602400, "num_env_steps_trained": 18602400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.9362546793986, "num_env_steps_trained_throughput_per_sec": 718.9362546793986, "timesteps_total": 18602400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18602400, "timers": {"training_iteration_time_ms": 61262.397, "sample_time_ms": 60143.76, "load_time_ms": 16.818, "load_throughput": 2611461.95, "learn_time_ms": 1100.731, "learn_throughput": 39900.764, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 18602400, "num_env_steps_trained": 18602400, "num_agent_steps_sampled": 18602400, "num_agent_steps_trained": 18602400}, "done": false, "episodes_total": 7876, "training_iteration": 2053, "trial_id": "e8087_00000", "date": "2023-08-06_14-31-38", "timestamp": 1691321498, "time_this_iter_s": 61.09354591369629, "time_total_s": 43600.72137975693, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14119.949951410294, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 19.50232558139535, "ram_util_percent": 71.20813953488373}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1875000000000003e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.4639468624015, "policy_loss": -1803683.7556145226, "vf_loss": 4618251.067419825}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 115591.5, "diff_num_grad_updates_vs_sampler_policy": 115590.5}}, "num_env_steps_sampled": 18646320, "num_env_steps_trained": 18646320, "num_agent_steps_sampled": 18646320, "num_agent_steps_trained": 18646320}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154855.32710513275, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4906954879810984, "mean_inference_ms": 0.4830302213177955, "mean_action_processing_ms": 0.0894700638840524, "mean_env_wait_ms": 0.8302200024661538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035398006439208984, "StateBufferConnector_ms": 0.002557039260864258, "ViewRequirementAgentConnector_ms": 0.06653761863708496}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154855.32710513275, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154909.4701830292, -155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4906954879810984, "mean_inference_ms": 0.4830302213177955, "mean_action_processing_ms": 0.0894700638840524, "mean_env_wait_ms": 0.8302200024661538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035398006439208984, "StateBufferConnector_ms": 0.002557039260864258, "ViewRequirementAgentConnector_ms": 0.06653761863708496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18646320, "num_agent_steps_trained": 18646320, "num_env_steps_sampled": 18646320, "num_env_steps_trained": 18646320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 723.0960837870247, "num_env_steps_trained_throughput_per_sec": 723.0960837870247, "timesteps_total": 18646320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18646320, "timers": {"training_iteration_time_ms": 61212.208, "sample_time_ms": 60093.876, "load_time_ms": 16.762, "load_throughput": 2620231.901, "learn_time_ms": 1100.477, "learn_throughput": 39909.97, "synch_weights_time_ms": 0.928}, "counters": {"num_env_steps_sampled": 18646320, "num_env_steps_trained": 18646320, "num_agent_steps_sampled": 18646320, "num_agent_steps_trained": 18646320}, "done": false, "episodes_total": 7877, "training_iteration": 2054, "trial_id": "e8087_00000", "date": "2023-08-06_14-32-38", "timestamp": 1691321558, "time_this_iter_s": 60.74197316169739, "time_total_s": 43661.463352918625, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14180.691924571991, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 16.819767441860463, "ram_util_percent": 71.06162790697675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1765352922, "policy_loss": -2167829.798147663, "vf_loss": 4641218.336552478}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 116277.5, "diff_num_grad_updates_vs_sampler_policy": 116276.5}}, "num_env_steps_sampled": 18690240, "num_env_steps_trained": 18690240, "num_agent_steps_sampled": 18690240, "num_agent_steps_trained": 18690240}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154883.8724178639, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49325755278306405, "mean_inference_ms": 0.48422999628574986, "mean_action_processing_ms": 0.08947098905867273, "mean_env_wait_ms": 0.8315802339887678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035400390625, "StateBufferConnector_ms": 0.002554655075073242, "ViewRequirementAgentConnector_ms": 0.06653666496276855}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154883.8724178639, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155272.48805592814, -155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49325755278306405, "mean_inference_ms": 0.48422999628574986, "mean_action_processing_ms": 0.08947098905867273, "mean_env_wait_ms": 0.8315802339887678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035400390625, "StateBufferConnector_ms": 0.002554655075073242, "ViewRequirementAgentConnector_ms": 0.06653666496276855}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18690240, "num_agent_steps_trained": 18690240, "num_env_steps_sampled": 18690240, "num_env_steps_trained": 18690240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.9863981140307, "num_env_steps_trained_throughput_per_sec": 714.9863981140307, "timesteps_total": 18690240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18690240, "timers": {"training_iteration_time_ms": 61214.472, "sample_time_ms": 60095.63, "load_time_ms": 16.713, "load_throughput": 2627853.32, "learn_time_ms": 1101.02, "learn_throughput": 39890.299, "synch_weights_time_ms": 0.942}, "counters": {"num_env_steps_sampled": 18690240, "num_env_steps_trained": 18690240, "num_agent_steps_sampled": 18690240, "num_agent_steps_trained": 18690240}, "done": false, "episodes_total": 7878, "training_iteration": 2055, "trial_id": "e8087_00000", "date": "2023-08-06_14-33-40", "timestamp": 1691321620, "time_this_iter_s": 61.431312799453735, "time_total_s": 43722.89466571808, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14242.123237371445, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 17.49770114942529, "ram_util_percent": 71.27816091954021}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9897454709423, "policy_loss": -1881709.97397162, "vf_loss": 4394051.755466472}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 116963.5, "diff_num_grad_updates_vs_sampler_policy": 116962.5}}, "num_env_steps_sampled": 18734160, "num_env_steps_trained": 18734160, "num_agent_steps_sampled": 18734160, "num_agent_steps_trained": 18734160}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154874.9450673724, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4958044459289319, "mean_inference_ms": 0.4854227600104831, "mean_action_processing_ms": 0.08947192271655453, "mean_env_wait_ms": 0.8329337148774877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003543376922607422, "StateBufferConnector_ms": 0.0025539398193359375, "ViewRequirementAgentConnector_ms": 0.06653141975402832}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154874.9450673724, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155172.7235844794, -156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4958044459289319, "mean_inference_ms": 0.4854227600104831, "mean_action_processing_ms": 0.08947192271655453, "mean_env_wait_ms": 0.8329337148774877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003543376922607422, "StateBufferConnector_ms": 0.0025539398193359375, "ViewRequirementAgentConnector_ms": 0.06653141975402832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18734160, "num_agent_steps_trained": 18734160, "num_env_steps_sampled": 18734160, "num_env_steps_trained": 18734160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.5477459413582, "num_env_steps_trained_throughput_per_sec": 715.5477459413582, "timesteps_total": 18734160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18734160, "timers": {"training_iteration_time_ms": 61232.522, "sample_time_ms": 60114.306, "load_time_ms": 16.698, "load_throughput": 2630183.323, "learn_time_ms": 1100.408, "learn_throughput": 39912.452, "synch_weights_time_ms": 0.942}, "counters": {"num_env_steps_sampled": 18734160, "num_env_steps_trained": 18734160, "num_agent_steps_sampled": 18734160, "num_agent_steps_trained": 18734160}, "done": false, "episodes_total": 7879, "training_iteration": 2056, "trial_id": "e8087_00000", "date": "2023-08-06_14-34-41", "timestamp": 1691321681, "time_this_iter_s": 61.38243508338928, "time_total_s": 43784.27710080147, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14303.505672454834, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 17.359770114942528, "ram_util_percent": 71.35287356321837}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0213192419825, "policy_loss": -2025812.5574420895, "vf_loss": 4490411.004828718}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 117649.5, "diff_num_grad_updates_vs_sampler_policy": 117648.5}}, "num_env_steps_sampled": 18778080, "num_env_steps_trained": 18778080, "num_agent_steps_sampled": 18778080, "num_agent_steps_trained": 18778080}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154871.41369005688, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49833671517943373, "mean_inference_ms": 0.48660854647618845, "mean_action_processing_ms": 0.08947285117954987, "mean_env_wait_ms": 0.8342798706770354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003541707992553711, "StateBufferConnector_ms": 0.002550363540649414, "ViewRequirementAgentConnector_ms": 0.0665428638458252}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154871.41369005688, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156918.62957854362, -155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49833671517943373, "mean_inference_ms": 0.48660854647618845, "mean_action_processing_ms": 0.08947285117954987, "mean_env_wait_ms": 0.8342798706770354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003541707992553711, "StateBufferConnector_ms": 0.002550363540649414, "ViewRequirementAgentConnector_ms": 0.0665428638458252}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18778080, "num_agent_steps_trained": 18778080, "num_env_steps_sampled": 18778080, "num_env_steps_trained": 18778080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.5020650892845, "num_env_steps_trained_throughput_per_sec": 719.5020650892845, "timesteps_total": 18778080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18778080, "timers": {"training_iteration_time_ms": 61218.211, "sample_time_ms": 60100.751, "load_time_ms": 16.907, "load_throughput": 2597700.202, "learn_time_ms": 1099.445, "learn_throughput": 39947.444, "synch_weights_time_ms": 0.941}, "counters": {"num_env_steps_sampled": 18778080, "num_env_steps_trained": 18778080, "num_agent_steps_sampled": 18778080, "num_agent_steps_trained": 18778080}, "done": false, "episodes_total": 7880, "training_iteration": 2057, "trial_id": "e8087_00000", "date": "2023-08-06_14-35-42", "timestamp": 1691321742, "time_this_iter_s": 61.045146226882935, "time_total_s": 43845.32224702835, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14364.550818681717, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 17.26279069767442, "ram_util_percent": 71.36627906976746}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0864947794478, "policy_loss": -1979870.1968456747, "vf_loss": 4434150.287172012}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 118335.5, "diff_num_grad_updates_vs_sampler_policy": 118334.5}}, "num_env_steps_sampled": 18822000, "num_env_steps_trained": 18822000, "num_agent_steps_sampled": 18822000, "num_agent_steps_trained": 18822000}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154847.66610076316, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.500854287739617, "mean_inference_ms": 0.4877875012865493, "mean_action_processing_ms": 0.08947374145412984, "mean_env_wait_ms": 0.8356194667224405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035390853881835938, "StateBufferConnector_ms": 0.002554178237915039, "ViewRequirementAgentConnector_ms": 0.06654238700866699}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154847.66610076316, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155733.29033617515, -152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.500854287739617, "mean_inference_ms": 0.4877875012865493, "mean_action_processing_ms": 0.08947374145412984, "mean_env_wait_ms": 0.8356194667224405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035390853881835938, "StateBufferConnector_ms": 0.002554178237915039, "ViewRequirementAgentConnector_ms": 0.06654238700866699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18822000, "num_agent_steps_trained": 18822000, "num_env_steps_sampled": 18822000, "num_env_steps_trained": 18822000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.6848354651497, "num_env_steps_trained_throughput_per_sec": 719.6848354651497, "timesteps_total": 18822000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18822000, "timers": {"training_iteration_time_ms": 61197.275, "sample_time_ms": 60078.758, "load_time_ms": 16.813, "load_throughput": 2612198.871, "learn_time_ms": 1100.601, "learn_throughput": 39905.464, "synch_weights_time_ms": 0.936}, "counters": {"num_env_steps_sampled": 18822000, "num_env_steps_trained": 18822000, "num_agent_steps_sampled": 18822000, "num_agent_steps_trained": 18822000}, "done": false, "episodes_total": 7881, "training_iteration": 2058, "trial_id": "e8087_00000", "date": "2023-08-06_14-36-43", "timestamp": 1691321803, "time_this_iter_s": 61.0296151638031, "time_total_s": 43906.351862192154, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14425.58043384552, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 16.95057471264368, "ram_util_percent": 71.36781609195403}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.8591875793635, "policy_loss": -2135197.6735434127, "vf_loss": 4229463.008108601}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 119021.5, "diff_num_grad_updates_vs_sampler_policy": 119020.5}}, "num_env_steps_sampled": 18865920, "num_env_steps_trained": 18865920, "num_agent_steps_sampled": 18865920, "num_agent_steps_trained": 18865920}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154809.8285355796, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5033574780101128, "mean_inference_ms": 0.48895974638918976, "mean_action_processing_ms": 0.08947464611055066, "mean_env_wait_ms": 0.8369512443529286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035414695739746094, "StateBufferConnector_ms": 0.0025565624237060547, "ViewRequirementAgentConnector_ms": 0.06657099723815918}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154809.8285355796, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152214.19103218647, -151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5033574780101128, "mean_inference_ms": 0.48895974638918976, "mean_action_processing_ms": 0.08947464611055066, "mean_env_wait_ms": 0.8369512443529286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035414695739746094, "StateBufferConnector_ms": 0.0025565624237060547, "ViewRequirementAgentConnector_ms": 0.06657099723815918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18865920, "num_agent_steps_trained": 18865920, "num_env_steps_sampled": 18865920, "num_env_steps_trained": 18865920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.2185783438496, "num_env_steps_trained_throughput_per_sec": 713.2185783438496, "timesteps_total": 18865920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18865920, "timers": {"training_iteration_time_ms": 61246.583, "sample_time_ms": 60127.992, "load_time_ms": 17.013, "load_throughput": 2581493.562, "learn_time_ms": 1100.481, "learn_throughput": 39909.819, "synch_weights_time_ms": 0.93}, "counters": {"num_env_steps_sampled": 18865920, "num_env_steps_trained": 18865920, "num_agent_steps_sampled": 18865920, "num_agent_steps_trained": 18865920}, "done": false, "episodes_total": 7882, "training_iteration": 2059, "trial_id": "e8087_00000", "date": "2023-08-06_14-37-45", "timestamp": 1691321865, "time_this_iter_s": 61.583054065704346, "time_total_s": 43967.93491625786, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14487.163487911224, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 17.580459770114942, "ram_util_percent": 71.33793103448274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9900788955021, "policy_loss": -2040245.8110593567, "vf_loss": 4335985.911260933}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 119707.5, "diff_num_grad_updates_vs_sampler_policy": 119706.5}}, "num_env_steps_sampled": 18909840, "num_env_steps_trained": 18909840, "num_agent_steps_sampled": 18909840, "num_agent_steps_trained": 18909840}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154819.9437933087, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5058460246014286, "mean_inference_ms": 0.49012530869304255, "mean_action_processing_ms": 0.08947551433108628, "mean_env_wait_ms": 0.8382738864980152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035419464111328125, "StateBufferConnector_ms": 0.0025620460510253906, "ViewRequirementAgentConnector_ms": 0.06659150123596191}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154819.9437933087, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-151174.8599329733, -156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5058460246014286, "mean_inference_ms": 0.49012530869304255, "mean_action_processing_ms": 0.08947551433108628, "mean_env_wait_ms": 0.8382738864980152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035419464111328125, "StateBufferConnector_ms": 0.0025620460510253906, "ViewRequirementAgentConnector_ms": 0.06659150123596191}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18909840, "num_agent_steps_trained": 18909840, "num_env_steps_sampled": 18909840, "num_env_steps_trained": 18909840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 722.6053100998677, "num_env_steps_trained_throughput_per_sec": 722.6053100998677, "timesteps_total": 18909840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18909840, "timers": {"training_iteration_time_ms": 61199.897, "sample_time_ms": 60081.455, "load_time_ms": 16.879, "load_throughput": 2602018.909, "learn_time_ms": 1100.474, "learn_throughput": 39910.085, "synch_weights_time_ms": 0.922}, "counters": {"num_env_steps_sampled": 18909840, "num_env_steps_trained": 18909840, "num_agent_steps_sampled": 18909840, "num_agent_steps_trained": 18909840}, "done": false, "episodes_total": 7883, "training_iteration": 2060, "trial_id": "e8087_00000", "date": "2023-08-06_14-38-46", "timestamp": 1691321926, "time_this_iter_s": 60.78297781944275, "time_total_s": 44028.7178940773, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14547.946465730667, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 17.343023255813954, "ram_util_percent": 71.34883720930233}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.3041427211928, "policy_loss": -1858965.884600492, "vf_loss": 4423001.691508747}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 120393.5, "diff_num_grad_updates_vs_sampler_policy": 120392.5}}, "num_env_steps_sampled": 18953760, "num_env_steps_trained": 18953760, "num_agent_steps_sampled": 18953760, "num_agent_steps_trained": 18953760}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154852.9710047861, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5083199634957919, "mean_inference_ms": 0.4912841312888682, "mean_action_processing_ms": 0.08947637012688095, "mean_env_wait_ms": 0.839588678135516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003540515899658203, "StateBufferConnector_ms": 0.002566099166870117, "ViewRequirementAgentConnector_ms": 0.06659698486328125}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154852.9710047861, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156150.6330881602, -157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5083199634957919, "mean_inference_ms": 0.4912841312888682, "mean_action_processing_ms": 0.08947637012688095, "mean_env_wait_ms": 0.839588678135516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003540515899658203, "StateBufferConnector_ms": 0.002566099166870117, "ViewRequirementAgentConnector_ms": 0.06659698486328125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18953760, "num_agent_steps_trained": 18953760, "num_env_steps_sampled": 18953760, "num_env_steps_trained": 18953760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 725.2311649581196, "num_env_steps_trained_throughput_per_sec": 725.2311649581196, "timesteps_total": 18953760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18953760, "timers": {"training_iteration_time_ms": 61125.694, "sample_time_ms": 60006.67, "load_time_ms": 16.935, "load_throughput": 2593490.738, "learn_time_ms": 1101.003, "learn_throughput": 39890.917, "synch_weights_time_ms": 0.921}, "counters": {"num_env_steps_sampled": 18953760, "num_env_steps_trained": 18953760, "num_agent_steps_sampled": 18953760, "num_agent_steps_trained": 18953760}, "done": false, "episodes_total": 7884, "training_iteration": 2061, "trial_id": "e8087_00000", "date": "2023-08-06_14-39-46", "timestamp": 1691321986, "time_this_iter_s": 60.562925815582275, "time_total_s": 44089.28081989288, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14608.50939154625, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 17.524418604651164, "ram_util_percent": 71.36162790697674}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.95328448326177, "policy_loss": -2084705.687027378, "vf_loss": 4193183.5903790086}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 121079.5, "diff_num_grad_updates_vs_sampler_policy": 121078.5}}, "num_env_steps_sampled": 18997680, "num_env_steps_trained": 18997680, "num_agent_steps_sampled": 18997680, "num_agent_steps_trained": 18997680}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154807.1800038247, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5107799119206872, "mean_inference_ms": 0.4924364617359817, "mean_action_processing_ms": 0.08947723707874418, "mean_env_wait_ms": 0.8408966538399011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545999526977539, "StateBufferConnector_ms": 0.002563953399658203, "ViewRequirementAgentConnector_ms": 0.06662106513977051}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154807.1800038247, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157823.28267639954, -155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5107799119206872, "mean_inference_ms": 0.4924364617359817, "mean_action_processing_ms": 0.08947723707874418, "mean_env_wait_ms": 0.8408966538399011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545999526977539, "StateBufferConnector_ms": 0.002563953399658203, "ViewRequirementAgentConnector_ms": 0.06662106513977051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18997680, "num_agent_steps_trained": 18997680, "num_env_steps_sampled": 18997680, "num_env_steps_trained": 18997680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.0139056857479, "num_env_steps_trained_throughput_per_sec": 717.0139056857479, "timesteps_total": 18997680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 18997680, "timers": {"training_iteration_time_ms": 61087.917, "sample_time_ms": 59969.107, "load_time_ms": 16.89, "load_throughput": 2600310.993, "learn_time_ms": 1100.831, "learn_throughput": 39897.117, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 18997680, "num_env_steps_trained": 18997680, "num_agent_steps_sampled": 18997680, "num_agent_steps_trained": 18997680}, "done": false, "episodes_total": 7885, "training_iteration": 2062, "trial_id": "e8087_00000", "date": "2023-08-06_14-40-48", "timestamp": 1691322048, "time_this_iter_s": 61.25712013244629, "time_total_s": 44150.53794002533, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14669.766511678696, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 17.312790697674416, "ram_util_percent": 71.25116279069766}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.01419814752074, "policy_loss": -1983846.4475802318, "vf_loss": 4221124.35231414}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 121765.5, "diff_num_grad_updates_vs_sampler_policy": 121764.5}}, "num_env_steps_sampled": 19041600, "num_env_steps_trained": 19041600, "num_agent_steps_sampled": 19041600, "num_agent_steps_trained": 19041600}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154743.45588926435, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5132258988997572, "mean_inference_ms": 0.4935821026235878, "mean_action_processing_ms": 0.08947809804865631, "mean_env_wait_ms": 0.8421987784463603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003544330596923828, "StateBufferConnector_ms": 0.0025663375854492188, "ViewRequirementAgentConnector_ms": 0.06663823127746582}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154743.45588926435, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155775.0128444214, -155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5132258988997572, "mean_inference_ms": 0.4935821026235878, "mean_action_processing_ms": 0.08947809804865631, "mean_env_wait_ms": 0.8421987784463603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003544330596923828, "StateBufferConnector_ms": 0.0025663375854492188, "ViewRequirementAgentConnector_ms": 0.06663823127746582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19041600, "num_agent_steps_trained": 19041600, "num_env_steps_sampled": 19041600, "num_env_steps_trained": 19041600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.322704089212, "num_env_steps_trained_throughput_per_sec": 717.322704089212, "timesteps_total": 19041600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19041600, "timers": {"training_iteration_time_ms": 61101.661, "sample_time_ms": 59982.433, "load_time_ms": 16.813, "load_throughput": 2612224.8, "learn_time_ms": 1101.328, "learn_throughput": 39879.126, "synch_weights_time_ms": 0.927}, "counters": {"num_env_steps_sampled": 19041600, "num_env_steps_trained": 19041600, "num_agent_steps_sampled": 19041600, "num_agent_steps_trained": 19041600}, "done": false, "episodes_total": 7886, "training_iteration": 2063, "trial_id": "e8087_00000", "date": "2023-08-06_14-41-49", "timestamp": 1691322109, "time_this_iter_s": 61.231062173843384, "time_total_s": 44211.76900219917, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14730.997573852539, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 17.59310344827586, "ram_util_percent": 71.39080459770115}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.375e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1798341712173, "policy_loss": -1914181.7043407205, "vf_loss": 4429426.500273324}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 122451.5, "diff_num_grad_updates_vs_sampler_policy": 122450.5}}, "num_env_steps_sampled": 19085520, "num_env_steps_trained": 19085520, "num_agent_steps_sampled": 19085520, "num_agent_steps_trained": 19085520}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154733.75945166682, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5156583184964244, "mean_inference_ms": 0.49472124908841425, "mean_action_processing_ms": 0.08947894197174223, "mean_env_wait_ms": 0.8434926114785121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545522689819336, "StateBufferConnector_ms": 0.002561330795288086, "ViewRequirementAgentConnector_ms": 0.06662702560424805}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154733.75945166682, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155765.66491955973, -152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5156583184964244, "mean_inference_ms": 0.49472124908841425, "mean_action_processing_ms": 0.08947894197174223, "mean_env_wait_ms": 0.8434926114785121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545522689819336, "StateBufferConnector_ms": 0.002561330795288086, "ViewRequirementAgentConnector_ms": 0.06662702560424805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19085520, "num_agent_steps_trained": 19085520, "num_env_steps_sampled": 19085520, "num_env_steps_trained": 19085520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.4829356150217, "num_env_steps_trained_throughput_per_sec": 715.4829356150217, "timesteps_total": 19085520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19085520, "timers": {"training_iteration_time_ms": 61166.29, "sample_time_ms": 60047.313, "load_time_ms": 16.877, "load_throughput": 2602327.675, "learn_time_ms": 1101.021, "learn_throughput": 39890.234, "synch_weights_time_ms": 0.921}, "counters": {"num_env_steps_sampled": 19085520, "num_env_steps_trained": 19085520, "num_agent_steps_sampled": 19085520, "num_agent_steps_trained": 19085520}, "done": false, "episodes_total": 7887, "training_iteration": 2064, "trial_id": "e8087_00000", "date": "2023-08-06_14-42-50", "timestamp": 1691322170, "time_this_iter_s": 61.38812804222107, "time_total_s": 44273.157130241394, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14792.38570189476, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 17.256321839080464, "ram_util_percent": 71.3712643678161}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.75e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9964291319555, "policy_loss": -2245457.0040998543, "vf_loss": 4454619.41654519}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 123137.5, "diff_num_grad_updates_vs_sampler_policy": 123136.5}}, "num_env_steps_sampled": 19129440, "num_env_steps_trained": 19129440, "num_agent_steps_sampled": 19129440, "num_agent_steps_trained": 19129440}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154724.93882607683, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5180769494098761, "mean_inference_ms": 0.4958542069246091, "mean_action_processing_ms": 0.08947979547857017, "mean_env_wait_ms": 0.8447801687735692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035448074340820312, "StateBufferConnector_ms": 0.002561807632446289, "ViewRequirementAgentConnector_ms": 0.06662821769714355}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154724.93882607683, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152935.19267684998, -153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5180769494098761, "mean_inference_ms": 0.4958542069246091, "mean_action_processing_ms": 0.08947979547857017, "mean_env_wait_ms": 0.8447801687735692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035448074340820312, "StateBufferConnector_ms": 0.002561807632446289, "ViewRequirementAgentConnector_ms": 0.06662821769714355}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19129440, "num_agent_steps_trained": 19129440, "num_env_steps_sampled": 19129440, "num_env_steps_trained": 19129440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.3774582121154, "num_env_steps_trained_throughput_per_sec": 713.3774582121154, "timesteps_total": 19129440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19129440, "timers": {"training_iteration_time_ms": 61180.145, "sample_time_ms": 60059.925, "load_time_ms": 16.842, "load_throughput": 2607724.509, "learn_time_ms": 1102.314, "learn_throughput": 39843.446, "synch_weights_time_ms": 0.905}, "counters": {"num_env_steps_sampled": 19129440, "num_env_steps_trained": 19129440, "num_agent_steps_sampled": 19129440, "num_agent_steps_trained": 19129440}, "done": false, "episodes_total": 7888, "training_iteration": 2065, "trial_id": "e8087_00000", "date": "2023-08-06_14-43-52", "timestamp": 1691322232, "time_this_iter_s": 61.56932020187378, "time_total_s": 44334.72645044327, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14853.955022096634, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 17.358620689655172, "ram_util_percent": 71.25402298850575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.125000000000002e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.16179361148755, "policy_loss": -2139213.7785594705, "vf_loss": 4538943.376639942}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 123823.5, "diff_num_grad_updates_vs_sampler_policy": 123822.5}}, "num_env_steps_sampled": 19173360, "num_env_steps_trained": 19173360, "num_agent_steps_sampled": 19173360, "num_agent_steps_trained": 19173360}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154759.40119340207, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5204820158998704, "mean_inference_ms": 0.4969808316193807, "mean_action_processing_ms": 0.08948063262726949, "mean_env_wait_ms": 0.8460599786986265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035505294799804688, "StateBufferConnector_ms": 0.0025577545166015625, "ViewRequirementAgentConnector_ms": 0.06663060188293457}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154759.40119340207, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153255.87421561586, -155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5204820158998704, "mean_inference_ms": 0.4969808316193807, "mean_action_processing_ms": 0.08948063262726949, "mean_env_wait_ms": 0.8460599786986265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035505294799804688, "StateBufferConnector_ms": 0.0025577545166015625, "ViewRequirementAgentConnector_ms": 0.06663060188293457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19173360, "num_agent_steps_trained": 19173360, "num_env_steps_sampled": 19173360, "num_env_steps_trained": 19173360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 724.0840481324869, "num_env_steps_trained_throughput_per_sec": 724.0840481324869, "timesteps_total": 19173360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19173360, "timers": {"training_iteration_time_ms": 61107.784, "sample_time_ms": 59986.516, "load_time_ms": 16.841, "load_throughput": 2607864.793, "learn_time_ms": 1103.366, "learn_throughput": 39805.471, "synch_weights_time_ms": 0.903}, "counters": {"num_env_steps_sampled": 19173360, "num_env_steps_trained": 19173360, "num_agent_steps_sampled": 19173360, "num_agent_steps_trained": 19173360}, "done": false, "episodes_total": 7889, "training_iteration": 2066, "trial_id": "e8087_00000", "date": "2023-08-06_14-44-53", "timestamp": 1691322293, "time_this_iter_s": 60.65893578529358, "time_total_s": 44395.38538622856, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14914.613957881927, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 17.62441860465116, "ram_util_percent": 71.23488372093024}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.499999999999998e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1747627814379, "policy_loss": -1992436.8513034119, "vf_loss": 4583258.652150146}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 124509.5, "diff_num_grad_updates_vs_sampler_policy": 124508.5}}, "num_env_steps_sampled": 19217280, "num_env_steps_trained": 19217280, "num_agent_steps_sampled": 19217280, "num_agent_steps_trained": 19217280}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154793.63032207757, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5228735807197894, "mean_inference_ms": 0.49810129007635334, "mean_action_processing_ms": 0.0894814564636812, "mean_env_wait_ms": 0.8473323094855947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003553152084350586, "StateBufferConnector_ms": 0.0025577545166015625, "ViewRequirementAgentConnector_ms": 0.06666803359985352}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154793.63032207757, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155644.92032414456, -157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5228735807197894, "mean_inference_ms": 0.49810129007635334, "mean_action_processing_ms": 0.0894814564636812, "mean_env_wait_ms": 0.8473323094855947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003553152084350586, "StateBufferConnector_ms": 0.0025577545166015625, "ViewRequirementAgentConnector_ms": 0.06666803359985352}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19217280, "num_agent_steps_trained": 19217280, "num_env_steps_sampled": 19217280, "num_env_steps_trained": 19217280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.9896272996752, "num_env_steps_trained_throughput_per_sec": 719.9896272996752, "timesteps_total": 19217280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19217280, "timers": {"training_iteration_time_ms": 61103.649, "sample_time_ms": 59981.965, "load_time_ms": 16.626, "load_throughput": 2641717.528, "learn_time_ms": 1103.993, "learn_throughput": 39782.849, "synch_weights_time_ms": 0.905}, "counters": {"num_env_steps_sampled": 19217280, "num_env_steps_trained": 19217280, "num_agent_steps_sampled": 19217280, "num_agent_steps_trained": 19217280}, "done": false, "episodes_total": 7890, "training_iteration": 2067, "trial_id": "e8087_00000", "date": "2023-08-06_14-45-54", "timestamp": 1691322354, "time_this_iter_s": 61.00399327278137, "time_total_s": 44456.38937950134, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14975.617951154709, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 17.63023255813954, "ram_util_percent": 71.20930232558139}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.874999999999999e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.00398610284657, "policy_loss": -2114500.6134933606, "vf_loss": 4391091.290816327}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 125195.5, "diff_num_grad_updates_vs_sampler_policy": 125194.5}}, "num_env_steps_sampled": 19261200, "num_env_steps_trained": 19261200, "num_agent_steps_sampled": 19261200, "num_agent_steps_trained": 19261200}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154781.77780852304, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5252520144469854, "mean_inference_ms": 0.4992154510817883, "mean_action_processing_ms": 0.08948224504956684, "mean_env_wait_ms": 0.8485985134314978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003554105758666992, "StateBufferConnector_ms": 0.00255584716796875, "ViewRequirementAgentConnector_ms": 0.06667613983154297}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154781.77780852304, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157690.6220606881, -154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5252520144469854, "mean_inference_ms": 0.4992154510817883, "mean_action_processing_ms": 0.08948224504956684, "mean_env_wait_ms": 0.8485985134314978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003554105758666992, "StateBufferConnector_ms": 0.00255584716796875, "ViewRequirementAgentConnector_ms": 0.06667613983154297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19261200, "num_agent_steps_trained": 19261200, "num_env_steps_sampled": 19261200, "num_env_steps_trained": 19261200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.9022886763211, "num_env_steps_trained_throughput_per_sec": 711.9022886763211, "timesteps_total": 19261200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19261200, "timers": {"training_iteration_time_ms": 61170.364, "sample_time_ms": 60049.684, "load_time_ms": 16.6, "load_throughput": 2645750.696, "learn_time_ms": 1103.009, "learn_throughput": 39818.336, "synch_weights_time_ms": 0.911}, "counters": {"num_env_steps_sampled": 19261200, "num_env_steps_trained": 19261200, "num_agent_steps_sampled": 19261200, "num_agent_steps_trained": 19261200}, "done": false, "episodes_total": 7891, "training_iteration": 2068, "trial_id": "e8087_00000", "date": "2023-08-06_14-46-55", "timestamp": 1691322415, "time_this_iter_s": 61.697335958480835, "time_total_s": 44518.08671545982, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15037.31528711319, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 16.75909090909091, "ram_util_percent": 71.22500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.25e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.7358747654684, "policy_loss": -2058682.6352268585, "vf_loss": 4160039.0165816327}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 125881.5, "diff_num_grad_updates_vs_sampler_policy": 125880.5}}, "num_env_steps_sampled": 19305120, "num_env_steps_trained": 19305120, "num_agent_steps_sampled": 19305120, "num_agent_steps_trained": 19305120}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154717.26862032927, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5276180437256371, "mean_inference_ms": 0.5003234662470738, "mean_action_processing_ms": 0.08948302214289498, "mean_env_wait_ms": 0.8498593453948418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035552978515625, "StateBufferConnector_ms": 0.002557992935180664, "ViewRequirementAgentConnector_ms": 0.0666966438293457}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154717.26862032927, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154133.72561943578, -155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5276180437256371, "mean_inference_ms": 0.5003234662470738, "mean_action_processing_ms": 0.08948302214289498, "mean_env_wait_ms": 0.8498593453948418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035552978515625, "StateBufferConnector_ms": 0.002557992935180664, "ViewRequirementAgentConnector_ms": 0.0666966438293457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19305120, "num_agent_steps_trained": 19305120, "num_env_steps_sampled": 19305120, "num_env_steps_trained": 19305120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 709.4912728322578, "num_env_steps_trained_throughput_per_sec": 709.4912728322578, "timesteps_total": 19305120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19305120, "timers": {"training_iteration_time_ms": 61202.715, "sample_time_ms": 60082.37, "load_time_ms": 16.541, "load_throughput": 2655200.555, "learn_time_ms": 1102.728, "learn_throughput": 39828.493, "synch_weights_time_ms": 0.916}, "counters": {"num_env_steps_sampled": 19305120, "num_env_steps_trained": 19305120, "num_agent_steps_sampled": 19305120, "num_agent_steps_trained": 19305120}, "done": false, "episodes_total": 7892, "training_iteration": 2069, "trial_id": "e8087_00000", "date": "2023-08-06_14-47-57", "timestamp": 1691322477, "time_this_iter_s": 61.906410932540894, "time_total_s": 44579.993126392365, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15099.22169804573, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 17.352873563218385, "ram_util_percent": 71.1770114942529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.625000000000001e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.03997713761845, "policy_loss": -2184791.0206530155, "vf_loss": 4558302.11169825}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 126567.5, "diff_num_grad_updates_vs_sampler_policy": 126566.5}}, "num_env_steps_sampled": 19349040, "num_env_steps_trained": 19349040, "num_agent_steps_sampled": 19349040, "num_agent_steps_trained": 19349040}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154739.34884949058, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5299712140247794, "mean_inference_ms": 0.5014253005105971, "mean_action_processing_ms": 0.08948379652628781, "mean_env_wait_ms": 0.8511140340718627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035529136657714844, "StateBufferConnector_ms": 0.002558469772338867, "ViewRequirementAgentConnector_ms": 0.06670331954956055}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154739.34884949058, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155771.12243891312, -157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5299712140247794, "mean_inference_ms": 0.5014253005105971, "mean_action_processing_ms": 0.08948379652628781, "mean_env_wait_ms": 0.8511140340718627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035529136657714844, "StateBufferConnector_ms": 0.002558469772338867, "ViewRequirementAgentConnector_ms": 0.06670331954956055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19349040, "num_agent_steps_trained": 19349040, "num_env_steps_sampled": 19349040, "num_env_steps_trained": 19349040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.2190437488498, "num_env_steps_trained_throughput_per_sec": 715.2190437488498, "timesteps_total": 19349040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19349040, "timers": {"training_iteration_time_ms": 61265.484, "sample_time_ms": 60144.851, "load_time_ms": 16.668, "load_throughput": 2635047.965, "learn_time_ms": 1102.892, "learn_throughput": 39822.56, "synch_weights_time_ms": 0.914}, "counters": {"num_env_steps_sampled": 19349040, "num_env_steps_trained": 19349040, "num_agent_steps_sampled": 19349040, "num_agent_steps_trained": 19349040}, "done": false, "episodes_total": 7893, "training_iteration": 2070, "trial_id": "e8087_00000", "date": "2023-08-06_14-48-59", "timestamp": 1691322539, "time_this_iter_s": 61.41066217422485, "time_total_s": 44641.40378856659, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15160.632360219955, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 17.139080459770113, "ram_util_percent": 71.23908045977012}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.10844581537276, "policy_loss": -1986487.2708693969, "vf_loss": 4274410.670371721}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 127253.5, "diff_num_grad_updates_vs_sampler_policy": 127252.5}}, "num_env_steps_sampled": 19392960, "num_env_steps_trained": 19392960, "num_agent_steps_sampled": 19392960, "num_agent_steps_trained": 19392960}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154709.31373083103, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5323117617787407, "mean_inference_ms": 0.502521277416788, "mean_action_processing_ms": 0.08948455566571009, "mean_env_wait_ms": 0.8523623280398468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003555774688720703, "StateBufferConnector_ms": 0.0025560855865478516, "ViewRequirementAgentConnector_ms": 0.06669139862060547}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154709.31373083103, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157787.09186218758, -154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5323117617787407, "mean_inference_ms": 0.502521277416788, "mean_action_processing_ms": 0.08948455566571009, "mean_env_wait_ms": 0.8523623280398468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003555774688720703, "StateBufferConnector_ms": 0.0025560855865478516, "ViewRequirementAgentConnector_ms": 0.06669139862060547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19392960, "num_agent_steps_trained": 19392960, "num_env_steps_sampled": 19392960, "num_env_steps_trained": 19392960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.2208660545618, "num_env_steps_trained_throughput_per_sec": 716.2208660545618, "timesteps_total": 19392960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19392960, "timers": {"training_iteration_time_ms": 61341.671, "sample_time_ms": 60220.972, "load_time_ms": 16.693, "load_throughput": 2631009.759, "learn_time_ms": 1102.924, "learn_throughput": 39821.415, "synch_weights_time_ms": 0.922}, "counters": {"num_env_steps_sampled": 19392960, "num_env_steps_trained": 19392960, "num_agent_steps_sampled": 19392960, "num_agent_steps_trained": 19392960}, "done": false, "episodes_total": 7894, "training_iteration": 2071, "trial_id": "e8087_00000", "date": "2023-08-06_14-50-00", "timestamp": 1691322600, "time_this_iter_s": 61.32463812828064, "time_total_s": 44702.72842669487, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15221.956998348236, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 17.586206896551726, "ram_util_percent": 71.27816091954021}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.27835025175665, "policy_loss": -1833164.2851192374, "vf_loss": 4551116.1875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 127939.5, "diff_num_grad_updates_vs_sampler_policy": 127938.5}}, "num_env_steps_sampled": 19436880, "num_env_steps_trained": 19436880, "num_agent_steps_sampled": 19436880, "num_agent_steps_trained": 19436880}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154691.08463726303, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5346399655740155, "mean_inference_ms": 0.5036113432485121, "mean_action_processing_ms": 0.08948526692471924, "mean_env_wait_ms": 0.8536028211958601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035524368286132812, "StateBufferConnector_ms": 0.002560138702392578, "ViewRequirementAgentConnector_ms": 0.06668210029602051}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154691.08463726303, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154526.57825303133, -156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5346399655740155, "mean_inference_ms": 0.5036113432485121, "mean_action_processing_ms": 0.08948526692471924, "mean_env_wait_ms": 0.8536028211958601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035524368286132812, "StateBufferConnector_ms": 0.002560138702392578, "ViewRequirementAgentConnector_ms": 0.06668210029602051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19436880, "num_agent_steps_trained": 19436880, "num_env_steps_sampled": 19436880, "num_env_steps_trained": 19436880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 723.4383493859332, "num_env_steps_trained_throughput_per_sec": 723.4383493859332, "timesteps_total": 19436880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19436880, "timers": {"training_iteration_time_ms": 61287.274, "sample_time_ms": 60166.351, "load_time_ms": 16.638, "load_throughput": 2639752.835, "learn_time_ms": 1103.2, "learn_throughput": 39811.469, "synch_weights_time_ms": 0.925}, "counters": {"num_env_steps_sampled": 19436880, "num_env_steps_trained": 19436880, "num_agent_steps_sampled": 19436880, "num_agent_steps_trained": 19436880}, "done": false, "episodes_total": 7895, "training_iteration": 2072, "trial_id": "e8087_00000", "date": "2023-08-06_14-51-01", "timestamp": 1691322661, "time_this_iter_s": 60.71345090866089, "time_total_s": 44763.44187760353, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15282.670449256897, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 17.801162790697678, "ram_util_percent": 71.26395348837211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1322045951821, "policy_loss": -2266103.8974353136, "vf_loss": 4737978.636115161}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 128625.5, "diff_num_grad_updates_vs_sampler_policy": 128624.5}}, "num_env_steps_sampled": 19480800, "num_env_steps_trained": 19480800, "num_agent_steps_sampled": 19480800, "num_agent_steps_trained": 19480800}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154732.03358055645, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.53695619093306, "mean_inference_ms": 0.5046953679069445, "mean_action_processing_ms": 0.0894859533729905, "mean_env_wait_ms": 0.8548360885406469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035555362701416016, "StateBufferConnector_ms": 0.002557992935180664, "ViewRequirementAgentConnector_ms": 0.06672453880310059}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154732.03358055645, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156410.30079370164, -154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.53695619093306, "mean_inference_ms": 0.5046953679069445, "mean_action_processing_ms": 0.0894859533729905, "mean_env_wait_ms": 0.8548360885406469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035555362701416016, "StateBufferConnector_ms": 0.002557992935180664, "ViewRequirementAgentConnector_ms": 0.06672453880310059}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19480800, "num_agent_steps_trained": 19480800, "num_env_steps_sampled": 19480800, "num_env_steps_trained": 19480800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 723.393582690317, "num_env_steps_trained_throughput_per_sec": 723.393582690317, "timesteps_total": 19480800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19480800, "timers": {"training_iteration_time_ms": 61235.89, "sample_time_ms": 60115.012, "load_time_ms": 16.673, "load_throughput": 2634162.489, "learn_time_ms": 1103.111, "learn_throughput": 39814.68, "synch_weights_time_ms": 0.934}, "counters": {"num_env_steps_sampled": 19480800, "num_env_steps_trained": 19480800, "num_agent_steps_sampled": 19480800, "num_agent_steps_trained": 19480800}, "done": false, "episodes_total": 7896, "training_iteration": 2073, "trial_id": "e8087_00000", "date": "2023-08-06_14-52-02", "timestamp": 1691322722, "time_this_iter_s": 60.71682286262512, "time_total_s": 44824.158700466156, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15343.387272119522, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 19.666279069767437, "ram_util_percent": 70.88372093023256}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.03628255326964, "policy_loss": -1813073.6488133199, "vf_loss": 4240217.294825073}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 129311.5, "diff_num_grad_updates_vs_sampler_policy": 129310.5}}, "num_env_steps_sampled": 19524720, "num_env_steps_trained": 19524720, "num_agent_steps_sampled": 19524720, "num_agent_steps_trained": 19524720}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154689.10747927878, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5392599673674826, "mean_inference_ms": 0.5057737298936765, "mean_action_processing_ms": 0.08948665223424897, "mean_env_wait_ms": 0.8560629891937913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00354766845703125, "StateBufferConnector_ms": 0.0025568008422851562, "ViewRequirementAgentConnector_ms": 0.06671833992004395}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154689.10747927878, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154164.80549671315, -155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5392599673674826, "mean_inference_ms": 0.5057737298936765, "mean_action_processing_ms": 0.08948665223424897, "mean_env_wait_ms": 0.8560629891937913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00354766845703125, "StateBufferConnector_ms": 0.0025568008422851562, "ViewRequirementAgentConnector_ms": 0.06671833992004395}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19524720, "num_agent_steps_trained": 19524720, "num_env_steps_sampled": 19524720, "num_env_steps_trained": 19524720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.3514308314667, "num_env_steps_trained_throughput_per_sec": 717.3514308314667, "timesteps_total": 19524720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19524720, "timers": {"training_iteration_time_ms": 61219.901, "sample_time_ms": 60106.224, "load_time_ms": 16.676, "load_throughput": 2633774.574, "learn_time_ms": 1095.907, "learn_throughput": 40076.393, "synch_weights_time_ms": 0.933}, "counters": {"num_env_steps_sampled": 19524720, "num_env_steps_trained": 19524720, "num_agent_steps_sampled": 19524720, "num_agent_steps_trained": 19524720}, "done": false, "episodes_total": 7897, "training_iteration": 2074, "trial_id": "e8087_00000", "date": "2023-08-06_14-53-03", "timestamp": 1691322783, "time_this_iter_s": 61.22794508934021, "time_total_s": 44885.386645555496, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15404.615217208862, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 16.8264367816092, "ram_util_percent": 71.06666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1685760320102, "policy_loss": -1901954.7294694106, "vf_loss": 4527112.904154519}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 129997.5, "diff_num_grad_updates_vs_sampler_policy": 129996.5}}, "num_env_steps_sampled": 19568640, "num_env_steps_trained": 19568640, "num_agent_steps_sampled": 19568640, "num_agent_steps_trained": 19568640}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154706.05790968816, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5415515540755937, "mean_inference_ms": 0.5068463305882962, "mean_action_processing_ms": 0.08948733891064872, "mean_env_wait_ms": 0.8572827728141877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035490989685058594, "StateBufferConnector_ms": 0.0025582313537597656, "ViewRequirementAgentConnector_ms": 0.06672024726867676}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154706.05790968816, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155957.54249539878, -154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5415515540755937, "mean_inference_ms": 0.5068463305882962, "mean_action_processing_ms": 0.08948733891064872, "mean_env_wait_ms": 0.8572827728141877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035490989685058594, "StateBufferConnector_ms": 0.0025582313537597656, "ViewRequirementAgentConnector_ms": 0.06672024726867676}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19568640, "num_agent_steps_trained": 19568640, "num_env_steps_sampled": 19568640, "num_env_steps_trained": 19568640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.5147874261221, "num_env_steps_trained_throughput_per_sec": 716.5147874261221, "timesteps_total": 19568640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19568640, "timers": {"training_iteration_time_ms": 61192.943, "sample_time_ms": 60080.332, "load_time_ms": 16.735, "load_throughput": 2624375.393, "learn_time_ms": 1094.781, "learn_throughput": 40117.613, "synch_weights_time_ms": 0.934}, "counters": {"num_env_steps_sampled": 19568640, "num_env_steps_trained": 19568640, "num_agent_steps_sampled": 19568640, "num_agent_steps_trained": 19568640}, "done": false, "episodes_total": 7898, "training_iteration": 2075, "trial_id": "e8087_00000", "date": "2023-08-06_14-54-04", "timestamp": 1691322844, "time_this_iter_s": 61.299599170684814, "time_total_s": 44946.68624472618, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15465.914816379547, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 17.424418604651166, "ram_util_percent": 71.11744186046514}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.15530457788583, "policy_loss": -2118692.6335299746, "vf_loss": 4548612.037354227}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 130683.5, "diff_num_grad_updates_vs_sampler_policy": 130682.5}}, "num_env_steps_sampled": 19612560, "num_env_steps_trained": 19612560, "num_agent_steps_sampled": 19612560, "num_agent_steps_trained": 19612560}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154709.74436050007, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5390427465785392, "mean_inference_ms": 0.5079131133219813, "mean_action_processing_ms": 0.08948798586519108, "mean_env_wait_ms": 0.8559611732837089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003550291061401367, "StateBufferConnector_ms": 0.0025577545166015625, "ViewRequirementAgentConnector_ms": 0.06672430038452148}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154709.74436050007, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154355.26737861312, -152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5390427465785392, "mean_inference_ms": 0.5079131133219813, "mean_action_processing_ms": 0.08948798586519108, "mean_env_wait_ms": 0.8559611732837089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003550291061401367, "StateBufferConnector_ms": 0.0025577545166015625, "ViewRequirementAgentConnector_ms": 0.06672430038452148}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19612560, "num_agent_steps_trained": 19612560, "num_env_steps_sampled": 19612560, "num_env_steps_trained": 19612560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 721.6390054124541, "num_env_steps_trained_throughput_per_sec": 721.6390054124541, "timesteps_total": 19612560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19612560, "timers": {"training_iteration_time_ms": 61213.494, "sample_time_ms": 60101.804, "load_time_ms": 16.753, "load_throughput": 2621652.651, "learn_time_ms": 1093.839, "learn_throughput": 40152.147, "synch_weights_time_ms": 0.937}, "counters": {"num_env_steps_sampled": 19612560, "num_env_steps_trained": 19612560, "num_agent_steps_sampled": 19612560, "num_agent_steps_trained": 19612560}, "done": false, "episodes_total": 7899, "training_iteration": 2076, "trial_id": "e8087_00000", "date": "2023-08-06_14-55-05", "timestamp": 1691322905, "time_this_iter_s": 60.86440920829773, "time_total_s": 45007.55065393448, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15526.779225587845, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 17.27126436781609, "ram_util_percent": 71.17011494252874}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.26381107252473, "policy_loss": -1999014.8750654839, "vf_loss": 4586679.611151603}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 131369.5, "diff_num_grad_updates_vs_sampler_policy": 131368.5}}, "num_env_steps_sampled": 19656480, "num_env_steps_trained": 19656480, "num_agent_steps_sampled": 19656480, "num_agent_steps_trained": 19656480}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154736.15203304894, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5365737837510073, "mean_inference_ms": 0.5067682195136495, "mean_action_processing_ms": 0.08948851790115205, "mean_env_wait_ms": 0.8546501045474179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003548860549926758, "StateBufferConnector_ms": 0.0025551319122314453, "ViewRequirementAgentConnector_ms": 0.06672453880310059}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154736.15203304894, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152212.558214972, -152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5365737837510073, "mean_inference_ms": 0.5067682195136495, "mean_action_processing_ms": 0.08948851790115205, "mean_env_wait_ms": 0.8546501045474179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003548860549926758, "StateBufferConnector_ms": 0.0025551319122314453, "ViewRequirementAgentConnector_ms": 0.06672453880310059}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19656480, "num_agent_steps_trained": 19656480, "num_env_steps_sampled": 19656480, "num_env_steps_trained": 19656480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.9914170334692, "num_env_steps_trained_throughput_per_sec": 719.9914170334692, "timesteps_total": 19656480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19656480, "timers": {"training_iteration_time_ms": 61213.481, "sample_time_ms": 60101.549, "load_time_ms": 16.807, "load_throughput": 2613243.863, "learn_time_ms": 1094.032, "learn_throughput": 40145.071, "synch_weights_time_ms": 0.934}, "counters": {"num_env_steps_sampled": 19656480, "num_env_steps_trained": 19656480, "num_agent_steps_sampled": 19656480, "num_agent_steps_trained": 19656480}, "done": false, "episodes_total": 7900, "training_iteration": 2077, "trial_id": "e8087_00000", "date": "2023-08-06_14-56-06", "timestamp": 1691322966, "time_this_iter_s": 61.00361084938049, "time_total_s": 45068.55426478386, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15587.782836437225, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 17.48953488372093, "ram_util_percent": 71.19302325581397}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0083455344331, "policy_loss": -2121400.5497690984, "vf_loss": 4230356.364795919}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 132055.5, "diff_num_grad_updates_vs_sampler_policy": 132054.5}}, "num_env_steps_sampled": 19700400, "num_env_steps_trained": 19700400, "num_agent_steps_sampled": 19700400, "num_agent_steps_trained": 19700400}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154734.25209379644, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5341439583223323, "mean_inference_ms": 0.5056415064595036, "mean_action_processing_ms": 0.08948903344064427, "mean_env_wait_ms": 0.8533588537207366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035495758056640625, "StateBufferConnector_ms": 0.0025491714477539062, "ViewRequirementAgentConnector_ms": 0.06670856475830078}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154734.25209379644, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152985.07072567462, -153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5341439583223323, "mean_inference_ms": 0.5056415064595036, "mean_action_processing_ms": 0.08948903344064427, "mean_env_wait_ms": 0.8533588537207366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035495758056640625, "StateBufferConnector_ms": 0.0025491714477539062, "ViewRequirementAgentConnector_ms": 0.06670856475830078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19700400, "num_agent_steps_trained": 19700400, "num_env_steps_sampled": 19700400, "num_env_steps_trained": 19700400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.0996026893047, "num_env_steps_trained_throughput_per_sec": 717.0996026893047, "timesteps_total": 19700400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19700400, "timers": {"training_iteration_time_ms": 61168.767, "sample_time_ms": 60056.309, "load_time_ms": 16.887, "load_throughput": 2600758.874, "learn_time_ms": 1094.483, "learn_throughput": 40128.536, "synch_weights_time_ms": 0.929}, "counters": {"num_env_steps_sampled": 19700400, "num_env_steps_trained": 19700400, "num_agent_steps_sampled": 19700400, "num_agent_steps_trained": 19700400}, "done": false, "episodes_total": 7901, "training_iteration": 2078, "trial_id": "e8087_00000", "date": "2023-08-06_14-57-07", "timestamp": 1691323027, "time_this_iter_s": 61.24965190887451, "time_total_s": 45129.803916692734, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15649.0324883461, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 17.257471264367815, "ram_util_percent": 71.12298850574713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.139479701095, "policy_loss": -2040316.8938422466, "vf_loss": 4491951.661625365}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 132741.5, "diff_num_grad_updates_vs_sampler_policy": 132740.5}}, "num_env_steps_sampled": 19744320, "num_env_steps_trained": 19744320, "num_agent_steps_sampled": 19744320, "num_agent_steps_trained": 19744320}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154760.60126767823, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5317523164158091, "mean_inference_ms": 0.5045325150165438, "mean_action_processing_ms": 0.08948953483608632, "mean_env_wait_ms": 0.8520879003044146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545522689819336, "StateBufferConnector_ms": 0.0025496482849121094, "ViewRequirementAgentConnector_ms": 0.06670975685119629}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154760.60126767823, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153790.10660135106, -157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5317523164158091, "mean_inference_ms": 0.5045325150165438, "mean_action_processing_ms": 0.08948953483608632, "mean_env_wait_ms": 0.8520879003044146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545522689819336, "StateBufferConnector_ms": 0.0025496482849121094, "ViewRequirementAgentConnector_ms": 0.06670975685119629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19744320, "num_agent_steps_trained": 19744320, "num_env_steps_sampled": 19744320, "num_env_steps_trained": 19744320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.3490200877808, "num_env_steps_trained_throughput_per_sec": 717.3490200877808, "timesteps_total": 19744320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19744320, "timers": {"training_iteration_time_ms": 61100.958, "sample_time_ms": 59989.134, "load_time_ms": 16.706, "load_throughput": 2628985.914, "learn_time_ms": 1094.028, "learn_throughput": 40145.214, "synch_weights_time_ms": 0.927}, "counters": {"num_env_steps_sampled": 19744320, "num_env_steps_trained": 19744320, "num_agent_steps_sampled": 19744320, "num_agent_steps_trained": 19744320}, "done": false, "episodes_total": 7902, "training_iteration": 2079, "trial_id": "e8087_00000", "date": "2023-08-06_14-58-09", "timestamp": 1691323089, "time_this_iter_s": 61.22861194610596, "time_total_s": 45191.03252863884, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15710.261100292206, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 18.02441860465116, "ram_util_percent": 71.23023255813953}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.5e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.10790584108224, "policy_loss": -2030417.979438092, "vf_loss": 4497856.118440233}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 133427.5, "diff_num_grad_updates_vs_sampler_policy": 133426.5}}, "num_env_steps_sampled": 19788240, "num_env_steps_trained": 19788240, "num_agent_steps_sampled": 19788240, "num_agent_steps_trained": 19788240}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154778.89136880546, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5293977954314341, "mean_inference_ms": 0.503440811344078, "mean_action_processing_ms": 0.08949002756925907, "mean_env_wait_ms": 0.8508357874142218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035445690155029297, "StateBufferConnector_ms": 0.0025522708892822266, "ViewRequirementAgentConnector_ms": 0.06669902801513672}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154778.89136880546, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157434.61392159943, -156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5293977954314341, "mean_inference_ms": 0.503440811344078, "mean_action_processing_ms": 0.08949002756925907, "mean_env_wait_ms": 0.8508357874142218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035445690155029297, "StateBufferConnector_ms": 0.0025522708892822266, "ViewRequirementAgentConnector_ms": 0.06669902801513672}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19788240, "num_agent_steps_trained": 19788240, "num_env_steps_sampled": 19788240, "num_env_steps_trained": 19788240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 720.589689138144, "num_env_steps_trained_throughput_per_sec": 720.589689138144, "timesteps_total": 19788240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19788240, "timers": {"training_iteration_time_ms": 61055.19, "sample_time_ms": 59942.707, "load_time_ms": 16.74, "load_throughput": 2623668.954, "learn_time_ms": 1094.659, "learn_throughput": 40122.08, "synch_weights_time_ms": 0.921}, "counters": {"num_env_steps_sampled": 19788240, "num_env_steps_trained": 19788240, "num_agent_steps_sampled": 19788240, "num_agent_steps_trained": 19788240}, "done": false, "episodes_total": 7903, "training_iteration": 2080, "trial_id": "e8087_00000", "date": "2023-08-06_14-59-10", "timestamp": 1691323150, "time_this_iter_s": 60.953129053115845, "time_total_s": 45251.985657691956, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15771.214229345322, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 18.179310344827584, "ram_util_percent": 71.51954022988504}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.88727932143144, "policy_loss": -1960438.7217138528, "vf_loss": 4386558.954263848}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 134113.5, "diff_num_grad_updates_vs_sampler_policy": 134112.5}}, "num_env_steps_sampled": 19832160, "num_env_steps_trained": 19832160, "num_agent_steps_sampled": 19832160, "num_agent_steps_trained": 19832160}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154748.99740875926, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5270795553938816, "mean_inference_ms": 0.502365885168694, "mean_action_processing_ms": 0.08949052000647727, "mean_env_wait_ms": 0.8496038985530346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003546476364135742, "StateBufferConnector_ms": 0.0025551319122314453, "ViewRequirementAgentConnector_ms": 0.06669926643371582}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154748.99740875926, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156028.93607676204, -153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5270795553938816, "mean_inference_ms": 0.502365885168694, "mean_action_processing_ms": 0.08949052000647727, "mean_env_wait_ms": 0.8496038985530346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003546476364135742, "StateBufferConnector_ms": 0.0025551319122314453, "ViewRequirementAgentConnector_ms": 0.06669926643371582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19832160, "num_agent_steps_trained": 19832160, "num_env_steps_sampled": 19832160, "num_env_steps_trained": 19832160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.8193238920111, "num_env_steps_trained_throughput_per_sec": 717.8193238920111, "timesteps_total": 19832160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19832160, "timers": {"training_iteration_time_ms": 61041.535, "sample_time_ms": 59928.066, "load_time_ms": 16.805, "load_throughput": 2613584.963, "learn_time_ms": 1095.582, "learn_throughput": 40088.3, "synch_weights_time_ms": 0.92}, "counters": {"num_env_steps_sampled": 19832160, "num_env_steps_trained": 19832160, "num_agent_steps_sampled": 19832160, "num_agent_steps_trained": 19832160}, "done": false, "episodes_total": 7904, "training_iteration": 2081, "trial_id": "e8087_00000", "date": "2023-08-06_15-00-11", "timestamp": 1691323211, "time_this_iter_s": 61.18843698501587, "time_total_s": 45313.17409467697, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15832.402666330338, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 16.959302325581394, "ram_util_percent": 71.48720930232558}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.5e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.01973553093114, "policy_loss": -1889979.4647184766, "vf_loss": 4422550.993622449}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 134799.5, "diff_num_grad_updates_vs_sampler_policy": 134798.5}}, "num_env_steps_sampled": 19876080, "num_env_steps_trained": 19876080, "num_agent_steps_sampled": 19876080, "num_agent_steps_trained": 19876080}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154733.10396403325, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5247966077253355, "mean_inference_ms": 0.501307404168736, "mean_action_processing_ms": 0.0894909872928301, "mean_env_wait_ms": 0.8483918622155848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00354766845703125, "StateBufferConnector_ms": 0.0025577545166015625, "ViewRequirementAgentConnector_ms": 0.06669878959655762}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154733.10396403325, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153986.788541238, -151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5247966077253355, "mean_inference_ms": 0.501307404168736, "mean_action_processing_ms": 0.0894909872928301, "mean_env_wait_ms": 0.8483918622155848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00354766845703125, "StateBufferConnector_ms": 0.0025577545166015625, "ViewRequirementAgentConnector_ms": 0.06669878959655762}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19876080, "num_agent_steps_trained": 19876080, "num_env_steps_sampled": 19876080, "num_env_steps_trained": 19876080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.6625341498047, "num_env_steps_trained_throughput_per_sec": 718.6625341498047, "timesteps_total": 19876080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19876080, "timers": {"training_iteration_time_ms": 61081.879, "sample_time_ms": 59968.393, "load_time_ms": 16.919, "load_throughput": 2595913.81, "learn_time_ms": 1095.489, "learn_throughput": 40091.689, "synch_weights_time_ms": 0.915}, "counters": {"num_env_steps_sampled": 19876080, "num_env_steps_trained": 19876080, "num_agent_steps_sampled": 19876080, "num_agent_steps_trained": 19876080}, "done": false, "episodes_total": 7905, "training_iteration": 2082, "trial_id": "e8087_00000", "date": "2023-08-06_15-01-12", "timestamp": 1691323272, "time_this_iter_s": 61.11632490158081, "time_total_s": 45374.29041957855, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15893.518991231918, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 17.104597701149427, "ram_util_percent": 71.48045977011493}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.9999999999999994e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0478186871498, "policy_loss": -2128403.635810518, "vf_loss": 4421692.7174744895}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 135485.5, "diff_num_grad_updates_vs_sampler_policy": 135484.5}}, "num_env_steps_sampled": 19920000, "num_env_steps_trained": 19920000, "num_agent_steps_sampled": 19920000, "num_agent_steps_trained": 19920000}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154742.5820074166, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5225483881603205, "mean_inference_ms": 0.5002650336026283, "mean_action_processing_ms": 0.08949143928578698, "mean_env_wait_ms": 0.8471974514070942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035505294799804688, "StateBufferConnector_ms": 0.002558469772338867, "ViewRequirementAgentConnector_ms": 0.06670665740966797}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154742.5820074166, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-151642.9527634342, -154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5225483881603205, "mean_inference_ms": 0.5002650336026283, "mean_action_processing_ms": 0.08949143928578698, "mean_env_wait_ms": 0.8471974514070942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035505294799804688, "StateBufferConnector_ms": 0.002558469772338867, "ViewRequirementAgentConnector_ms": 0.06670665740966797}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19920000, "num_agent_steps_trained": 19920000, "num_env_steps_sampled": 19920000, "num_env_steps_trained": 19920000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.0115781435596, "num_env_steps_trained_throughput_per_sec": 717.0115781435596, "timesteps_total": 19920000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19920000, "timers": {"training_iteration_time_ms": 61135.92, "sample_time_ms": 60016.161, "load_time_ms": 16.888, "load_throughput": 2600689.112, "learn_time_ms": 1101.806, "learn_throughput": 39861.811, "synch_weights_time_ms": 0.9}, "counters": {"num_env_steps_sampled": 19920000, "num_env_steps_trained": 19920000, "num_agent_steps_sampled": 19920000, "num_agent_steps_trained": 19920000}, "done": false, "episodes_total": 7906, "training_iteration": 2083, "trial_id": "e8087_00000", "date": "2023-08-06_15-02-13", "timestamp": 1691323333, "time_this_iter_s": 61.25741195678711, "time_total_s": 45435.54783153534, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15954.776403188705, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 17.898850574712643, "ram_util_percent": 71.46896551724137}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.499999999999999e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.988083019201, "policy_loss": -2006990.9823677796, "vf_loss": 4279942.998086735}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 136171.5, "diff_num_grad_updates_vs_sampler_policy": 136170.5}}, "num_env_steps_sampled": 19963920, "num_env_steps_trained": 19963920, "num_agent_steps_sampled": 19963920, "num_agent_steps_trained": 19963920}, "sampler_results": {"episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154751.82500320842, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934, -152567.25234261193], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5203338988509107, "mean_inference_ms": 0.4992384070230632, "mean_action_processing_ms": 0.08949186778699919, "mean_env_wait_ms": 0.8460217407712634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003546476364135742, "StateBufferConnector_ms": 0.002559661865234375, "ViewRequirementAgentConnector_ms": 0.06669235229492188}}, "episode_reward_max": -150441.39859595816, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154751.82500320842, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154227.05981953433, -154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934, -152567.25234261193], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5203338988509107, "mean_inference_ms": 0.4992384070230632, "mean_action_processing_ms": 0.08949186778699919, "mean_env_wait_ms": 0.8460217407712634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003546476364135742, "StateBufferConnector_ms": 0.002559661865234375, "ViewRequirementAgentConnector_ms": 0.06669235229492188}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19963920, "num_agent_steps_trained": 19963920, "num_env_steps_sampled": 19963920, "num_env_steps_trained": 19963920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.8024291321278, "num_env_steps_trained_throughput_per_sec": 715.8024291321278, "timesteps_total": 19963920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 19963920, "timers": {"training_iteration_time_ms": 61149.169, "sample_time_ms": 60028.662, "load_time_ms": 16.942, "load_throughput": 2592428.646, "learn_time_ms": 1102.49, "learn_throughput": 39837.088, "synch_weights_time_ms": 0.912}, "counters": {"num_env_steps_sampled": 19963920, "num_env_steps_trained": 19963920, "num_agent_steps_sampled": 19963920, "num_agent_steps_trained": 19963920}, "done": false, "episodes_total": 7907, "training_iteration": 2084, "trial_id": "e8087_00000", "date": "2023-08-06_15-03-15", "timestamp": 1691323395, "time_this_iter_s": 61.36067771911621, "time_total_s": 45496.908509254456, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 16016.137080907822, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 17.275581395348834, "ram_util_percent": 71.4546511627907}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.9999999999999998e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.85156912845355, "policy_loss": -1876984.2267475629, "vf_loss": 4037118.783983236}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 136857.5, "diff_num_grad_updates_vs_sampler_policy": 136856.5}}, "num_env_steps_sampled": 20007840, "num_env_steps_trained": 20007840, "num_agent_steps_sampled": 20007840, "num_agent_steps_trained": 20007840}, "sampler_results": {"episode_reward_max": -149253.40012192546, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154702.0884062323, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934, -152567.25234261193, -149253.40012192546], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5181524534459591, "mean_inference_ms": 0.49822720126375847, "mean_action_processing_ms": 0.0894922901654521, "mean_env_wait_ms": 0.8448641060219293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035457611083984375, "StateBufferConnector_ms": 0.0025644302368164062, "ViewRequirementAgentConnector_ms": 0.06669139862060547}}, "episode_reward_max": -149253.40012192546, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154702.0884062323, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154482.8827236001, -153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934, -152567.25234261193, -149253.40012192546], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5181524534459591, "mean_inference_ms": 0.49822720126375847, "mean_action_processing_ms": 0.0894922901654521, "mean_env_wait_ms": 0.8448641060219293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035457611083984375, "StateBufferConnector_ms": 0.0025644302368164062, "ViewRequirementAgentConnector_ms": 0.06669139862060547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20007840, "num_agent_steps_trained": 20007840, "num_env_steps_sampled": 20007840, "num_env_steps_trained": 20007840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.8565487458735, "num_env_steps_trained_throughput_per_sec": 716.8565487458735, "timesteps_total": 20007840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 20007840, "timers": {"training_iteration_time_ms": 61146.247, "sample_time_ms": 60026.167, "load_time_ms": 17.088, "load_throughput": 2570173.323, "learn_time_ms": 1101.914, "learn_throughput": 39857.919, "synch_weights_time_ms": 0.914}, "counters": {"num_env_steps_sampled": 20007840, "num_env_steps_trained": 20007840, "num_agent_steps_sampled": 20007840, "num_agent_steps_trained": 20007840}, "done": false, "episodes_total": 7908, "training_iteration": 2085, "trial_id": "e8087_00000", "date": "2023-08-06_15-04-16", "timestamp": 1691323456, "time_this_iter_s": 61.27117323875427, "time_total_s": 45558.17968249321, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 16077.408254146576, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 16.851724137931036, "ram_util_percent": 71.48850574712645}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4999999999999997e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.989555069726, "policy_loss": -2208188.933827214, "vf_loss": 4442325.942784256}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 137543.5, "diff_num_grad_updates_vs_sampler_policy": 137542.5}}, "num_env_steps_sampled": 20051760, "num_env_steps_trained": 20051760, "num_agent_steps_sampled": 20051760, "num_agent_steps_trained": 20051760}, "sampler_results": {"episode_reward_max": -149253.40012192546, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154708.62890062167, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934, -152567.25234261193, -149253.40012192546, -155136.93216253296], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5160032287540446, "mean_inference_ms": 0.49723075681804113, "mean_action_processing_ms": 0.08949271978033863, "mean_env_wait_ms": 0.8437244180061663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545522689819336, "StateBufferConnector_ms": 0.002561807632446289, "ViewRequirementAgentConnector_ms": 0.06666922569274902}}, "episode_reward_max": -149253.40012192546, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154708.62890062167, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153953.7557486181, -152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934, -152567.25234261193, -149253.40012192546, -155136.93216253296], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5160032287540446, "mean_inference_ms": 0.49723075681804113, "mean_action_processing_ms": 0.08949271978033863, "mean_env_wait_ms": 0.8437244180061663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545522689819336, "StateBufferConnector_ms": 0.002561807632446289, "ViewRequirementAgentConnector_ms": 0.06666922569274902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20051760, "num_agent_steps_trained": 20051760, "num_env_steps_sampled": 20051760, "num_env_steps_trained": 20051760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.1067075407389, "num_env_steps_trained_throughput_per_sec": 712.1067075407389, "timesteps_total": 20051760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 20051760, "timers": {"training_iteration_time_ms": 61227.716, "sample_time_ms": 60107.339, "load_time_ms": 17.066, "load_throughput": 2573606.057, "learn_time_ms": 1102.231, "learn_throughput": 39846.459, "synch_weights_time_ms": 0.916}, "counters": {"num_env_steps_sampled": 20051760, "num_env_steps_trained": 20051760, "num_agent_steps_sampled": 20051760, "num_agent_steps_trained": 20051760}, "done": false, "episodes_total": 7909, "training_iteration": 2086, "trial_id": "e8087_00000", "date": "2023-08-06_15-05-18", "timestamp": 1691323518, "time_this_iter_s": 61.679126024246216, "time_total_s": 45619.858808517456, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 16139.087380170822, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 17.462068965517243, "ram_util_percent": 71.49540229885058}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.09421314651, "policy_loss": -1996361.9055609966, "vf_loss": 4564371.901785715}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 138229.5, "diff_num_grad_updates_vs_sampler_policy": 138228.5}}, "num_env_steps_sampled": 20095680, "num_env_steps_trained": 20095680, "num_agent_steps_sampled": 20095680, "num_agent_steps_trained": 20095680}, "sampler_results": {"episode_reward_max": -149253.40012192546, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154734.90801556152, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934, -152567.25234261193, -149253.40012192546, -155136.93216253296, -156581.66724260247], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5138852568690668, "mean_inference_ms": 0.49624886183611944, "mean_action_processing_ms": 0.08949315208691974, "mean_env_wait_ms": 0.8426006167885228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545522689819336, "StateBufferConnector_ms": 0.0025606155395507812, "ViewRequirementAgentConnector_ms": 0.06667733192443848}}, "episode_reward_max": -149253.40012192546, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154734.90801556152, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152858.49940651865, -157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934, -152567.25234261193, -149253.40012192546, -155136.93216253296, -156581.66724260247], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5138852568690668, "mean_inference_ms": 0.49624886183611944, "mean_action_processing_ms": 0.08949315208691974, "mean_env_wait_ms": 0.8426006167885228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545522689819336, "StateBufferConnector_ms": 0.0025606155395507812, "ViewRequirementAgentConnector_ms": 0.06667733192443848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20095680, "num_agent_steps_trained": 20095680, "num_env_steps_sampled": 20095680, "num_env_steps_trained": 20095680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 720.2929706573152, "num_env_steps_trained_throughput_per_sec": 720.2929706573152, "timesteps_total": 20095680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 20095680, "timers": {"training_iteration_time_ms": 61225.162, "sample_time_ms": 60105.164, "load_time_ms": 17.052, "load_throughput": 2575703.954, "learn_time_ms": 1101.853, "learn_throughput": 39860.122, "synch_weights_time_ms": 0.928}, "counters": {"num_env_steps_sampled": 20095680, "num_env_steps_trained": 20095680, "num_agent_steps_sampled": 20095680, "num_agent_steps_trained": 20095680}, "done": false, "episodes_total": 7910, "training_iteration": 2087, "trial_id": "e8087_00000", "date": "2023-08-06_15-06-19", "timestamp": 1691323579, "time_this_iter_s": 60.97880673408508, "time_total_s": 45680.83761525154, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 16200.066186904907, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 17.30574712643678, "ram_util_percent": 71.5022988505747}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.84293412189095, "policy_loss": -2216061.393753986, "vf_loss": 4422894.830266035}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 138914.5}}, "num_env_steps_sampled": 20139600, "num_env_steps_trained": 20139600, "num_agent_steps_sampled": 20139600, "num_agent_steps_trained": 20139600}, "sampler_results": {"episode_reward_max": -149253.40012192546, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154754.90351774442, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934, -152567.25234261193, -149253.40012192546, -155136.93216253296, -156581.66724260247, -154858.04962481064], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5117983773106247, "mean_inference_ms": 0.4952810679835325, "mean_action_processing_ms": 0.08949358091629776, "mean_env_wait_ms": 0.8414934948391979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003543853759765625, "StateBufferConnector_ms": 0.0025587081909179688, "ViewRequirementAgentConnector_ms": 0.06668567657470703}}, "episode_reward_max": -149253.40012192546, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154754.90351774442, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157284.01201494515, -156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934, -152567.25234261193, -149253.40012192546, -155136.93216253296, -156581.66724260247, -154858.04962481064], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5117983773106247, "mean_inference_ms": 0.4952810679835325, "mean_action_processing_ms": 0.08949358091629776, "mean_env_wait_ms": 0.8414934948391979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003543853759765625, "StateBufferConnector_ms": 0.0025587081909179688, "ViewRequirementAgentConnector_ms": 0.06668567657470703}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20139600, "num_agent_steps_trained": 20139600, "num_env_steps_sampled": 20139600, "num_env_steps_trained": 20139600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.620560596503, "num_env_steps_trained_throughput_per_sec": 713.620560596503, "timesteps_total": 20139600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 20139600, "timers": {"training_iteration_time_ms": 61255.021, "sample_time_ms": 60135.105, "load_time_ms": 16.968, "load_throughput": 2588454.445, "learn_time_ms": 1101.854, "learn_throughput": 39860.089, "synch_weights_time_ms": 0.929}, "counters": {"num_env_steps_sampled": 20139600, "num_env_steps_trained": 20139600, "num_agent_steps_sampled": 20139600, "num_agent_steps_trained": 20139600}, "done": false, "episodes_total": 7911, "training_iteration": 2088, "trial_id": "e8087_00000", "date": "2023-08-06_15-07-20", "timestamp": 1691323640, "time_this_iter_s": 61.54813599586487, "time_total_s": 45742.385751247406, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 16261.614322900772, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 17.191954022988504, "ram_util_percent": 71.46436781609194}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.8877747204839, "policy_loss": -1992844.6476118348, "vf_loss": 4167742.795462828}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 139601.5, "diff_num_grad_updates_vs_sampler_policy": 139600.5}}, "num_env_steps_sampled": 20183520, "num_env_steps_trained": 20183520, "num_agent_steps_sampled": 20183520, "num_agent_steps_trained": 20183520}, "sampler_results": {"episode_reward_max": -149253.40012192546, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154694.9487191564, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934, -152567.25234261193, -149253.40012192546, -155136.93216253296, -156581.66724260247, -154858.04962481064, -151288.53215614235], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5097417448520755, "mean_inference_ms": 0.4943273833334675, "mean_action_processing_ms": 0.08949402305199708, "mean_env_wait_ms": 0.8404027856082839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003555774688720703, "StateBufferConnector_ms": 0.0025589466094970703, "ViewRequirementAgentConnector_ms": 0.06662535667419434}}, "episode_reward_max": -149253.40012192546, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154694.9487191564, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156737.3444917577, -152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934, -152567.25234261193, -149253.40012192546, -155136.93216253296, -156581.66724260247, -154858.04962481064, -151288.53215614235], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5097417448520755, "mean_inference_ms": 0.4943273833334675, "mean_action_processing_ms": 0.08949402305199708, "mean_env_wait_ms": 0.8404027856082839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003555774688720703, "StateBufferConnector_ms": 0.0025589466094970703, "ViewRequirementAgentConnector_ms": 0.06662535667419434}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20183520, "num_agent_steps_trained": 20183520, "num_env_steps_sampled": 20183520, "num_env_steps_trained": 20183520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.3755769675664, "num_env_steps_trained_throughput_per_sec": 715.3755769675664, "timesteps_total": 20183520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 20183520, "timers": {"training_iteration_time_ms": 61271.911, "sample_time_ms": 60151.261, "load_time_ms": 17.036, "load_throughput": 2578014.514, "learn_time_ms": 1102.524, "learn_throughput": 39835.855, "synch_weights_time_ms": 0.928}, "counters": {"num_env_steps_sampled": 20183520, "num_env_steps_trained": 20183520, "num_agent_steps_sampled": 20183520, "num_agent_steps_trained": 20183520}, "done": false, "episodes_total": 7912, "training_iteration": 2089, "trial_id": "e8087_00000", "date": "2023-08-06_15-08-22", "timestamp": 1691323702, "time_this_iter_s": 61.39743685722351, "time_total_s": 45803.78318810463, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 16323.011759757996, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 17.43103448275862, "ram_util_percent": 71.42873563218392}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9026166287525, "policy_loss": -2179060.0895504965, "vf_loss": 4437034.439504373}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 140287.5, "diff_num_grad_updates_vs_sampler_policy": 140286.5}}, "num_env_steps_sampled": 20227440, "num_env_steps_trained": 20227440, "num_agent_steps_sampled": 20227440, "num_agent_steps_trained": 20227440}, "sampler_results": {"episode_reward_max": -149253.40012192546, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154674.58098352738, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934, -152567.25234261193, -149253.40012192546, -155136.93216253296, -156581.66724260247, -154858.04962481064, -151288.53215614235, -154700.57092885752], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5077144974862798, "mean_inference_ms": 0.4933875204628337, "mean_action_processing_ms": 0.08949446634910291, "mean_env_wait_ms": 0.8393273996551837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003551006317138672, "StateBufferConnector_ms": 0.0025572776794433594, "ViewRequirementAgentConnector_ms": 0.0665750503540039}}, "episode_reward_max": -149253.40012192546, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154674.58098352738, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152946.62002942036, -154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934, -152567.25234261193, -149253.40012192546, -155136.93216253296, -156581.66724260247, -154858.04962481064, -151288.53215614235, -154700.57092885752], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5077144974862798, "mean_inference_ms": 0.4933875204628337, "mean_action_processing_ms": 0.08949446634910291, "mean_env_wait_ms": 0.8393273996551837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003551006317138672, "StateBufferConnector_ms": 0.0025572776794433594, "ViewRequirementAgentConnector_ms": 0.0665750503540039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20227440, "num_agent_steps_trained": 20227440, "num_env_steps_sampled": 20227440, "num_env_steps_trained": 20227440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 720.770714137376, "num_env_steps_trained_throughput_per_sec": 720.770714137376, "timesteps_total": 20227440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 20227440, "timers": {"training_iteration_time_ms": 61270.381, "sample_time_ms": 60151.086, "load_time_ms": 16.95, "load_throughput": 2591104.986, "learn_time_ms": 1101.258, "learn_throughput": 39881.653, "synch_weights_time_ms": 0.925}, "counters": {"num_env_steps_sampled": 20227440, "num_env_steps_trained": 20227440, "num_agent_steps_sampled": 20227440, "num_agent_steps_trained": 20227440}, "done": false, "episodes_total": 7913, "training_iteration": 2090, "trial_id": "e8087_00000", "date": "2023-08-06_15-09-23", "timestamp": 1691323763, "time_this_iter_s": 60.938141107559204, "time_total_s": 45864.72132921219, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 16383.949900865555, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 17.723255813953493, "ram_util_percent": 71.40930232558141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.982654449196, "policy_loss": -2277819.6135602677, "vf_loss": 4358351.442966472}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 140973.5, "diff_num_grad_updates_vs_sampler_policy": 140972.5}}, "num_env_steps_sampled": 20271360, "num_env_steps_trained": 20271360, "num_agent_steps_sampled": 20271360, "num_agent_steps_trained": 20271360}, "sampler_results": {"episode_reward_max": -149253.40012192546, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154682.415780997, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934, -152567.25234261193, -149253.40012192546, -155136.93216253296, -156581.66724260247, -154858.04962481064, -151288.53215614235, -154700.57092885752, -153730.09977637982], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5057162172926295, "mean_inference_ms": 0.492461088954176, "mean_action_processing_ms": 0.08949490823932883, "mean_env_wait_ms": 0.8382674210074444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003551006317138672, "StateBufferConnector_ms": 0.0025556087493896484, "ViewRequirementAgentConnector_ms": 0.06658935546875}}, "episode_reward_max": -149253.40012192546, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154682.415780997, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154602.73452609897, -155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934, -152567.25234261193, -149253.40012192546, -155136.93216253296, -156581.66724260247, -154858.04962481064, -151288.53215614235, -154700.57092885752, -153730.09977637982], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5057162172926295, "mean_inference_ms": 0.492461088954176, "mean_action_processing_ms": 0.08949490823932883, "mean_env_wait_ms": 0.8382674210074444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003551006317138672, "StateBufferConnector_ms": 0.0025556087493896484, "ViewRequirementAgentConnector_ms": 0.06658935546875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20271360, "num_agent_steps_trained": 20271360, "num_env_steps_sampled": 20271360, "num_env_steps_trained": 20271360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.3268300090289, "num_env_steps_trained_throughput_per_sec": 714.3268300090289, "timesteps_total": 20271360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 20271360, "timers": {"training_iteration_time_ms": 61300.295, "sample_time_ms": 60180.37, "load_time_ms": 16.805, "load_throughput": 2613533.051, "learn_time_ms": 1102.035, "learn_throughput": 39853.533, "synch_weights_time_ms": 0.925}, "counters": {"num_env_steps_sampled": 20271360, "num_env_steps_trained": 20271360, "num_agent_steps_sampled": 20271360, "num_agent_steps_trained": 20271360}, "done": false, "episodes_total": 7914, "training_iteration": 2091, "trial_id": "e8087_00000", "date": "2023-08-06_15-10-24", "timestamp": 1691323824, "time_this_iter_s": 61.48784828186035, "time_total_s": 45926.20917749405, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 16445.437749147415, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 17.0367816091954, "ram_util_percent": 71.42183908045976}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0000133013934, "policy_loss": -2175470.672525567, "vf_loss": 4581111.923469388}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 141659.5, "diff_num_grad_updates_vs_sampler_policy": 141658.5}}, "num_env_steps_sampled": 20315280, "num_env_steps_trained": 20315280, "num_agent_steps_sampled": 20315280, "num_agent_steps_trained": 20315280}, "sampler_results": {"episode_reward_max": -149253.40012192546, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154704.38469165633, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934, -152567.25234261193, -149253.40012192546, -155136.93216253296, -156581.66724260247, -154858.04962481064, -151288.53215614235, -154700.57092885752, -153730.09977637982, -156799.62559203568], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5037462896055714, "mean_inference_ms": 0.4915476941686384, "mean_action_processing_ms": 0.08949530253301756, "mean_env_wait_ms": 0.8372217480489417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035517215728759766, "StateBufferConnector_ms": 0.0025556087493896484, "ViewRequirementAgentConnector_ms": 0.06659054756164551}}, "episode_reward_max": -149253.40012192546, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154704.38469165633, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155787.719490144, -156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934, -152567.25234261193, -149253.40012192546, -155136.93216253296, -156581.66724260247, -154858.04962481064, -151288.53215614235, -154700.57092885752, -153730.09977637982, -156799.62559203568], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5037462896055714, "mean_inference_ms": 0.4915476941686384, "mean_action_processing_ms": 0.08949530253301756, "mean_env_wait_ms": 0.8372217480489417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035517215728759766, "StateBufferConnector_ms": 0.0025556087493896484, "ViewRequirementAgentConnector_ms": 0.06659054756164551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20315280, "num_agent_steps_trained": 20315280, "num_env_steps_sampled": 20315280, "num_env_steps_trained": 20315280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.8791952250979, "num_env_steps_trained_throughput_per_sec": 717.8791952250979, "timesteps_total": 20315280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 20315280, "timers": {"training_iteration_time_ms": 61306.964, "sample_time_ms": 60186.883, "load_time_ms": 16.833, "load_throughput": 2609231.506, "learn_time_ms": 1102.164, "learn_throughput": 39848.865, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 20315280, "num_env_steps_trained": 20315280, "num_agent_steps_sampled": 20315280, "num_agent_steps_trained": 20315280}, "done": false, "episodes_total": 7915, "training_iteration": 2092, "trial_id": "e8087_00000", "date": "2023-08-06_15-11-25", "timestamp": 1691323885, "time_this_iter_s": 61.18304204940796, "time_total_s": 45987.39221954346, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 16506.620791196823, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 17.27241379310345, "ram_util_percent": 71.39310344827587}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.94210882159086, "policy_loss": -2349937.412462418, "vf_loss": 4333405.907161078}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 142345.5, "diff_num_grad_updates_vs_sampler_policy": 142344.5}}, "num_env_steps_sampled": 20359200, "num_env_steps_trained": 20359200, "num_agent_steps_sampled": 20359200, "num_agent_steps_trained": 20359200}, "sampler_results": {"episode_reward_max": -149253.40012192546, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154683.46180573307, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934, -152567.25234261193, -149253.40012192546, -155136.93216253296, -156581.66724260247, -154858.04962481064, -151288.53215614235, -154700.57092885752, -153730.09977637982, -156799.62559203568, -153695.43089781541], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5018040868596799, "mean_inference_ms": 0.49064705370857564, "mean_action_processing_ms": 0.0894956499745818, "mean_env_wait_ms": 0.8361908377751228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035490989685058594, "StateBufferConnector_ms": 0.0025589466094970703, "ViewRequirementAgentConnector_ms": 0.0665583610534668}}, "episode_reward_max": -149253.40012192546, "episode_reward_min": -159216.62344513898, "episode_reward_mean": -154683.46180573307, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156219.7186884365, -155177.98081959272, -155632.02533491395, -155357.48548117527, -153000.70877569405, -154716.39446686662, -153443.27422756335, -157136.41125536736, -154844.00377340533, -154558.56084908237, -153472.83505431612, -156159.98328108137, -159003.46928614422, -150445.75117824425, -153989.6041702199, -156230.2227618749, -154364.42808738555, -155378.58129717852, -155701.6925756103, -155303.56825233024, -154552.82187116187, -156932.63525144578, -154482.82286259966, -154889.80891424476, -153571.56566298255, -154172.74153926078, -156912.71001948926, -154745.22671874237, -155108.06523045752, -151229.41604686977, -156778.31861310423, -152781.34081929235, -153801.98899747053, -154509.03932684232, -151539.00281345492, -152811.97374297772, -156678.5380934255, -155219.9989825636, -156302.76919614273, -155944.58182273473, -153321.3434444545, -155705.9717592136, -157309.39806183556, -151205.90245698055, -157160.06128238954, -153788.81083147848, -159216.62344513898, -154799.52873023832, -152843.94687463294, -156671.0640398284, -154717.69541992518, -157635.26119743244, -156844.92776638095, -155330.89757808566, -154685.6639527648, -152136.18356632054, -152873.38130484452, -153785.4622300178, -154252.65494834937, -150441.39859595816, -157199.52194243818, -157764.00145614386, -154379.75300677947, -154819.5858529294, -154543.8706491728, -151949.53381782037, -153225.71680509317, -154477.58108071494, -151571.53299201917, -151450.87122036424, -154805.36908466823, -154883.60236056193, -156381.4294093708, -156678.78708317032, -154459.66896868972, -151239.70324130793, -156341.74853556725, -152767.61057295927, -155964.18250538848, -158621.47258237566, -152117.69066593354, -155859.84853764914, -156326.18757658757, -156996.03463350155, -152022.56428972035, -155619.98811385318, -155619.1167140756, -154445.21791698266, -154439.59160415872, -154934.59287957934, -152567.25234261193, -149253.40012192546, -155136.93216253296, -156581.66724260247, -154858.04962481064, -151288.53215614235, -154700.57092885752, -153730.09977637982, -156799.62559203568, -153695.43089781541], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5018040868596799, "mean_inference_ms": 0.49064705370857564, "mean_action_processing_ms": 0.0894956499745818, "mean_env_wait_ms": 0.8361908377751228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035490989685058594, "StateBufferConnector_ms": 0.0025589466094970703, "ViewRequirementAgentConnector_ms": 0.0665583610534668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20359200, "num_agent_steps_trained": 20359200, "num_env_steps_sampled": 20359200, "num_env_steps_trained": 20359200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.1104815909468, "num_env_steps_trained_throughput_per_sec": 712.1104815909468, "timesteps_total": 20359200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 20359200, "timers": {"training_iteration_time_ms": 61349.122, "sample_time_ms": 60227.723, "load_time_ms": 16.805, "load_throughput": 2613458.894, "learn_time_ms": 1103.507, "learn_throughput": 39800.386, "synch_weights_time_ms": 0.926}, "counters": {"num_env_steps_sampled": 20359200, "num_env_steps_trained": 20359200, "num_agent_steps_sampled": 20359200, "num_agent_steps_trained": 20359200}, "done": true, "episodes_total": 7916, "training_iteration": 2093, "trial_id": "e8087_00000", "date": "2023-08-06_15-12-27", "timestamp": 1691323947, "time_this_iter_s": 61.67868113517761, "time_total_s": 46049.070900678635, "pid": 79285, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[11267760, 5e-11], [11619120, 8e-12], [11970480, 2.5e-12], [12321840, 2.5e-12], [12673200, 2.5e-12], [13024560, 2.5e-12], [13375920, 1e-12], [13727280, 1e-12], [14078640, 1e-12], [14430000, 5e-13], [14781360, 5e-13], [15132720, 5e-13], [15484080, 5e-13], [15835440, 1e-13], [16186800, 1e-13], [16538160, 1e-13], [16889520, 1e-13], [17240880, 5e-14], [17592240, 5e-14], [17943600, 2.5e-14], [18294960, 2.5e-14], [18646320, 1e-14], [18997680, 1e-14], [19349040, 5e-15], [19700400, 5e-15], [20051760, 1e-15]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 11343888}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x307af8c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 16568.299472332, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 17.386206896551727, "ram_util_percent": 71.37356321839081}}
