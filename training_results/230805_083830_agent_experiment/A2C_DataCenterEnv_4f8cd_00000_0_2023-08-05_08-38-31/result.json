{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -319.5893859863281, "policy_loss": -13878908.0, "vf_loss": 11054610.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}}, "num_env_steps_sampled": 1213922, "num_env_steps_trained": 1213922, "num_agent_steps_sampled": 1213922, "num_agent_steps_trained": 1213922}, "sampler_results": {"episode_reward_max": -1187.4258645544264, "episode_reward_min": -1194.8813556625362, "episode_reward_mean": -1191.1536101084812, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362], "episode_lengths": [121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.844078848881978, "mean_inference_ms": 0.3893532380155085, "mean_action_processing_ms": 0.09508682376563303, "mean_env_wait_ms": 33.98306968280808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051021575927734375, "StateBufferConnector_ms": 0.0031828880310058594, "ViewRequirementAgentConnector_ms": 0.0836491584777832}}, "episode_reward_max": -1187.4258645544264, "episode_reward_min": -1194.8813556625362, "episode_reward_mean": -1191.1536101084812, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362], "episode_lengths": [121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.844078848881978, "mean_inference_ms": 0.3893532380155085, "mean_action_processing_ms": 0.09508682376563303, "mean_env_wait_ms": 33.98306968280808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051021575927734375, "StateBufferConnector_ms": 0.0031828880310058594, "ViewRequirementAgentConnector_ms": 0.0836491584777832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1213922, "num_agent_steps_trained": 1213922, "num_env_steps_sampled": 1213922, "num_env_steps_trained": 1213922, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 17.96188134445736, "num_env_steps_trained_throughput_per_sec": 17.96188134445736, "timesteps_total": 1213922, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1213922, "timers": {"training_iteration_time_ms": 6736.47, "sample_time_ms": 6725.595, "load_time_ms": 0.389, "load_throughput": 311165.41, "learn_time_ms": 9.714, "learn_throughput": 12456.239, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 1213922, "num_env_steps_trained": 1213922, "num_agent_steps_sampled": 1213922, "num_agent_steps_trained": 1213922}, "done": false, "episodes_total": 3854, "training_iteration": 756, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-38-50", "timestamp": 1691213930, "time_this_iter_s": 13.47544813156128, "time_total_s": 10251.008404016495, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13.47544813156128, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 33.295, "ram_util_percent": 66.72}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -319.212890625, "policy_loss": -1864283.375, "vf_loss": 11120389.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}}, "num_env_steps_sampled": 1214164, "num_env_steps_trained": 1214164, "num_agent_steps_sampled": 1214164, "num_agent_steps_trained": 1214164}, "sampler_results": {"episode_reward_max": -1187.4258645544264, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1194.3454935729615, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706], "episode_lengths": [121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.25878176657387, "mean_inference_ms": 0.3883668895004653, "mean_action_processing_ms": 0.0950329517469535, "mean_env_wait_ms": 31.342431607909326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005447864532470703, "StateBufferConnector_ms": 0.0031769275665283203, "ViewRequirementAgentConnector_ms": 0.08565783500671387}}, "episode_reward_max": -1187.4258645544264, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1194.3454935729615, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706], "episode_lengths": [121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.25878176657387, "mean_inference_ms": 0.3883668895004653, "mean_action_processing_ms": 0.0950329517469535, "mean_env_wait_ms": 31.342431607909326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005447864532470703, "StateBufferConnector_ms": 0.0031769275665283203, "ViewRequirementAgentConnector_ms": 0.08565783500671387}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1214164, "num_agent_steps_trained": 1214164, "num_env_steps_sampled": 1214164, "num_env_steps_trained": 1214164, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.525518808588064, "num_env_steps_trained_throughput_per_sec": 21.525518808588064, "timesteps_total": 1214164, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1214164, "timers": {"training_iteration_time_ms": 6178.847, "sample_time_ms": 6171.487, "load_time_ms": 0.3, "load_throughput": 402866.27, "learn_time_ms": 6.295, "learn_throughput": 19220.981, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 1214164, "num_env_steps_trained": 1214164, "num_agent_steps_sampled": 1214164, "num_agent_steps_trained": 1214164}, "done": false, "episodes_total": 3856, "training_iteration": 757, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-39-02", "timestamp": 1691213942, "time_this_iter_s": 11.244833946228027, "time_total_s": 10262.253237962723, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 24.720282077789307, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 20.481250000000003, "ram_util_percent": 66.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -319.277587890625, "policy_loss": -14470834.0, "vf_loss": 10925656.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}}, "num_env_steps_sampled": 1214406, "num_env_steps_trained": 1214406, "num_agent_steps_sampled": 1214406, "num_agent_steps_trained": 1214406}, "sampler_results": {"episode_reward_max": -1187.4258645544264, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1193.0524387097596, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936], "episode_lengths": [121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.43869052417155, "mean_inference_ms": 0.3877564421531388, "mean_action_processing_ms": 0.09500102222238584, "mean_env_wait_ms": 29.895534850553314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005884965260823567, "StateBufferConnector_ms": 0.0031908353169759116, "ViewRequirementAgentConnector_ms": 0.08511145909627278}}, "episode_reward_max": -1187.4258645544264, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1193.0524387097596, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936], "episode_lengths": [121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.43869052417155, "mean_inference_ms": 0.3877564421531388, "mean_action_processing_ms": 0.09500102222238584, "mean_env_wait_ms": 29.895534850553314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005884965260823567, "StateBufferConnector_ms": 0.0031908353169759116, "ViewRequirementAgentConnector_ms": 0.08511145909627278}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1214406, "num_agent_steps_trained": 1214406, "num_env_steps_sampled": 1214406, "num_env_steps_trained": 1214406, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.646383114456796, "num_env_steps_trained_throughput_per_sec": 21.646383114456796, "timesteps_total": 1214406, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1214406, "timers": {"training_iteration_time_ms": 5982.509, "sample_time_ms": 5976.311, "load_time_ms": 0.272, "load_throughput": 445575.754, "learn_time_ms": 5.165, "learn_throughput": 23428.621, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 1214406, "num_env_steps_trained": 1214406, "num_agent_steps_sampled": 1214406, "num_agent_steps_trained": 1214406}, "done": false, "episodes_total": 3858, "training_iteration": 758, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-39-13", "timestamp": 1691213953, "time_this_iter_s": 11.1821870803833, "time_total_s": 10273.435425043106, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 35.90246915817261, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 21.94375, "ram_util_percent": 66.63125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 240820.140625, "vf_loss": 10909448.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 1214648, "num_env_steps_trained": 1214648, "num_agent_steps_sampled": 1214648, "num_agent_steps_trained": 1214648}, "sampler_results": {"episode_reward_max": -1187.4258645544264, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1192.5779809913624, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.551630655481418, "mean_inference_ms": 0.38729510736573775, "mean_action_processing_ms": 0.09494222895622755, "mean_env_wait_ms": 28.938745431653036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005760788917541504, "StateBufferConnector_ms": 0.0032067298889160156, "ViewRequirementAgentConnector_ms": 0.08422136306762695}}, "episode_reward_max": -1187.4258645544264, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1192.5779809913624, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.551630655481418, "mean_inference_ms": 0.38729510736573775, "mean_action_processing_ms": 0.09494222895622755, "mean_env_wait_ms": 28.938745431653036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005760788917541504, "StateBufferConnector_ms": 0.0032067298889160156, "ViewRequirementAgentConnector_ms": 0.08422136306762695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1214648, "num_agent_steps_trained": 1214648, "num_env_steps_sampled": 1214648, "num_env_steps_trained": 1214648, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.7482539469296, "num_env_steps_trained_throughput_per_sec": 21.7482539469296, "timesteps_total": 1214648, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1214648, "timers": {"training_iteration_time_ms": 5877.795, "sample_time_ms": 5872.197, "load_time_ms": 0.259, "load_throughput": 467859.676, "learn_time_ms": 4.574, "learn_throughput": 26455.761, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 1214648, "num_env_steps_trained": 1214648, "num_agent_steps_sampled": 1214648, "num_agent_steps_trained": 1214648}, "done": false, "episodes_total": 3860, "training_iteration": 759, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-39-24", "timestamp": 1691213964, "time_this_iter_s": 11.129681825637817, "time_total_s": 10284.565106868744, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 47.032150983810425, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.279999999999998, "ram_util_percent": 66.68666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 240820.140625, "vf_loss": 10909448.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 9.0}}, "num_env_steps_sampled": 1214890, "num_env_steps_trained": 1214890, "num_agent_steps_sampled": 1214890, "num_agent_steps_trained": 1214890}, "sampler_results": {"episode_reward_max": -1187.4258645544264, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1191.5475577039754, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.62761192811339, "mean_inference_ms": 0.3867511401508784, "mean_action_processing_ms": 0.0948444097274014, "mean_env_wait_ms": 28.251974169728065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005650520324707031, "StateBufferConnector_ms": 0.0032186508178710938, "ViewRequirementAgentConnector_ms": 0.08414506912231445}}, "episode_reward_max": -1187.4258645544264, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1191.5475577039754, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.62761192811339, "mean_inference_ms": 0.3867511401508784, "mean_action_processing_ms": 0.0948444097274014, "mean_env_wait_ms": 28.251974169728065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005650520324707031, "StateBufferConnector_ms": 0.0032186508178710938, "ViewRequirementAgentConnector_ms": 0.08414506912231445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1214890, "num_agent_steps_trained": 1214890, "num_env_steps_sampled": 1214890, "num_env_steps_trained": 1214890, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.792389795435426, "num_env_steps_trained_throughput_per_sec": 21.792389795435426, "timesteps_total": 1214890, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1214890, "timers": {"training_iteration_time_ms": 5812.713, "sample_time_ms": 5807.476, "load_time_ms": 0.251, "load_throughput": 482883.715, "learn_time_ms": 4.232, "learn_throughput": 28594.734, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 1214890, "num_env_steps_trained": 1214890, "num_agent_steps_sampled": 1214890, "num_agent_steps_trained": 1214890}, "done": false, "episodes_total": 3862, "training_iteration": 760, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-39-35", "timestamp": 1691213975, "time_this_iter_s": 11.107056856155396, "time_total_s": 10295.6721637249, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 58.13920783996582, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 20.25625, "ram_util_percent": 66.57499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -319.2613830566406, "policy_loss": -2596548.0, "vf_loss": 10959044.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}}, "num_env_steps_sampled": 1215132, "num_env_steps_trained": 1215132, "num_agent_steps_sampled": 1215132, "num_agent_steps_trained": 1215132}, "sampler_results": {"episode_reward_max": -1187.4258645544264, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1191.3991961082097, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.687121998341524, "mean_inference_ms": 0.3861647845770211, "mean_action_processing_ms": 0.09472411923633113, "mean_env_wait_ms": 27.744043594461385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005632638931274414, "StateBufferConnector_ms": 0.0031908353169759116, "ViewRequirementAgentConnector_ms": 0.08432070414225261}}, "episode_reward_max": -1187.4258645544264, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1191.3991961082097, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.687121998341524, "mean_inference_ms": 0.3861647845770211, "mean_action_processing_ms": 0.09472411923633113, "mean_env_wait_ms": 27.744043594461385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005632638931274414, "StateBufferConnector_ms": 0.0031908353169759116, "ViewRequirementAgentConnector_ms": 0.08432070414225261}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1215132, "num_agent_steps_trained": 1215132, "num_env_steps_sampled": 1215132, "num_env_steps_trained": 1215132, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.509835634865098, "num_env_steps_trained_throughput_per_sec": 21.509835634865098, "timesteps_total": 1215132, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1215132, "timers": {"training_iteration_time_ms": 5590.483, "sample_time_ms": 5586.669, "load_time_ms": 0.217, "load_throughput": 558563.487, "learn_time_ms": 2.852, "learn_throughput": 42433.302, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 1215132, "num_env_steps_trained": 1215132, "num_agent_steps_sampled": 1215132, "num_agent_steps_trained": 1215132}, "done": false, "episodes_total": 3864, "training_iteration": 761, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-39-46", "timestamp": 1691213986, "time_this_iter_s": 11.253193140029907, "time_total_s": 10306.92535686493, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 69.39240097999573, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.581249999999997, "ram_util_percent": 66.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -319.5639953613281, "policy_loss": -22863206.0, "vf_loss": 11130092.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 1215374, "num_env_steps_trained": 1215374, "num_agent_steps_sampled": 1215374, "num_agent_steps_trained": 1215374}, "sampler_results": {"episode_reward_max": -1187.4258645544264, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1191.7182075257806, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.737282566398513, "mean_inference_ms": 0.38569231212584565, "mean_action_processing_ms": 0.09461913729678129, "mean_env_wait_ms": 27.352184356306648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005899156842912946, "StateBufferConnector_ms": 0.003142016274588449, "ViewRequirementAgentConnector_ms": 0.0844052859715053}}, "episode_reward_max": -1187.4258645544264, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1191.7182075257806, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.737282566398513, "mean_inference_ms": 0.38569231212584565, "mean_action_processing_ms": 0.09461913729678129, "mean_env_wait_ms": 27.352184356306648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005899156842912946, "StateBufferConnector_ms": 0.003142016274588449, "ViewRequirementAgentConnector_ms": 0.0844052859715053}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1215374, "num_agent_steps_trained": 1215374, "num_env_steps_sampled": 1215374, "num_env_steps_trained": 1215374, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.419959238367174, "num_env_steps_trained_throughput_per_sec": 21.419959238367174, "timesteps_total": 1215374, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1215374, "timers": {"training_iteration_time_ms": 5596.023, "sample_time_ms": 5592.218, "load_time_ms": 0.218, "load_throughput": 555141.965, "learn_time_ms": 2.838, "learn_throughput": 42636.142, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 1215374, "num_env_steps_trained": 1215374, "num_agent_steps_sampled": 1215374, "num_agent_steps_trained": 1215374}, "done": false, "episodes_total": 3866, "training_iteration": 762, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-39-58", "timestamp": 1691213998, "time_this_iter_s": 11.300425052642822, "time_total_s": 10318.225781917572, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 80.69282603263855, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 20.03125, "ram_util_percent": 66.63749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -319.5406799316406, "policy_loss": -2887176.5, "vf_loss": 11039750.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16.0, "diff_num_grad_updates_vs_sampler_policy": 15.0}}, "num_env_steps_sampled": 1215616, "num_env_steps_trained": 1215616, "num_agent_steps_sampled": 1215616, "num_agent_steps_trained": 1215616}, "sampler_results": {"episode_reward_max": -1187.4258645544264, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1191.919645569522, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.775911425097846, "mean_inference_ms": 0.3855198704701853, "mean_action_processing_ms": 0.09456566263368821, "mean_env_wait_ms": 27.03403947511735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005875527858734131, "StateBufferConnector_ms": 0.0031381845474243164, "ViewRequirementAgentConnector_ms": 0.08464157581329346}}, "episode_reward_max": -1187.4258645544264, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1191.919645569522, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.775911425097846, "mean_inference_ms": 0.3855198704701853, "mean_action_processing_ms": 0.09456566263368821, "mean_env_wait_ms": 27.03403947511735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005875527858734131, "StateBufferConnector_ms": 0.0031381845474243164, "ViewRequirementAgentConnector_ms": 0.08464157581329346}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1215616, "num_agent_steps_trained": 1215616, "num_env_steps_sampled": 1215616, "num_env_steps_trained": 1215616, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.68406093027558, "num_env_steps_trained_throughput_per_sec": 21.68406093027558, "timesteps_total": 1215616, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1215616, "timers": {"training_iteration_time_ms": 5594.081, "sample_time_ms": 5590.241, "load_time_ms": 0.22, "load_throughput": 551103.034, "learn_time_ms": 2.866, "learn_throughput": 42216.927, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 1215616, "num_env_steps_trained": 1215616, "num_agent_steps_sampled": 1215616, "num_agent_steps_trained": 1215616}, "done": false, "episodes_total": 3868, "training_iteration": 763, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-40-09", "timestamp": 1691214009, "time_this_iter_s": 11.162799835205078, "time_total_s": 10329.388581752777, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 91.85562586784363, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 20.14375, "ram_util_percent": 66.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -319.28021240234375, "policy_loss": -14678571.0, "vf_loss": 10922936.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18.0, "diff_num_grad_updates_vs_sampler_policy": 17.0}}, "num_env_steps_sampled": 1215858, "num_env_steps_trained": 1215858, "num_agent_steps_sampled": 1215858, "num_agent_steps_trained": 1215858}, "sampler_results": {"episode_reward_max": -1187.4258645544264, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1191.7547368513817, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.81238863338269, "mean_inference_ms": 0.3853518451460007, "mean_action_processing_ms": 0.0945138317691606, "mean_env_wait_ms": 26.767666919813315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005870395236545139, "StateBufferConnector_ms": 0.003106064266628689, "ViewRequirementAgentConnector_ms": 0.08453792995876735}}, "episode_reward_max": -1187.4258645544264, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1191.7547368513817, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.81238863338269, "mean_inference_ms": 0.3853518451460007, "mean_action_processing_ms": 0.0945138317691606, "mean_env_wait_ms": 26.767666919813315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005870395236545139, "StateBufferConnector_ms": 0.003106064266628689, "ViewRequirementAgentConnector_ms": 0.08453792995876735}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1215858, "num_agent_steps_trained": 1215858, "num_env_steps_sampled": 1215858, "num_env_steps_trained": 1215858, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.557439170818686, "num_env_steps_trained_throughput_per_sec": 21.557439170818686, "timesteps_total": 1215858, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1215858, "timers": {"training_iteration_time_ms": 5603.93, "sample_time_ms": 5600.075, "load_time_ms": 0.22, "load_throughput": 549789.605, "learn_time_ms": 2.888, "learn_throughput": 41895.95, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 1215858, "num_env_steps_trained": 1215858, "num_agent_steps_sampled": 1215858, "num_agent_steps_trained": 1215858}, "done": false, "episodes_total": 3870, "training_iteration": 764, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-40-20", "timestamp": 1691214020, "time_this_iter_s": 11.228269100189209, "time_total_s": 10340.616850852966, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 103.08389496803284, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 20.03125, "ram_util_percent": 66.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 240709.75, "vf_loss": 10899795.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}}, "num_env_steps_sampled": 1216100, "num_env_steps_trained": 1216100, "num_agent_steps_sampled": 1216100, "num_agent_steps_trained": 1216100}, "sampler_results": {"episode_reward_max": -1187.001940084544, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1191.5188928443263, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.845910828090744, "mean_inference_ms": 0.38516475772552716, "mean_action_processing_ms": 0.09445936088457374, "mean_env_wait_ms": 26.546488148675184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00580906867980957, "StateBufferConnector_ms": 0.0030863285064697266, "ViewRequirementAgentConnector_ms": 0.08463382720947266}}, "episode_reward_max": -1187.001940084544, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1191.5188928443263, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.845910828090744, "mean_inference_ms": 0.38516475772552716, "mean_action_processing_ms": 0.09445936088457374, "mean_env_wait_ms": 26.546488148675184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00580906867980957, "StateBufferConnector_ms": 0.0030863285064697266, "ViewRequirementAgentConnector_ms": 0.08463382720947266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216100, "num_agent_steps_trained": 1216100, "num_env_steps_sampled": 1216100, "num_env_steps_trained": 1216100, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.316584412300603, "num_env_steps_trained_throughput_per_sec": 21.316584412300603, "timesteps_total": 1216100, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1216100, "timers": {"training_iteration_time_ms": 5628.716, "sample_time_ms": 5624.852, "load_time_ms": 0.221, "load_throughput": 546827.695, "learn_time_ms": 2.884, "learn_throughput": 41958.298, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 1216100, "num_env_steps_trained": 1216100, "num_agent_steps_sampled": 1216100, "num_agent_steps_trained": 1216100}, "done": false, "episodes_total": 3872, "training_iteration": 765, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-40-32", "timestamp": 1691214032, "time_this_iter_s": 11.35506296157837, "time_total_s": 10351.971913814545, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 114.4389579296112, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 20.431250000000002, "ram_util_percent": 66.29374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -319.27410888671875, "policy_loss": -2751013.5, "vf_loss": 10929295.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}}, "num_env_steps_sampled": 1216342, "num_env_steps_trained": 1216342, "num_agent_steps_sampled": 1216342, "num_agent_steps_trained": 1216342}, "sampler_results": {"episode_reward_max": -1187.001940084544, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1191.2721604194373, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.872691553837424, "mean_inference_ms": 0.3849701730882547, "mean_action_processing_ms": 0.09440863505214198, "mean_env_wait_ms": 26.35614968936625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005794655192982067, "StateBufferConnector_ms": 0.003072348507967862, "ViewRequirementAgentConnector_ms": 0.08471662347966974}}, "episode_reward_max": -1187.001940084544, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1191.2721604194373, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.872691553837424, "mean_inference_ms": 0.3849701730882547, "mean_action_processing_ms": 0.09440863505214198, "mean_env_wait_ms": 26.35614968936625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005794655192982067, "StateBufferConnector_ms": 0.003072348507967862, "ViewRequirementAgentConnector_ms": 0.08471662347966974}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216342, "num_agent_steps_trained": 1216342, "num_env_steps_sampled": 1216342, "num_env_steps_trained": 1216342, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.72320110569814, "num_env_steps_trained_throughput_per_sec": 21.72320110569814, "timesteps_total": 1216342, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1216342, "timers": {"training_iteration_time_ms": 5617.666, "sample_time_ms": 5613.787, "load_time_ms": 0.221, "load_throughput": 547890.299, "learn_time_ms": 2.897, "learn_throughput": 41764.248, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 1216342, "num_env_steps_trained": 1216342, "num_agent_steps_sampled": 1216342, "num_agent_steps_trained": 1216342}, "done": false, "episodes_total": 3874, "training_iteration": 766, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-40-43", "timestamp": 1691214043, "time_this_iter_s": 11.142680168151855, "time_total_s": 10363.114593982697, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 125.58163809776306, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 19.25, "ram_util_percent": 66.26875000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 240820.140625, "vf_loss": 10909448.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}}, "num_env_steps_sampled": 1216584, "num_env_steps_trained": 1216584, "num_agent_steps_sampled": 1216584, "num_agent_steps_trained": 1216584}, "sampler_results": {"episode_reward_max": -1187.001940084544, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1191.0093085371752, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.893856415345578, "mean_inference_ms": 0.384814345915383, "mean_action_processing_ms": 0.09436522872761305, "mean_env_wait_ms": 26.193517603491497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005907813707987468, "StateBufferConnector_ms": 0.0030408302942911782, "ViewRequirementAgentConnector_ms": 0.08472800254821777}}, "episode_reward_max": -1187.001940084544, "episode_reward_min": -1198.5240413721779, "episode_reward_mean": -1191.0093085371752, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.893856415345578, "mean_inference_ms": 0.384814345915383, "mean_action_processing_ms": 0.09436522872761305, "mean_env_wait_ms": 26.193517603491497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005907813707987468, "StateBufferConnector_ms": 0.0030408302942911782, "ViewRequirementAgentConnector_ms": 0.08472800254821777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216584, "num_agent_steps_trained": 1216584, "num_env_steps_sampled": 1216584, "num_env_steps_trained": 1216584, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.552550946068934, "num_env_steps_trained_throughput_per_sec": 21.552550946068934, "timesteps_total": 1216584, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1216584, "timers": {"training_iteration_time_ms": 5610.716, "sample_time_ms": 5606.826, "load_time_ms": 0.221, "load_throughput": 546356.749, "learn_time_ms": 2.908, "learn_throughput": 41615.277, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 1216584, "num_env_steps_trained": 1216584, "num_agent_steps_sampled": 1216584, "num_agent_steps_trained": 1216584}, "done": false, "episodes_total": 3876, "training_iteration": 767, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-40-54", "timestamp": 1691214054, "time_this_iter_s": 11.230855941772461, "time_total_s": 10374.345449924469, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 136.81249403953552, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.49375, "ram_util_percent": 66.26875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 240820.140625, "vf_loss": 10909448.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}}, "num_env_steps_sampled": 1216826, "num_env_steps_trained": 1216826, "num_agent_steps_sampled": 1216826, "num_agent_steps_trained": 1216826}, "sampler_results": {"episode_reward_max": -1187.001940084544, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.2598027231395, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.912498237775587, "mean_inference_ms": 0.38468051647238694, "mean_action_processing_ms": 0.09432497393204363, "mean_env_wait_ms": 26.051585086812743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00587610098031851, "StateBufferConnector_ms": 0.0030462558452899638, "ViewRequirementAgentConnector_ms": 0.08452213727510892}}, "episode_reward_max": -1187.001940084544, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.2598027231395, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.912498237775587, "mean_inference_ms": 0.38468051647238694, "mean_action_processing_ms": 0.09432497393204363, "mean_env_wait_ms": 26.051585086812743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00587610098031851, "StateBufferConnector_ms": 0.0030462558452899638, "ViewRequirementAgentConnector_ms": 0.08452213727510892}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216826, "num_agent_steps_trained": 1216826, "num_env_steps_sampled": 1216826, "num_env_steps_trained": 1216826, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.518402645108807, "num_env_steps_trained_throughput_per_sec": 21.518402645108807, "timesteps_total": 1216826, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1216826, "timers": {"training_iteration_time_ms": 5619.308, "sample_time_ms": 5615.463, "load_time_ms": 0.22, "load_throughput": 549610.985, "learn_time_ms": 2.871, "learn_throughput": 42152.409, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 1216826, "num_env_steps_trained": 1216826, "num_agent_steps_sampled": 1216826, "num_agent_steps_trained": 1216826}, "done": false, "episodes_total": 3878, "training_iteration": 768, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-41-05", "timestamp": 1691214065, "time_this_iter_s": 11.24851107597351, "time_total_s": 10385.593961000443, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 148.06100511550903, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.03125, "ram_util_percent": 66.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 243578.828125, "vf_loss": 11152190.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}}, "num_env_steps_sampled": 1217068, "num_env_steps_trained": 1217068, "num_agent_steps_sampled": 1217068, "num_agent_steps_trained": 1217068}, "sampler_results": {"episode_reward_max": -1187.001940084544, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.3711316152244, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.927464738903787, "mean_inference_ms": 0.3845450020919203, "mean_action_processing_ms": 0.09428700972650772, "mean_env_wait_ms": 25.927365958505963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005859988076346261, "StateBufferConnector_ms": 0.0030194010053362164, "ViewRequirementAgentConnector_ms": 0.08461390222821917}}, "episode_reward_max": -1187.001940084544, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.3711316152244, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.927464738903787, "mean_inference_ms": 0.3845450020919203, "mean_action_processing_ms": 0.09428700972650772, "mean_env_wait_ms": 25.927365958505963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005859988076346261, "StateBufferConnector_ms": 0.0030194010053362164, "ViewRequirementAgentConnector_ms": 0.08461390222821917}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1217068, "num_agent_steps_trained": 1217068, "num_env_steps_sampled": 1217068, "num_env_steps_trained": 1217068, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.585551334518026, "num_env_steps_trained_throughput_per_sec": 21.585551334518026, "timesteps_total": 1217068, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1217068, "timers": {"training_iteration_time_ms": 5617.846, "sample_time_ms": 5614.03, "load_time_ms": 0.22, "load_throughput": 550564.964, "learn_time_ms": 2.847, "learn_throughput": 42508.295, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 1217068, "num_env_steps_trained": 1217068, "num_agent_steps_sampled": 1217068, "num_agent_steps_trained": 1217068}, "done": false, "episodes_total": 3880, "training_iteration": 769, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-41-17", "timestamp": 1691214077, "time_this_iter_s": 11.213575839996338, "time_total_s": 10396.807536840439, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 159.27458095550537, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 20.881249999999998, "ram_util_percent": 66.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -319.27679443359375, "policy_loss": -5696075.5, "vf_loss": 10926564.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 29.0}}, "num_env_steps_sampled": 1217310, "num_env_steps_trained": 1217310, "num_agent_steps_sampled": 1217310, "num_agent_steps_trained": 1217310}, "sampler_results": {"episode_reward_max": -1187.001940084544, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.2066692910807, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.94180377866236, "mean_inference_ms": 0.3844157926455888, "mean_action_processing_ms": 0.0942496888023216, "mean_env_wait_ms": 25.816322600523606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005850791931152344, "StateBufferConnector_ms": 0.0030183792114257812, "ViewRequirementAgentConnector_ms": 0.0846091906229655}}, "episode_reward_max": -1187.001940084544, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.2066692910807, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.94180377866236, "mean_inference_ms": 0.3844157926455888, "mean_action_processing_ms": 0.0942496888023216, "mean_env_wait_ms": 25.816322600523606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005850791931152344, "StateBufferConnector_ms": 0.0030183792114257812, "ViewRequirementAgentConnector_ms": 0.0846091906229655}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1217310, "num_agent_steps_trained": 1217310, "num_env_steps_sampled": 1217310, "num_env_steps_trained": 1217310, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.493600898061914, "num_env_steps_trained_throughput_per_sec": 21.493600898061914, "timesteps_total": 1217310, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1217310, "timers": {"training_iteration_time_ms": 5608.496, "sample_time_ms": 5604.68, "load_time_ms": 0.219, "load_throughput": 552242.42, "learn_time_ms": 2.849, "learn_throughput": 42464.902, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 1217310, "num_env_steps_trained": 1217310, "num_agent_steps_sampled": 1217310, "num_agent_steps_trained": 1217310}, "done": false, "episodes_total": 3882, "training_iteration": 770, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-41-28", "timestamp": 1691214088, "time_this_iter_s": 11.261693000793457, "time_total_s": 10408.069229841232, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 170.53627395629883, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.537499999999998, "ram_util_percent": 66.21875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 240820.140625, "vf_loss": 10909448.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 31.0}}, "num_env_steps_sampled": 1217552, "num_env_steps_trained": 1217552, "num_agent_steps_sampled": 1217552, "num_agent_steps_trained": 1217552}, "sampler_results": {"episode_reward_max": -1187.001940084544, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.3105056166235, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.954950943470813, "mean_inference_ms": 0.3843329167710472, "mean_action_processing_ms": 0.09422382325501819, "mean_env_wait_ms": 25.71602711502332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059448182582855225, "StateBufferConnector_ms": 0.0030234456062316895, "ViewRequirementAgentConnector_ms": 0.08484572172164917}}, "episode_reward_max": -1187.001940084544, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.3105056166235, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.954950943470813, "mean_inference_ms": 0.3843329167710472, "mean_action_processing_ms": 0.09422382325501819, "mean_env_wait_ms": 25.71602711502332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059448182582855225, "StateBufferConnector_ms": 0.0030234456062316895, "ViewRequirementAgentConnector_ms": 0.08484572172164917}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1217552, "num_agent_steps_trained": 1217552, "num_env_steps_sampled": 1217552, "num_env_steps_trained": 1217552, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.59175062045183, "num_env_steps_trained_throughput_per_sec": 21.59175062045183, "timesteps_total": 1217552, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1217552, "timers": {"training_iteration_time_ms": 5615.278, "sample_time_ms": 5611.458, "load_time_ms": 0.22, "load_throughput": 550027.944, "learn_time_ms": 2.848, "learn_throughput": 42489.077, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 1217552, "num_env_steps_trained": 1217552, "num_agent_steps_sampled": 1217552, "num_agent_steps_trained": 1217552}, "done": false, "episodes_total": 3884, "training_iteration": 771, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-41-39", "timestamp": 1691214099, "time_this_iter_s": 11.210600852966309, "time_total_s": 10419.279830694199, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 181.74687480926514, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 20.50625, "ram_util_percent": 65.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 241634.046875, "vf_loss": 10980759.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}}, "num_env_steps_sampled": 1217794, "num_env_steps_trained": 1217794, "num_agent_steps_sampled": 1217794, "num_agent_steps_trained": 1217794}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.1776401838476, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.968478715212054, "mean_inference_ms": 0.38426551540438264, "mean_action_processing_ms": 0.09420145944794793, "mean_env_wait_ms": 25.624540912772293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005926805384018842, "StateBufferConnector_ms": 0.003012488870059743, "ViewRequirementAgentConnector_ms": 0.0847627134884105}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.1776401838476, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.968478715212054, "mean_inference_ms": 0.38426551540438264, "mean_action_processing_ms": 0.09420145944794793, "mean_env_wait_ms": 25.624540912772293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005926805384018842, "StateBufferConnector_ms": 0.003012488870059743, "ViewRequirementAgentConnector_ms": 0.0847627134884105}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1217794, "num_agent_steps_trained": 1217794, "num_env_steps_sampled": 1217794, "num_env_steps_trained": 1217794, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.45654429720424, "num_env_steps_trained_throughput_per_sec": 21.45654429720424, "timesteps_total": 1217794, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1217794, "timers": {"training_iteration_time_ms": 5620.302, "sample_time_ms": 5616.499, "load_time_ms": 0.22, "load_throughput": 549313.545, "learn_time_ms": 2.84, "learn_throughput": 42611.441, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 1217794, "num_env_steps_trained": 1217794, "num_agent_steps_sampled": 1217794, "num_agent_steps_trained": 1217794}, "done": false, "episodes_total": 3886, "training_iteration": 772, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-41-50", "timestamp": 1691214110, "time_this_iter_s": 11.281179904937744, "time_total_s": 10430.561010599136, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 193.02805471420288, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 20.2625, "ram_util_percent": 66.04374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -319.5562744140625, "policy_loss": -3275244.0, "vf_loss": 11057354.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36.0, "diff_num_grad_updates_vs_sampler_policy": 35.0}}, "num_env_steps_sampled": 1218036, "num_env_steps_trained": 1218036, "num_agent_steps_sampled": 1218036, "num_agent_steps_trained": 1218036}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.3552568453856, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.981572304195083, "mean_inference_ms": 0.3842034897469472, "mean_action_processing_ms": 0.09418002304112817, "mean_env_wait_ms": 25.541389468802805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058982107374403216, "StateBufferConnector_ms": 0.0030126836564805773, "ViewRequirementAgentConnector_ms": 0.08474323484632704}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.3552568453856, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.981572304195083, "mean_inference_ms": 0.3842034897469472, "mean_action_processing_ms": 0.09418002304112817, "mean_env_wait_ms": 25.541389468802805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058982107374403216, "StateBufferConnector_ms": 0.0030126836564805773, "ViewRequirementAgentConnector_ms": 0.08474323484632704}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1218036, "num_agent_steps_trained": 1218036, "num_env_steps_sampled": 1218036, "num_env_steps_trained": 1218036, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.43770821195677, "num_env_steps_trained_throughput_per_sec": 21.43770821195677, "timesteps_total": 1218036, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1218036, "timers": {"training_iteration_time_ms": 5624.535, "sample_time_ms": 5620.753, "load_time_ms": 0.221, "load_throughput": 547417.521, "learn_time_ms": 2.817, "learn_throughput": 42956.603, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 1218036, "num_env_steps_trained": 1218036, "num_agent_steps_sampled": 1218036, "num_agent_steps_trained": 1218036}, "done": false, "episodes_total": 3888, "training_iteration": 773, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-42-02", "timestamp": 1691214122, "time_this_iter_s": 11.291135311126709, "time_total_s": 10441.852145910263, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 204.3191900253296, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 19.549999999999997, "ram_util_percent": 66.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -319.238037109375, "policy_loss": -8703101.0, "vf_loss": 11028364.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38.0, "diff_num_grad_updates_vs_sampler_policy": 37.0}}, "num_env_steps_sampled": 1218278, "num_env_steps_trained": 1218278, "num_agent_steps_sampled": 1218278, "num_agent_steps_trained": 1218278}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.569565709928, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.993574923851565, "mean_inference_ms": 0.3841437133174664, "mean_action_processing_ms": 0.09415908905383, "mean_env_wait_ms": 25.465076252365613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005895840494256271, "StateBufferConnector_ms": 0.003024778868022718, "ViewRequirementAgentConnector_ms": 0.0848111353422466}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.569565709928, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.993574923851565, "mean_inference_ms": 0.3841437133174664, "mean_action_processing_ms": 0.09415908905383, "mean_env_wait_ms": 25.465076252365613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005895840494256271, "StateBufferConnector_ms": 0.003024778868022718, "ViewRequirementAgentConnector_ms": 0.0848111353422466}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1218278, "num_agent_steps_trained": 1218278, "num_env_steps_sampled": 1218278, "num_env_steps_trained": 1218278, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.602808978038794, "num_env_steps_trained_throughput_per_sec": 21.602808978038794, "timesteps_total": 1218278, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1218278, "timers": {"training_iteration_time_ms": 5623.64, "sample_time_ms": 5619.857, "load_time_ms": 0.221, "load_throughput": 548186.2, "learn_time_ms": 2.816, "learn_throughput": 42973.335, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 1218278, "num_env_steps_trained": 1218278, "num_agent_steps_sampled": 1218278, "num_agent_steps_trained": 1218278}, "done": false, "episodes_total": 3890, "training_iteration": 774, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-42-13", "timestamp": 1691214133, "time_this_iter_s": 11.204926013946533, "time_total_s": 10453.05707192421, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 215.52411603927612, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 19.91875, "ram_util_percent": 66.1875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 241114.25, "vf_loss": 10935188.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}}, "num_env_steps_sampled": 1218520, "num_env_steps_trained": 1218520, "num_agent_steps_sampled": 1218520, "num_agent_steps_trained": 1218520}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.4413440227395, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.00396068330325, "mean_inference_ms": 0.38409059167797616, "mean_action_processing_ms": 0.09414002183183488, "mean_env_wait_ms": 25.395628983856003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005874037742614746, "StateBufferConnector_ms": 0.0030088424682617188, "ViewRequirementAgentConnector_ms": 0.0847172737121582}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.4413440227395, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.00396068330325, "mean_inference_ms": 0.38409059167797616, "mean_action_processing_ms": 0.09414002183183488, "mean_env_wait_ms": 25.395628983856003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005874037742614746, "StateBufferConnector_ms": 0.0030088424682617188, "ViewRequirementAgentConnector_ms": 0.0847172737121582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1218520, "num_agent_steps_trained": 1218520, "num_env_steps_sampled": 1218520, "num_env_steps_trained": 1218520, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.562039211487672, "num_env_steps_trained_throughput_per_sec": 21.562039211487672, "timesteps_total": 1218520, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1218520, "timers": {"training_iteration_time_ms": 5620.066, "sample_time_ms": 5616.28, "load_time_ms": 0.221, "load_throughput": 547890.299, "learn_time_ms": 2.815, "learn_throughput": 42988.623, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 1218520, "num_env_steps_trained": 1218520, "num_agent_steps_sampled": 1218520, "num_agent_steps_trained": 1218520}, "done": false, "episodes_total": 3892, "training_iteration": 775, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-42-24", "timestamp": 1691214144, "time_this_iter_s": 11.226072072982788, "time_total_s": 10464.283143997192, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 226.7501881122589, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 20.025, "ram_util_percent": 66.28125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -319.27947998046875, "policy_loss": -2954398.0, "vf_loss": 11134337.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}}, "num_env_steps_sampled": 1218762, "num_env_steps_trained": 1218762, "num_agent_steps_sampled": 1218762, "num_agent_steps_trained": 1218762}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.5330867908754, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.01305232512677, "mean_inference_ms": 0.38402805396915823, "mean_action_processing_ms": 0.0941199463279722, "mean_env_wait_ms": 25.332051528838377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005948543548583984, "StateBufferConnector_ms": 0.0030159950256347656, "ViewRequirementAgentConnector_ms": 0.08487701416015625}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.5330867908754, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.01305232512677, "mean_inference_ms": 0.38402805396915823, "mean_action_processing_ms": 0.0941199463279722, "mean_env_wait_ms": 25.332051528838377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005948543548583984, "StateBufferConnector_ms": 0.0030159950256347656, "ViewRequirementAgentConnector_ms": 0.08487701416015625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1218762, "num_agent_steps_trained": 1218762, "num_env_steps_sampled": 1218762, "num_env_steps_trained": 1218762, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.57279754812406, "num_env_steps_trained_throughput_per_sec": 21.57279754812406, "timesteps_total": 1218762, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1218762, "timers": {"training_iteration_time_ms": 5621.051, "sample_time_ms": 5617.284, "load_time_ms": 0.221, "load_throughput": 546650.995, "learn_time_ms": 2.797, "learn_throughput": 43257.201, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 1218762, "num_env_steps_trained": 1218762, "num_agent_steps_sampled": 1218762, "num_agent_steps_trained": 1218762}, "done": false, "episodes_total": 3894, "training_iteration": 776, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-42-35", "timestamp": 1691214155, "time_this_iter_s": 11.220301151275635, "time_total_s": 10475.503445148468, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 237.97048926353455, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 19.975, "ram_util_percent": 66.2125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 240820.140625, "vf_loss": 10909448.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}}, "num_env_steps_sampled": 1219004, "num_env_steps_trained": 1219004, "num_agent_steps_sampled": 1219004, "num_agent_steps_trained": 1219004}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.381057191561, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.021782505342916, "mean_inference_ms": 0.383972019201872, "mean_action_processing_ms": 0.0941027760615366, "mean_env_wait_ms": 25.2735757183508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005928494713523171, "StateBufferConnector_ms": 0.0029943206093528056, "ViewRequirementAgentConnector_ms": 0.08494041182778099}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.381057191561, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.021782505342916, "mean_inference_ms": 0.383972019201872, "mean_action_processing_ms": 0.0941027760615366, "mean_env_wait_ms": 25.2735757183508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005928494713523171, "StateBufferConnector_ms": 0.0029943206093528056, "ViewRequirementAgentConnector_ms": 0.08494041182778099}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1219004, "num_agent_steps_trained": 1219004, "num_env_steps_sampled": 1219004, "num_env_steps_trained": 1219004, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.412730642116173, "num_env_steps_trained_throughput_per_sec": 21.412730642116173, "timesteps_total": 1219004, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1219004, "timers": {"training_iteration_time_ms": 5623.359, "sample_time_ms": 5619.588, "load_time_ms": 0.221, "load_throughput": 546886.621, "learn_time_ms": 2.792, "learn_throughput": 43331.437, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 1219004, "num_env_steps_trained": 1219004, "num_agent_steps_sampled": 1219004, "num_agent_steps_trained": 1219004}, "done": false, "episodes_total": 3896, "training_iteration": 777, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-42-47", "timestamp": 1691214167, "time_this_iter_s": 11.304196834564209, "time_total_s": 10486.807641983032, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 249.27468609809875, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.88125, "ram_util_percent": 66.24375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 240820.140625, "vf_loss": 10909448.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}}, "num_env_steps_sampled": 1219246, "num_env_steps_trained": 1219246, "num_agent_steps_sampled": 1219246, "num_agent_steps_trained": 1219246}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.2090922942941, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.030794560698062, "mean_inference_ms": 0.38391777444878494, "mean_action_processing_ms": 0.0940858878684894, "mean_env_wait_ms": 25.21887777020984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005917445473048998, "StateBufferConnector_ms": 0.0030087388080099354, "ViewRequirementAgentConnector_ms": 0.0850299130315366}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1056013549978, "episode_reward_mean": -1191.2090922942941, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.030794560698062, "mean_inference_ms": 0.38391777444878494, "mean_action_processing_ms": 0.0940858878684894, "mean_env_wait_ms": 25.21887777020984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005917445473048998, "StateBufferConnector_ms": 0.0030087388080099354, "ViewRequirementAgentConnector_ms": 0.0850299130315366}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1219246, "num_agent_steps_trained": 1219246, "num_env_steps_sampled": 1219246, "num_env_steps_trained": 1219246, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.43429438725258, "num_env_steps_trained_throughput_per_sec": 21.43429438725258, "timesteps_total": 1219246, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1219246, "timers": {"training_iteration_time_ms": 5623.538, "sample_time_ms": 5619.775, "load_time_ms": 0.221, "load_throughput": 548482.421, "learn_time_ms": 2.787, "learn_throughput": 43421.153, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 1219246, "num_env_steps_trained": 1219246, "num_agent_steps_sampled": 1219246, "num_agent_steps_trained": 1219246}, "done": false, "episodes_total": 3898, "training_iteration": 778, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-42-58", "timestamp": 1691214178, "time_this_iter_s": 11.292841911315918, "time_total_s": 10498.100483894348, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 260.5675280094147, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 19.1, "ram_util_percent": 66.25625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -320.2133483886719, "policy_loss": -12452979.0, "vf_loss": 11209626.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}}, "num_env_steps_sampled": 1219488, "num_env_steps_trained": 1219488, "num_agent_steps_sampled": 1219488, "num_agent_steps_trained": 1219488}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1107159528042, "episode_reward_mean": -1191.3687141456523, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.039414879126607, "mean_inference_ms": 0.3838712385994072, "mean_action_processing_ms": 0.0940701862751655, "mean_env_wait_ms": 25.168074952904515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005905330181121826, "StateBufferConnector_ms": 0.00299761692682902, "ViewRequirementAgentConnector_ms": 0.08505582809448242}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1107159528042, "episode_reward_mean": -1191.3687141456523, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.039414879126607, "mean_inference_ms": 0.3838712385994072, "mean_action_processing_ms": 0.0940701862751655, "mean_env_wait_ms": 25.168074952904515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005905330181121826, "StateBufferConnector_ms": 0.00299761692682902, "ViewRequirementAgentConnector_ms": 0.08505582809448242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1219488, "num_agent_steps_trained": 1219488, "num_env_steps_sampled": 1219488, "num_env_steps_trained": 1219488, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.450247419648182, "num_env_steps_trained_throughput_per_sec": 21.450247419648182, "timesteps_total": 1219488, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1219488, "timers": {"training_iteration_time_ms": 5631.506, "sample_time_ms": 5627.738, "load_time_ms": 0.224, "load_throughput": 539618.058, "learn_time_ms": 2.785, "learn_throughput": 43447.546, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 1219488, "num_env_steps_trained": 1219488, "num_agent_steps_sampled": 1219488, "num_agent_steps_trained": 1219488}, "done": false, "episodes_total": 3900, "training_iteration": 779, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-43-09", "timestamp": 1691214189, "time_this_iter_s": 11.284838914871216, "time_total_s": 10509.38532280922, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 271.8523669242859, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 19.441176470588236, "ram_util_percent": 66.19411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 240820.140625, "vf_loss": 10909448.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}}, "num_env_steps_sampled": 1219730, "num_env_steps_trained": 1219730, "num_agent_steps_sampled": 1219730, "num_agent_steps_trained": 1219730}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1107159528042, "episode_reward_mean": -1191.2410112264035, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.047632679810526, "mean_inference_ms": 0.38382187206764534, "mean_action_processing_ms": 0.09405358364482869, "mean_env_wait_ms": 25.12052155821082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005894184112548828, "StateBufferConnector_ms": 0.0029888153076171875, "ViewRequirementAgentConnector_ms": 0.08504819869995117}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1107159528042, "episode_reward_mean": -1191.2410112264035, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.047632679810526, "mean_inference_ms": 0.38382187206764534, "mean_action_processing_ms": 0.09405358364482869, "mean_env_wait_ms": 25.12052155821082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005894184112548828, "StateBufferConnector_ms": 0.0029888153076171875, "ViewRequirementAgentConnector_ms": 0.08504819869995117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1219730, "num_agent_steps_trained": 1219730, "num_env_steps_sampled": 1219730, "num_env_steps_trained": 1219730, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.52742802224086, "num_env_steps_trained_throughput_per_sec": 21.52742802224086, "timesteps_total": 1219730, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1219730, "timers": {"training_iteration_time_ms": 5633.31, "sample_time_ms": 5629.567, "load_time_ms": 0.224, "load_throughput": 541171.661, "learn_time_ms": 2.772, "learn_throughput": 43653.087, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 1219730, "num_env_steps_trained": 1219730, "num_agent_steps_sampled": 1219730, "num_agent_steps_trained": 1219730}, "done": false, "episodes_total": 3902, "training_iteration": 780, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-43-21", "timestamp": 1691214201, "time_this_iter_s": 11.244141101837158, "time_total_s": 10520.629463911057, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 283.09650802612305, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 19.23125, "ram_util_percent": 66.20625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 242872.6875, "vf_loss": 11089775.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}}, "num_env_steps_sampled": 1219972, "num_env_steps_trained": 1219972, "num_agent_steps_sampled": 1219972, "num_agent_steps_trained": 1219972}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1107159528042, "episode_reward_mean": -1191.2688669469992, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.054997816565905, "mean_inference_ms": 0.3837744190146353, "mean_action_processing_ms": 0.09403841410434068, "mean_env_wait_ms": 25.07598092777338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058884804065410905, "StateBufferConnector_ms": 0.0029880266923170825, "ViewRequirementAgentConnector_ms": 0.08503015224750225}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1107159528042, "episode_reward_mean": -1191.2688669469992, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.054997816565905, "mean_inference_ms": 0.3837744190146353, "mean_action_processing_ms": 0.09403841410434068, "mean_env_wait_ms": 25.07598092777338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058884804065410905, "StateBufferConnector_ms": 0.0029880266923170825, "ViewRequirementAgentConnector_ms": 0.08503015224750225}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1219972, "num_agent_steps_trained": 1219972, "num_env_steps_sampled": 1219972, "num_env_steps_trained": 1219972, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.65182296156258, "num_env_steps_trained_throughput_per_sec": 21.65182296156258, "timesteps_total": 1219972, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1219972, "timers": {"training_iteration_time_ms": 5629.215, "sample_time_ms": 5625.465, "load_time_ms": 0.223, "load_throughput": 541922.887, "learn_time_ms": 2.773, "learn_throughput": 43638.823, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 1219972, "num_env_steps_trained": 1219972, "num_agent_steps_sampled": 1219972, "num_agent_steps_trained": 1219972}, "done": false, "episodes_total": 3904, "training_iteration": 781, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-43-32", "timestamp": 1691214212, "time_this_iter_s": 11.179523944854736, "time_total_s": 10531.808987855911, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 294.2760319709778, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 20.326666666666668, "ram_util_percent": 66.15333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 240820.140625, "vf_loss": 10909448.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 53.0}}, "num_env_steps_sampled": 1220214, "num_env_steps_trained": 1220214, "num_agent_steps_sampled": 1220214, "num_agent_steps_trained": 1220214}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1107159528042, "episode_reward_mean": -1191.152210372435, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.061462995592116, "mean_inference_ms": 0.38372468127997333, "mean_action_processing_ms": 0.09402346414509516, "mean_env_wait_ms": 25.033818697811654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00587745949074074, "StateBufferConnector_ms": 0.0029890625565140334, "ViewRequirementAgentConnector_ms": 0.08509644755610714}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1107159528042, "episode_reward_mean": -1191.152210372435, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.061462995592116, "mean_inference_ms": 0.38372468127997333, "mean_action_processing_ms": 0.09402346414509516, "mean_env_wait_ms": 25.033818697811654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00587745949074074, "StateBufferConnector_ms": 0.0029890625565140334, "ViewRequirementAgentConnector_ms": 0.08509644755610714}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1220214, "num_agent_steps_trained": 1220214, "num_env_steps_sampled": 1220214, "num_env_steps_trained": 1220214, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.82805279154003, "num_env_steps_trained_throughput_per_sec": 21.82805279154003, "timesteps_total": 1220214, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1220214, "timers": {"training_iteration_time_ms": 5607.712, "sample_time_ms": 5603.978, "load_time_ms": 0.223, "load_throughput": 542676.202, "learn_time_ms": 2.762, "learn_throughput": 43809.468, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 1220214, "num_env_steps_trained": 1220214, "num_agent_steps_sampled": 1220214, "num_agent_steps_trained": 1220214}, "done": false, "episodes_total": 3906, "training_iteration": 782, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-43-43", "timestamp": 1691214223, "time_this_iter_s": 11.089230060577393, "time_total_s": 10542.898217916489, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 305.3652620315552, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 20.0, "ram_util_percent": 66.2125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -319.2794189453125, "policy_loss": -9975887.0, "vf_loss": 10945213.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}}, "num_env_steps_sampled": 1220456, "num_env_steps_trained": 1220456, "num_agent_steps_sampled": 1220456, "num_agent_steps_trained": 1220456}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1107159528042, "episode_reward_mean": -1191.2031237255007, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.067022022588613, "mean_inference_ms": 0.38368547553260346, "mean_action_processing_ms": 0.09401065089275373, "mean_env_wait_ms": 24.99405468909874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005925127438136509, "StateBufferConnector_ms": 0.0029900244304112028, "ViewRequirementAgentConnector_ms": 0.08507924420492989}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1107159528042, "episode_reward_mean": -1191.2031237255007, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.067022022588613, "mean_inference_ms": 0.38368547553260346, "mean_action_processing_ms": 0.09401065089275373, "mean_env_wait_ms": 24.99405468909874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005925127438136509, "StateBufferConnector_ms": 0.0029900244304112028, "ViewRequirementAgentConnector_ms": 0.08507924420492989}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1220456, "num_agent_steps_trained": 1220456, "num_env_steps_sampled": 1220456, "num_env_steps_trained": 1220456, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.78971525397284, "num_env_steps_trained_throughput_per_sec": 21.78971525397284, "timesteps_total": 1220456, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1220456, "timers": {"training_iteration_time_ms": 5589.295, "sample_time_ms": 5585.512, "load_time_ms": 0.224, "load_throughput": 539274.024, "learn_time_ms": 2.798, "learn_throughput": 43247.617, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 1220456, "num_env_steps_trained": 1220456, "num_agent_steps_sampled": 1220456, "num_agent_steps_trained": 1220456}, "done": false, "episodes_total": 3908, "training_iteration": 783, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-43-54", "timestamp": 1691214234, "time_this_iter_s": 11.108735084533691, "time_total_s": 10554.006953001022, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 316.47399711608887, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 21.65, "ram_util_percent": 66.15625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 240820.140625, "vf_loss": 10909448.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}}, "num_env_steps_sampled": 1220698, "num_env_steps_trained": 1220698, "num_agent_steps_sampled": 1220698, "num_agent_steps_trained": 1220698}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1107159528042, "episode_reward_mean": -1191.0628651180941, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.07211574246806, "mean_inference_ms": 0.38363968574429197, "mean_action_processing_ms": 0.09399742622958636, "mean_env_wait_ms": 24.95600197006653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005915247160812904, "StateBufferConnector_ms": 0.002984753970442147, "ViewRequirementAgentConnector_ms": 0.08500280051395812}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1107159528042, "episode_reward_mean": -1191.0628651180941, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.07211574246806, "mean_inference_ms": 0.38363968574429197, "mean_action_processing_ms": 0.09399742622958636, "mean_env_wait_ms": 24.95600197006653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005915247160812904, "StateBufferConnector_ms": 0.002984753970442147, "ViewRequirementAgentConnector_ms": 0.08500280051395812}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1220698, "num_agent_steps_trained": 1220698, "num_env_steps_sampled": 1220698, "num_env_steps_trained": 1220698, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.862672808102, "num_env_steps_trained_throughput_per_sec": 21.862672808102, "timesteps_total": 1220698, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1220698, "timers": {"training_iteration_time_ms": 5568.012, "sample_time_ms": 5564.235, "load_time_ms": 0.222, "load_throughput": 545769.205, "learn_time_ms": 2.793, "learn_throughput": 43326.258, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 1220698, "num_env_steps_trained": 1220698, "num_agent_steps_sampled": 1220698, "num_agent_steps_trained": 1220698}, "done": false, "episodes_total": 3910, "training_iteration": 784, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-44-05", "timestamp": 1691214245, "time_this_iter_s": 11.07190990447998, "time_total_s": 10565.078862905502, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 327.54590702056885, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 21.0625, "ram_util_percent": 66.18125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -319.2435607910156, "policy_loss": -3320005.75, "vf_loss": 11105536.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}}, "num_env_steps_sampled": 1220940, "num_env_steps_trained": 1220940, "num_agent_steps_sampled": 1220940, "num_agent_steps_trained": 1220940}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1107159528042, "episode_reward_mean": -1191.1649430204088, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.077152688684862, "mean_inference_ms": 0.38359924908356846, "mean_action_processing_ms": 0.0939853748314282, "mean_env_wait_ms": 24.919779441760753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005906820297241211, "StateBufferConnector_ms": 0.0029810269673665366, "ViewRequirementAgentConnector_ms": 0.08493224779764812}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1107159528042, "episode_reward_mean": -1191.1649430204088, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.077152688684862, "mean_inference_ms": 0.38359924908356846, "mean_action_processing_ms": 0.0939853748314282, "mean_env_wait_ms": 24.919779441760753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005906820297241211, "StateBufferConnector_ms": 0.0029810269673665366, "ViewRequirementAgentConnector_ms": 0.08493224779764812}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1220940, "num_agent_steps_trained": 1220940, "num_env_steps_sampled": 1220940, "num_env_steps_trained": 1220940, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.610587489541178, "num_env_steps_trained_throughput_per_sec": 21.610587489541178, "timesteps_total": 1220940, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1220940, "timers": {"training_iteration_time_ms": 5563.687, "sample_time_ms": 5559.909, "load_time_ms": 0.222, "load_throughput": 546121.58, "learn_time_ms": 2.793, "learn_throughput": 43325.148, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 1220940, "num_env_steps_trained": 1220940, "num_agent_steps_sampled": 1220940, "num_agent_steps_trained": 1220940}, "done": false, "episodes_total": 3912, "training_iteration": 785, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-44-16", "timestamp": 1691214256, "time_this_iter_s": 11.200798988342285, "time_total_s": 10576.279661893845, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 338.74670600891113, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 20.818749999999998, "ram_util_percent": 66.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 241934.515625, "vf_loss": 11007148.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}}, "num_env_steps_sampled": 1221182, "num_env_steps_trained": 1221182, "num_agent_steps_sampled": 1221182, "num_agent_steps_trained": 1221182}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1107159528042, "episode_reward_mean": -1191.2548485505313, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.08217213345158, "mean_inference_ms": 0.3835577216090802, "mean_action_processing_ms": 0.09397332247957524, "mean_env_wait_ms": 24.885261423041776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005891246180380544, "StateBufferConnector_ms": 0.0029775404161022554, "ViewRequirementAgentConnector_ms": 0.08487009233044039}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1107159528042, "episode_reward_mean": -1191.2548485505313, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.08217213345158, "mean_inference_ms": 0.3835577216090802, "mean_action_processing_ms": 0.09397332247957524, "mean_env_wait_ms": 24.885261423041776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005891246180380544, "StateBufferConnector_ms": 0.0029775404161022554, "ViewRequirementAgentConnector_ms": 0.08487009233044039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1221182, "num_agent_steps_trained": 1221182, "num_env_steps_sampled": 1221182, "num_env_steps_trained": 1221182, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.58635835791999, "num_env_steps_trained_throughput_per_sec": 21.58635835791999, "timesteps_total": 1221182, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1221182, "timers": {"training_iteration_time_ms": 5567.077, "sample_time_ms": 5563.299, "load_time_ms": 0.222, "load_throughput": 545007.285, "learn_time_ms": 2.795, "learn_throughput": 43286.348, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 1221182, "num_env_steps_trained": 1221182, "num_agent_steps_sampled": 1221182, "num_agent_steps_trained": 1221182}, "done": false, "episodes_total": 3914, "training_iteration": 786, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-44-28", "timestamp": 1691214268, "time_this_iter_s": 11.213364839553833, "time_total_s": 10587.493026733398, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 349.96007084846497, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 20.459999999999997, "ram_util_percent": 66.24}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -319.264404296875, "policy_loss": -5423525.0, "vf_loss": 10934931.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 64.0, "diff_num_grad_updates_vs_sampler_policy": 63.0}}, "num_env_steps_sampled": 1221424, "num_env_steps_trained": 1221424, "num_agent_steps_sampled": 1221424, "num_agent_steps_trained": 1221424}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1107159528042, "episode_reward_mean": -1191.1593092529424, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.08644651102795, "mean_inference_ms": 0.3835200432410196, "mean_action_processing_ms": 0.09396247943179008, "mean_env_wait_ms": 24.852340655496814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005935877561569214, "StateBufferConnector_ms": 0.002971664071083069, "ViewRequirementAgentConnector_ms": 0.08485205471515656}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1201.1107159528042, "episode_reward_mean": -1191.1593092529424, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.08644651102795, "mean_inference_ms": 0.3835200432410196, "mean_action_processing_ms": 0.09396247943179008, "mean_env_wait_ms": 24.852340655496814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005935877561569214, "StateBufferConnector_ms": 0.002971664071083069, "ViewRequirementAgentConnector_ms": 0.08485205471515656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1221424, "num_agent_steps_trained": 1221424, "num_env_steps_sampled": 1221424, "num_env_steps_trained": 1221424, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.921918033336027, "num_env_steps_trained_throughput_per_sec": 21.921918033336027, "timesteps_total": 1221424, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1221424, "timers": {"training_iteration_time_ms": 5562.33, "sample_time_ms": 5558.54, "load_time_ms": 0.222, "load_throughput": 544130.786, "learn_time_ms": 2.805, "learn_throughput": 43138.438, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 1221424, "num_env_steps_trained": 1221424, "num_agent_steps_sampled": 1221424, "num_agent_steps_trained": 1221424}, "done": false, "episodes_total": 3916, "training_iteration": 787, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-44-39", "timestamp": 1691214279, "time_this_iter_s": 11.041843175888062, "time_total_s": 10598.534869909286, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 361.001914024353, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 21.3125, "ram_util_percent": 66.2375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -319.8232116699219, "policy_loss": -18109534.0, "vf_loss": 11315314.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}}, "num_env_steps_sampled": 1221666, "num_env_steps_trained": 1221666, "num_agent_steps_sampled": 1221666, "num_agent_steps_trained": 1221666}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1191.3132060282542, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.090108026449577, "mean_inference_ms": 0.3834842915205816, "mean_action_processing_ms": 0.09395180166959416, "mean_env_wait_ms": 24.82121521132326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005930120294744318, "StateBufferConnector_ms": 0.002966505108457623, "ViewRequirementAgentConnector_ms": 0.08477044828010327}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1191.3132060282542, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.090108026449577, "mean_inference_ms": 0.3834842915205816, "mean_action_processing_ms": 0.09395180166959416, "mean_env_wait_ms": 24.82121521132326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005930120294744318, "StateBufferConnector_ms": 0.002966505108457623, "ViewRequirementAgentConnector_ms": 0.08477044828010327}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1221666, "num_agent_steps_trained": 1221666, "num_env_steps_sampled": 1221666, "num_env_steps_trained": 1221666, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.74181777997795, "num_env_steps_trained_throughput_per_sec": 21.74181777997795, "timesteps_total": 1221666, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1221666, "timers": {"training_iteration_time_ms": 5564.776, "sample_time_ms": 5561.034, "load_time_ms": 0.221, "load_throughput": 546533.259, "learn_time_ms": 2.773, "learn_throughput": 43630.194, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 1221666, "num_env_steps_trained": 1221666, "num_agent_steps_sampled": 1221666, "num_agent_steps_trained": 1221666}, "done": false, "episodes_total": 3918, "training_iteration": 788, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-44-50", "timestamp": 1691214290, "time_this_iter_s": 11.133239030838013, "time_total_s": 10609.668108940125, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 372.13515305519104, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 20.700000000000003, "ram_util_percent": 66.11250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 241842.5625, "vf_loss": 10999068.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}}, "num_env_steps_sampled": 1221908, "num_env_steps_trained": 1221908, "num_agent_steps_sampled": 1221908, "num_agent_steps_trained": 1221908}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1191.2866327388695, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.093583566488412, "mean_inference_ms": 0.38345018388822505, "mean_action_processing_ms": 0.09394149356877896, "mean_env_wait_ms": 24.79207254012172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005977644639856675, "StateBufferConnector_ms": 0.0029704150031594667, "ViewRequirementAgentConnector_ms": 0.08487280677346622}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1191.2866327388695, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.093583566488412, "mean_inference_ms": 0.38345018388822505, "mean_action_processing_ms": 0.09394149356877896, "mean_env_wait_ms": 24.79207254012172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005977644639856675, "StateBufferConnector_ms": 0.0029704150031594667, "ViewRequirementAgentConnector_ms": 0.08487280677346622}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1221908, "num_agent_steps_trained": 1221908, "num_env_steps_sampled": 1221908, "num_env_steps_trained": 1221908, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.37257144577741, "num_env_steps_trained_throughput_per_sec": 21.37257144577741, "timesteps_total": 1221908, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1221908, "timers": {"training_iteration_time_ms": 5590.159, "sample_time_ms": 5586.395, "load_time_ms": 0.221, "load_throughput": 547831.157, "learn_time_ms": 2.788, "learn_throughput": 43402.958, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 1221908, "num_env_steps_trained": 1221908, "num_agent_steps_sampled": 1221908, "num_agent_steps_trained": 1221908}, "done": false, "episodes_total": 3920, "training_iteration": 789, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-45-01", "timestamp": 1691214301, "time_this_iter_s": 11.325665712356567, "time_total_s": 10620.993774652481, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 383.4608187675476, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 19.475, "ram_util_percent": 66.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 242037.84375, "vf_loss": 11016232.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 69.0}}, "num_env_steps_sampled": 1222150, "num_env_steps_trained": 1222150, "num_agent_steps_sampled": 1222150, "num_agent_steps_trained": 1222150}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1191.2388023100889, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836, -1187.2657633076515, -1191.9593721554538], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.0965754485289, "mean_inference_ms": 0.3834127349599558, "mean_action_processing_ms": 0.09393073042140998, "mean_env_wait_ms": 24.76413663951278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059659140450613836, "StateBufferConnector_ms": 0.0029679707118443082, "ViewRequirementAgentConnector_ms": 0.08480651038033622}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1191.2388023100889, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836, -1187.2657633076515, -1191.9593721554538], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.0965754485289, "mean_inference_ms": 0.3834127349599558, "mean_action_processing_ms": 0.09393073042140998, "mean_env_wait_ms": 24.76413663951278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059659140450613836, "StateBufferConnector_ms": 0.0029679707118443082, "ViewRequirementAgentConnector_ms": 0.08480651038033622}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1222150, "num_agent_steps_trained": 1222150, "num_env_steps_sampled": 1222150, "num_env_steps_trained": 1222150, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.89734140427018, "num_env_steps_trained_throughput_per_sec": 21.89734140427018, "timesteps_total": 1222150, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1222150, "timers": {"training_iteration_time_ms": 5575.495, "sample_time_ms": 5571.727, "load_time_ms": 0.221, "load_throughput": 547004.51, "learn_time_ms": 2.789, "learn_throughput": 43384.035, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 1222150, "num_env_steps_trained": 1222150, "num_agent_steps_sampled": 1222150, "num_agent_steps_trained": 1222150}, "done": false, "episodes_total": 3922, "training_iteration": 790, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-45-12", "timestamp": 1691214312, "time_this_iter_s": 11.054198026657104, "time_total_s": 10632.047972679138, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 394.5150167942047, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 21.85, "ram_util_percent": 66.06875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -319.2220458984375, "policy_loss": -6983846.5, "vf_loss": 10969697.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 72.0, "diff_num_grad_updates_vs_sampler_policy": 71.0}}, "num_env_steps_sampled": 1222392, "num_env_steps_trained": 1222392, "num_agent_steps_sampled": 1222392, "num_agent_steps_trained": 1222392}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1191.1698877540261, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836, -1187.2657633076515, -1191.9593721554538, -1187.4258645544264, -1190.089892029218], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.099127135338836, "mean_inference_ms": 0.38337182327715, "mean_action_processing_ms": 0.09391936254319744, "mean_env_wait_ms": 24.737110092602176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005954172876146104, "StateBufferConnector_ms": 0.0029676490359836155, "ViewRequirementAgentConnector_ms": 0.08479191197289361}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1191.1698877540261, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836, -1187.2657633076515, -1191.9593721554538, -1187.4258645544264, -1190.089892029218], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.099127135338836, "mean_inference_ms": 0.38337182327715, "mean_action_processing_ms": 0.09391936254319744, "mean_env_wait_ms": 24.737110092602176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005954172876146104, "StateBufferConnector_ms": 0.0029676490359836155, "ViewRequirementAgentConnector_ms": 0.08479191197289361}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1222392, "num_agent_steps_trained": 1222392, "num_env_steps_sampled": 1222392, "num_env_steps_trained": 1222392, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 22.04490318876984, "num_env_steps_trained_throughput_per_sec": 22.04490318876984, "timesteps_total": 1222392, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1222392, "timers": {"training_iteration_time_ms": 5552.176, "sample_time_ms": 5548.418, "load_time_ms": 0.22, "load_throughput": 549551.472, "learn_time_ms": 2.773, "learn_throughput": 43630.569, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 1222392, "num_env_steps_trained": 1222392, "num_agent_steps_sampled": 1222392, "num_agent_steps_trained": 1222392}, "done": false, "episodes_total": 3924, "training_iteration": 791, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-45-23", "timestamp": 1691214323, "time_this_iter_s": 10.98031210899353, "time_total_s": 10643.028284788132, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 405.49532890319824, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 21.013333333333335, "ram_util_percent": 66.14}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 241920.59375, "vf_loss": 11005927.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 74.0, "diff_num_grad_updates_vs_sampler_policy": 73.0}}, "num_env_steps_sampled": 1222634, "num_env_steps_trained": 1222634, "num_agent_steps_sampled": 1222634, "num_agent_steps_trained": 1222634}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1191.190306080331, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836, -1187.2657633076515, -1191.9593721554538, -1187.4258645544264, -1190.089892029218, -1191.9253658273083, -1191.9253658273083], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.10156983617936, "mean_inference_ms": 0.38333267960136125, "mean_action_processing_ms": 0.09390877944816457, "mean_env_wait_ms": 24.71098347319591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005982373211834882, "StateBufferConnector_ms": 0.0029689556843525656, "ViewRequirementAgentConnector_ms": 0.08479614515562316}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1191.190306080331, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836, -1187.2657633076515, -1191.9593721554538, -1187.4258645544264, -1190.089892029218, -1191.9253658273083, -1191.9253658273083], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.10156983617936, "mean_inference_ms": 0.38333267960136125, "mean_action_processing_ms": 0.09390877944816457, "mean_env_wait_ms": 24.71098347319591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005982373211834882, "StateBufferConnector_ms": 0.0029689556843525656, "ViewRequirementAgentConnector_ms": 0.08479614515562316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1222634, "num_agent_steps_trained": 1222634, "num_env_steps_sampled": 1222634, "num_env_steps_trained": 1222634, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.834812078004166, "num_env_steps_trained_throughput_per_sec": 21.834812078004166, "timesteps_total": 1222634, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1222634, "timers": {"training_iteration_time_ms": 5556.58, "sample_time_ms": 5552.831, "load_time_ms": 0.219, "load_throughput": 551402.416, "learn_time_ms": 2.766, "learn_throughput": 43738.11, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 1222634, "num_env_steps_trained": 1222634, "num_agent_steps_sampled": 1222634, "num_agent_steps_trained": 1222634}, "done": false, "episodes_total": 3926, "training_iteration": 792, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-45-34", "timestamp": 1691214334, "time_this_iter_s": 11.08583402633667, "time_total_s": 10654.114118814468, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 416.5811629295349, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 20.01875, "ram_util_percent": 66.17500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -319.27593994140625, "policy_loss": -9522330.0, "vf_loss": 10927464.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 76.0, "diff_num_grad_updates_vs_sampler_policy": 75.0}}, "num_env_steps_sampled": 1222876, "num_env_steps_trained": 1222876, "num_agent_steps_sampled": 1222876, "num_agent_steps_trained": 1222876}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1191.1110567971787, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836, -1187.2657633076515, -1191.9593721554538, -1187.4258645544264, -1190.089892029218, -1191.9253658273083, -1191.9253658273083, -1187.4258645544264, -1188.9318020866551], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.10385923851559, "mean_inference_ms": 0.38329750654764877, "mean_action_processing_ms": 0.09389900050334943, "mean_env_wait_ms": 24.685891091695538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059733265324642786, "StateBufferConnector_ms": 0.0029651742232473274, "ViewRequirementAgentConnector_ms": 0.08478948944493343}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1191.1110567971787, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836, -1187.2657633076515, -1191.9593721554538, -1187.4258645544264, -1190.089892029218, -1191.9253658273083, -1191.9253658273083, -1187.4258645544264, -1188.9318020866551], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.10385923851559, "mean_inference_ms": 0.38329750654764877, "mean_action_processing_ms": 0.09389900050334943, "mean_env_wait_ms": 24.685891091695538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059733265324642786, "StateBufferConnector_ms": 0.0029651742232473274, "ViewRequirementAgentConnector_ms": 0.08478948944493343}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1222876, "num_agent_steps_trained": 1222876, "num_env_steps_sampled": 1222876, "num_env_steps_trained": 1222876, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.74761137025809, "num_env_steps_trained_throughput_per_sec": 21.74761137025809, "timesteps_total": 1222876, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1222876, "timers": {"training_iteration_time_ms": 5556.283, "sample_time_ms": 5552.527, "load_time_ms": 0.219, "load_throughput": 552242.42, "learn_time_ms": 2.773, "learn_throughput": 43640.324, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 1222876, "num_env_steps_trained": 1222876, "num_agent_steps_sampled": 1222876, "num_agent_steps_trained": 1222876}, "done": false, "episodes_total": 3928, "training_iteration": 793, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-45-45", "timestamp": 1691214345, "time_this_iter_s": 11.130328178405762, "time_total_s": 10665.244446992874, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 427.7114911079407, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 20.375, "ram_util_percent": 66.14375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 240862.25, "vf_loss": 10913132.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 78.0, "diff_num_grad_updates_vs_sampler_policy": 77.0}}, "num_env_steps_sampled": 1223118, "num_env_steps_trained": 1223118, "num_agent_steps_sampled": 1223118, "num_agent_steps_trained": 1223118}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1191.019656858942, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836, -1187.2657633076515, -1191.9593721554538, -1187.4258645544264, -1190.089892029218, -1191.9253658273083, -1191.9253658273083, -1187.4258645544264, -1188.9318020866551, -1187.4258645544264, -1187.6670538574751], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.105827090609562, "mean_inference_ms": 0.38326128992707115, "mean_action_processing_ms": 0.0938890376498484, "mean_env_wait_ms": 24.661676192764055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00596321546114408, "StateBufferConnector_ms": 0.002961281018379407, "ViewRequirementAgentConnector_ms": 0.08481740951538086}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1191.019656858942, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836, -1187.2657633076515, -1191.9593721554538, -1187.4258645544264, -1190.089892029218, -1191.9253658273083, -1191.9253658273083, -1187.4258645544264, -1188.9318020866551, -1187.4258645544264, -1187.6670538574751], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.105827090609562, "mean_inference_ms": 0.38326128992707115, "mean_action_processing_ms": 0.0938890376498484, "mean_env_wait_ms": 24.661676192764055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00596321546114408, "StateBufferConnector_ms": 0.002961281018379407, "ViewRequirementAgentConnector_ms": 0.08481740951538086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1223118, "num_agent_steps_trained": 1223118, "num_env_steps_sampled": 1223118, "num_env_steps_trained": 1223118, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.951730058023138, "num_env_steps_trained_throughput_per_sec": 21.951730058023138, "timesteps_total": 1223118, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1223118, "timers": {"training_iteration_time_ms": 5526.41, "sample_time_ms": 5522.667, "load_time_ms": 0.219, "load_throughput": 552062.204, "learn_time_ms": 2.755, "learn_throughput": 43918.273, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 1223118, "num_env_steps_trained": 1223118, "num_agent_steps_sampled": 1223118, "num_agent_steps_trained": 1223118}, "done": false, "episodes_total": 3930, "training_iteration": 794, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-45-57", "timestamp": 1691214357, "time_this_iter_s": 11.026905059814453, "time_total_s": 10676.271352052689, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 438.7383961677551, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 22.44666666666667, "ram_util_percent": 66.26}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -319.5242919921875, "policy_loss": -5786908.5, "vf_loss": 11168484.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 80.0, "diff_num_grad_updates_vs_sampler_policy": 79.0}}, "num_env_steps_sampled": 1223360, "num_env_steps_trained": 1223360, "num_agent_steps_sampled": 1223360, "num_agent_steps_trained": 1223360}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1191.0727036374678, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836, -1187.2657633076515, -1191.9593721554538, -1187.4258645544264, -1190.089892029218, -1191.9253658273083, -1191.9253658273083, -1187.4258645544264, -1188.9318020866551, -1187.4258645544264, -1187.6670538574751, -1188.6425943692086, -1197.6404616307384], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.10746002048179, "mean_inference_ms": 0.38322723657470925, "mean_action_processing_ms": 0.09387965721252285, "mean_env_wait_ms": 24.638666339525503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005951821804046631, "StateBufferConnector_ms": 0.002957284450531006, "ViewRequirementAgentConnector_ms": 0.08481353521347046}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1191.0727036374678, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836, -1187.2657633076515, -1191.9593721554538, -1187.4258645544264, -1190.089892029218, -1191.9253658273083, -1191.9253658273083, -1187.4258645544264, -1188.9318020866551, -1187.4258645544264, -1187.6670538574751, -1188.6425943692086, -1197.6404616307384], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.10746002048179, "mean_inference_ms": 0.38322723657470925, "mean_action_processing_ms": 0.09387965721252285, "mean_env_wait_ms": 24.638666339525503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005951821804046631, "StateBufferConnector_ms": 0.002957284450531006, "ViewRequirementAgentConnector_ms": 0.08481353521347046}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1223360, "num_agent_steps_trained": 1223360, "num_env_steps_sampled": 1223360, "num_env_steps_trained": 1223360, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.70010599047238, "num_env_steps_trained_throughput_per_sec": 21.70010599047238, "timesteps_total": 1223360, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1223360, "timers": {"training_iteration_time_ms": 5536.455, "sample_time_ms": 5532.715, "load_time_ms": 0.219, "load_throughput": 553024.718, "learn_time_ms": 2.755, "learn_throughput": 43924.735, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 1223360, "num_env_steps_trained": 1223360, "num_agent_steps_sampled": 1223360, "num_agent_steps_trained": 1223360}, "done": false, "episodes_total": 3932, "training_iteration": 795, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-46-08", "timestamp": 1691214368, "time_this_iter_s": 11.154570817947388, "time_total_s": 10687.425922870636, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 449.8929669857025, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 21.9375, "ram_util_percent": 66.16874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 242192.671875, "vf_loss": 11029852.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 82.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}}, "num_env_steps_sampled": 1223602, "num_env_steps_trained": 1223602, "num_agent_steps_sampled": 1223602, "num_agent_steps_trained": 1223602}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1191.039991823598, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836, -1187.2657633076515, -1191.9593721554538, -1187.4258645544264, -1190.089892029218, -1191.9253658273083, -1191.9253658273083, -1187.4258645544264, -1188.9318020866551, -1187.4258645544264, -1187.6670538574751, -1188.6425943692086, -1197.6404616307384, -1187.4258645544264, -1192.0371739831949], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.10880442874353, "mean_inference_ms": 0.38319151348793995, "mean_action_processing_ms": 0.09387026990979153, "mean_env_wait_ms": 24.616187102280918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005972676160858899, "StateBufferConnector_ms": 0.002953773591576553, "ViewRequirementAgentConnector_ms": 0.08472320510119927}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1191.039991823598, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836, -1187.2657633076515, -1191.9593721554538, -1187.4258645544264, -1190.089892029218, -1191.9253658273083, -1191.9253658273083, -1187.4258645544264, -1188.9318020866551, -1187.4258645544264, -1187.6670538574751, -1188.6425943692086, -1197.6404616307384, -1187.4258645544264, -1192.0371739831949], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.10880442874353, "mean_inference_ms": 0.38319151348793995, "mean_action_processing_ms": 0.09387026990979153, "mean_env_wait_ms": 24.616187102280918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005972676160858899, "StateBufferConnector_ms": 0.002953773591576553, "ViewRequirementAgentConnector_ms": 0.08472320510119927}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1223602, "num_agent_steps_trained": 1223602, "num_env_steps_sampled": 1223602, "num_env_steps_trained": 1223602, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 22.170269688501225, "num_env_steps_trained_throughput_per_sec": 22.170269688501225, "timesteps_total": 1223602, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1223602, "timers": {"training_iteration_time_ms": 5530.247, "sample_time_ms": 5526.513, "load_time_ms": 0.219, "load_throughput": 553507.235, "learn_time_ms": 2.762, "learn_throughput": 43809.09, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 1223602, "num_env_steps_trained": 1223602, "num_agent_steps_sampled": 1223602, "num_agent_steps_trained": 1223602}, "done": false, "episodes_total": 3934, "training_iteration": 796, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-46-19", "timestamp": 1691214379, "time_this_iter_s": 10.918246030807495, "time_total_s": 10698.344168901443, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 460.81121301651, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 24.875, "ram_util_percent": 66.1625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 241108.734375, "vf_loss": 10934704.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 84.0, "diff_num_grad_updates_vs_sampler_policy": 83.0}}, "num_env_steps_sampled": 1223844, "num_env_steps_trained": 1223844, "num_agent_steps_sampled": 1223844, "num_agent_steps_trained": 1223844}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1191.0252611891046, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836, -1187.2657633076515, -1191.9593721554538, -1187.4258645544264, -1190.089892029218, -1191.9253658273083, -1191.9253658273083, -1187.4258645544264, -1188.9318020866551, -1187.4258645544264, -1187.6670538574751, -1188.6425943692086, -1197.6404616307384, -1187.4258645544264, -1192.0371739831949, -1191.81890096284, -1189.023709386901], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.110130225895105, "mean_inference_ms": 0.38315790293064567, "mean_action_processing_ms": 0.09386146911309101, "mean_env_wait_ms": 24.594469299836955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005964154288882301, "StateBufferConnector_ms": 0.0029527005695161365, "ViewRequirementAgentConnector_ms": 0.08471664928254627}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1191.0252611891046, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836, -1187.2657633076515, -1191.9593721554538, -1187.4258645544264, -1190.089892029218, -1191.9253658273083, -1191.9253658273083, -1187.4258645544264, -1188.9318020866551, -1187.4258645544264, -1187.6670538574751, -1188.6425943692086, -1197.6404616307384, -1187.4258645544264, -1192.0371739831949, -1191.81890096284, -1189.023709386901], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.110130225895105, "mean_inference_ms": 0.38315790293064567, "mean_action_processing_ms": 0.09386146911309101, "mean_env_wait_ms": 24.594469299836955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005964154288882301, "StateBufferConnector_ms": 0.0029527005695161365, "ViewRequirementAgentConnector_ms": 0.08471664928254627}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1223844, "num_agent_steps_trained": 1223844, "num_env_steps_sampled": 1223844, "num_env_steps_trained": 1223844, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.756522761651297, "num_env_steps_trained_throughput_per_sec": 21.756522761651297, "timesteps_total": 1223844, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1223844, "timers": {"training_iteration_time_ms": 5534.235, "sample_time_ms": 5530.462, "load_time_ms": 0.219, "load_throughput": 553507.235, "learn_time_ms": 2.786, "learn_throughput": 43436.39, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 1223844, "num_env_steps_trained": 1223844, "num_agent_steps_sampled": 1223844, "num_agent_steps_trained": 1223844}, "done": false, "episodes_total": 3936, "training_iteration": 797, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-46-30", "timestamp": 1691214390, "time_this_iter_s": 11.125786066055298, "time_total_s": 10709.469954967499, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 471.9369990825653, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 21.98666666666667, "ram_util_percent": 66.32666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 240820.140625, "vf_loss": 10909448.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 85.0}}, "num_env_steps_sampled": 1224086, "num_env_steps_trained": 1224086, "num_agent_steps_sampled": 1224086, "num_agent_steps_trained": 1224086}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1190.960660861738, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836, -1187.2657633076515, -1191.9593721554538, -1187.4258645544264, -1190.089892029218, -1191.9253658273083, -1191.9253658273083, -1187.4258645544264, -1188.9318020866551, -1187.4258645544264, -1187.6670538574751, -1188.6425943692086, -1197.6404616307384, -1187.4258645544264, -1192.0371739831949, -1191.81890096284, -1189.023709386901, -1189.069029670258, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11132885928637, "mean_inference_ms": 0.3831241492732276, "mean_action_processing_ms": 0.09385274405025731, "mean_env_wait_ms": 24.57336281735436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005953533704890762, "StateBufferConnector_ms": 0.002949182377305142, "ViewRequirementAgentConnector_ms": 0.08471760638924532}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1190.960660861738, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836, -1187.2657633076515, -1191.9593721554538, -1187.4258645544264, -1190.089892029218, -1191.9253658273083, -1191.9253658273083, -1187.4258645544264, -1188.9318020866551, -1187.4258645544264, -1187.6670538574751, -1188.6425943692086, -1197.6404616307384, -1187.4258645544264, -1192.0371739831949, -1191.81890096284, -1189.023709386901, -1189.069029670258, -1187.4258645544264], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.11132885928637, "mean_inference_ms": 0.3831241492732276, "mean_action_processing_ms": 0.09385274405025731, "mean_env_wait_ms": 24.57336281735436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005953533704890762, "StateBufferConnector_ms": 0.002949182377305142, "ViewRequirementAgentConnector_ms": 0.08471760638924532}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224086, "num_agent_steps_trained": 1224086, "num_env_steps_sampled": 1224086, "num_env_steps_trained": 1224086, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.952885178274077, "num_env_steps_trained_throughput_per_sec": 21.952885178274077, "timesteps_total": 1224086, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1224086, "timers": {"training_iteration_time_ms": 5523.83, "sample_time_ms": 5520.047, "load_time_ms": 0.22, "load_throughput": 550505.244, "learn_time_ms": 2.789, "learn_throughput": 43390.712, "synch_weights_time_ms": 0.737}, "counters": {"num_env_steps_sampled": 1224086, "num_env_steps_trained": 1224086, "num_agent_steps_sampled": 1224086, "num_agent_steps_trained": 1224086}, "done": false, "episodes_total": 3938, "training_iteration": 798, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-46-41", "timestamp": 1691214401, "time_this_iter_s": 11.026258945465088, "time_total_s": 10720.496213912964, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 482.9632580280304, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 22.39375, "ram_util_percent": 66.43125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.1, "policy_entropy": -318.9363098144531, "policy_loss": 242235.203125, "vf_loss": 11033594.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 87.0}}, "num_env_steps_sampled": 1224328, "num_env_steps_trained": 1224328, "num_agent_steps_sampled": 1224328, "num_agent_steps_trained": 1224328}, "sampler_results": {"episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1190.933961038165, "episode_len_mean": 121.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836, -1187.2657633076515, -1191.9593721554538, -1187.4258645544264, -1190.089892029218, -1191.9253658273083, -1191.9253658273083, -1187.4258645544264, -1188.9318020866551, -1187.4258645544264, -1187.6670538574751, -1188.6425943692086, -1197.6404616307384, -1187.4258645544264, -1192.0371739831949, -1191.81890096284, -1189.023709386901, -1189.069029670258, -1187.4258645544264, -1187.4258645544264, -1192.1458726946314], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.112278465469625, "mean_inference_ms": 0.38309092475435186, "mean_action_processing_ms": 0.09384412116709678, "mean_env_wait_ms": 24.55306697073054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005947459827769886, "StateBufferConnector_ms": 0.0029482624747536397, "ViewRequirementAgentConnector_ms": 0.08471147580580278}}, "episode_reward_max": -1186.6896214872966, "episode_reward_min": -1205.0499411220212, "episode_reward_mean": -1190.933961038165, "episode_len_mean": 121.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187.4258645544264, -1194.8813556625362, -1198.5240413721779, -1196.550712702706, -1192.0111455857184, -1188.9215123809936, -1194.8833511179162, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1190.9215561825138, -1190.39322007625, -1188.9115620570647, -1198.3529900053459, -1193.4285583724873, -1193.2308653789366, -1191.9593721554538, -1188.9115620570647, -1191.7906534771116, -1187.001940084544, -1188.663321152552, -1188.9463511885422, -1188.8100111101612, -1187.4258645544264, -1201.1056013549978, -1187.4258645544264, -1187.4258645544264, -1198.210949870233, -1188.881778245844, -1188.9266152602975, -1198.310236445088, -1187.4258645544264, -1186.6896214872966, -1191.4139650315685, -1195.1017783887837, -1193.647701794283, -1198.828668203035, -1192.0255823403395, -1188.9728559688392, -1189.0374079634928, -1187.4258645544264, -1199.310019752759, -1188.9510066574887, -1187.4258645544264, -1187.4258645544264, -1187.4258645544264, -1188.969317500967, -1201.1107159528042, -1188.9264177744442, -1187.4258645544264, -1187.4258645544264, -1196.50465536936, -1188.8124143131042, -1187.4258645544264, -1194.6779894561591, -1190.4775790603692, -1186.8453836669973, -1187.4258645544264, -1192.0388692840597, -1196.2115350910065, -1194.8833511179162, -1193.0206777904946, -1187.4258645544264, -1188.969317500967, -1187.4258645544264, -1205.0499411220212, -1188.9146577945203, -1191.904770583836, -1187.2657633076515, -1191.9593721554538, -1187.4258645544264, -1190.089892029218, -1191.9253658273083, -1191.9253658273083, -1187.4258645544264, -1188.9318020866551, -1187.4258645544264, -1187.6670538574751, -1188.6425943692086, -1197.6404616307384, -1187.4258645544264, -1192.0371739831949, -1191.81890096284, -1189.023709386901, -1189.069029670258, -1187.4258645544264, -1187.4258645544264, -1192.1458726946314], "episode_lengths": [121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121, 121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.112278465469625, "mean_inference_ms": 0.38309092475435186, "mean_action_processing_ms": 0.09384412116709678, "mean_env_wait_ms": 24.55306697073054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005947459827769886, "StateBufferConnector_ms": 0.0029482624747536397, "ViewRequirementAgentConnector_ms": 0.08471147580580278}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224328, "num_agent_steps_trained": 1224328, "num_env_steps_sampled": 1224328, "num_env_steps_trained": 1224328, "num_env_steps_sampled_this_iter": 242, "num_env_steps_trained_this_iter": 242, "num_env_steps_sampled_throughput_per_sec": 21.867929346501697, "num_env_steps_trained_throughput_per_sec": 21.867929346501697, "timesteps_total": 1224328, "num_steps_trained_this_iter": 242, "agent_timesteps_total": 1224328, "timers": {"training_iteration_time_ms": 5528.055, "sample_time_ms": 5524.277, "load_time_ms": 0.22, "load_throughput": 551162.884, "learn_time_ms": 2.797, "learn_throughput": 43254.252, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 1224328, "num_env_steps_trained": 1224328, "num_agent_steps_sampled": 1224328, "num_agent_steps_trained": 1224328}, "done": false, "episodes_total": 3940, "training_iteration": 799, "trial_id": "4f8cd_00000", "date": "2023-08-05_08-46-52", "timestamp": 1691214412, "time_this_iter_s": 11.068994760513306, "time_total_s": 10731.565208673477, "pid": 50585, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1023800, 5e-09], [1029200, 8e-09], [1034600, 2.5e-09], [1040000, 2.5e-09], [1045400, 2.5e-09], [1050800, 2.5e-09], [1056200, 1e-09], [1061600, 1e-09], [1067000, 1e-09], [1072400, 5e-10], [1077800, 5e-10], [1083200, 5e-10], [1088600, 5e-10], [1094000, 1e-10], [1099400, 1e-10], [1104800, 1e-10], [1110200, 1e-10], [1115600, 5e-11], [1121000, 5e-11], [1126400, 2.5e-11], [1131800, 2.5e-11], [1137200, 1e-11], [1142600, 1e-11], [1148000, 5e-12], [1153400, 5e-12], [1158800, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1024970}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fdf8b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 494.0322527885437, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 22.5875, "ram_util_percent": 66.36875}}
